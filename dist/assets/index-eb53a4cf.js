(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var Ke=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function bf(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function jf(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var s=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return e[r]}})}),n}var Pu={exports:{}},zi={},Cu={exports:{}},q={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ds=Symbol.for("react.element"),kf=Symbol.for("react.portal"),Nf=Symbol.for("react.fragment"),Sf=Symbol.for("react.strict_mode"),Pf=Symbol.for("react.profiler"),Cf=Symbol.for("react.provider"),Ef=Symbol.for("react.context"),Tf=Symbol.for("react.forward_ref"),zf=Symbol.for("react.suspense"),$f=Symbol.for("react.memo"),If=Symbol.for("react.lazy"),Gl=Symbol.iterator;function Lf(e){return e===null||typeof e!="object"?null:(e=Gl&&e[Gl]||e["@@iterator"],typeof e=="function"?e:null)}var Eu={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Tu=Object.assign,zu={};function ar(e,t,n){this.props=e,this.context=t,this.refs=zu,this.updater=n||Eu}ar.prototype.isReactComponent={};ar.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};ar.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function $u(){}$u.prototype=ar.prototype;function Zo(e,t,n){this.props=e,this.context=t,this.refs=zu,this.updater=n||Eu}var Vo=Zo.prototype=new $u;Vo.constructor=Zo;Tu(Vo,ar.prototype);Vo.isPureReactComponent=!0;var Jl=Array.isArray,Iu=Object.prototype.hasOwnProperty,Go={current:null},Lu={key:!0,ref:!0,__self:!0,__source:!0};function Du(e,t,n){var r,s={},i=null,o=null;if(t!=null)for(r in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)Iu.call(t,r)&&!Lu.hasOwnProperty(r)&&(s[r]=t[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:ds,type:e,key:i,ref:o,props:s,_owner:Go.current}}function Df(e,t){return{$$typeof:ds,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Jo(e){return typeof e=="object"&&e!==null&&e.$$typeof===ds}function Af(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var ql=/\/+/g;function ea(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Af(""+e.key):t.toString(36)}function Us(e,t,n,r,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case ds:case kf:o=!0}}if(o)return o=e,s=s(o),e=r===""?"."+ea(o,0):r,Jl(s)?(n="",e!=null&&(n=e.replace(ql,"$&/")+"/"),Us(s,t,n,"",function(u){return u})):s!=null&&(Jo(s)&&(s=Df(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(ql,"$&/")+"/")+e)),t.push(s)),1;if(o=0,r=r===""?".":r+":",Jl(e))for(var l=0;l<e.length;l++){i=e[l];var c=r+ea(i,l);o+=Us(i,t,n,c,s)}else if(c=Lf(e),typeof c=="function")for(e=c.call(e),l=0;!(i=e.next()).done;)i=i.value,c=r+ea(i,l++),o+=Us(i,t,n,c,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function ws(e,t,n){if(e==null)return e;var r=[],s=0;return Us(e,r,"","",function(i){return t.call(n,i,s++)}),r}function Of(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var $e={current:null},Fs={transition:null},Rf={ReactCurrentDispatcher:$e,ReactCurrentBatchConfig:Fs,ReactCurrentOwner:Go};function Au(){throw Error("act(...) is not supported in production builds of React.")}q.Children={map:ws,forEach:function(e,t,n){ws(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return ws(e,function(){t++}),t},toArray:function(e){return ws(e,function(t){return t})||[]},only:function(e){if(!Jo(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};q.Component=ar;q.Fragment=Nf;q.Profiler=Pf;q.PureComponent=Zo;q.StrictMode=Sf;q.Suspense=zf;q.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Rf;q.act=Au;q.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Tu({},e.props),s=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=Go.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)Iu.call(t,c)&&!Lu.hasOwnProperty(c)&&(r[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:ds,type:e.type,key:s,ref:i,props:r,_owner:o}};q.createContext=function(e){return e={$$typeof:Ef,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Cf,_context:e},e.Consumer=e};q.createElement=Du;q.createFactory=function(e){var t=Du.bind(null,e);return t.type=e,t};q.createRef=function(){return{current:null}};q.forwardRef=function(e){return{$$typeof:Tf,render:e}};q.isValidElement=Jo;q.lazy=function(e){return{$$typeof:If,_payload:{_status:-1,_result:e},_init:Of}};q.memo=function(e,t){return{$$typeof:$f,type:e,compare:t===void 0?null:t}};q.startTransition=function(e){var t=Fs.transition;Fs.transition={};try{e()}finally{Fs.transition=t}};q.unstable_act=Au;q.useCallback=function(e,t){return $e.current.useCallback(e,t)};q.useContext=function(e){return $e.current.useContext(e)};q.useDebugValue=function(){};q.useDeferredValue=function(e){return $e.current.useDeferredValue(e)};q.useEffect=function(e,t){return $e.current.useEffect(e,t)};q.useId=function(){return $e.current.useId()};q.useImperativeHandle=function(e,t,n){return $e.current.useImperativeHandle(e,t,n)};q.useInsertionEffect=function(e,t){return $e.current.useInsertionEffect(e,t)};q.useLayoutEffect=function(e,t){return $e.current.useLayoutEffect(e,t)};q.useMemo=function(e,t){return $e.current.useMemo(e,t)};q.useReducer=function(e,t,n){return $e.current.useReducer(e,t,n)};q.useRef=function(e){return $e.current.useRef(e)};q.useState=function(e){return $e.current.useState(e)};q.useSyncExternalStore=function(e,t,n){return $e.current.useSyncExternalStore(e,t,n)};q.useTransition=function(){return $e.current.useTransition()};q.version="18.3.1";Cu.exports=q;var O=Cu.exports;const Mf=bf(O);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Uf=O,Ff=Symbol.for("react.element"),Bf=Symbol.for("react.fragment"),Hf=Object.prototype.hasOwnProperty,Wf=Uf.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Zf={key:!0,ref:!0,__self:!0,__source:!0};function Ou(e,t,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)Hf.call(t,r)&&!Zf.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)s[r]===void 0&&(s[r]=t[r]);return{$$typeof:Ff,type:e,key:i,ref:o,props:s,_owner:Wf.current}}zi.Fragment=Bf;zi.jsx=Ou;zi.jsxs=Ou;Pu.exports=zi;var a=Pu.exports,Ra={},Ru={exports:{}},Ve={},Mu={exports:{}},Uu={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(A,U){var E=A.length;A.push(U);e:for(;0<E;){var G=E-1>>>1,L=A[G];if(0<s(L,U))A[G]=U,A[E]=L,E=G;else break e}}function n(A){return A.length===0?null:A[0]}function r(A){if(A.length===0)return null;var U=A[0],E=A.pop();if(E!==U){A[0]=E;e:for(var G=0,L=A.length,F=L>>>1;G<F;){var V=2*(G+1)-1,P=A[V],$=V+1,I=A[$];if(0>s(P,E))$<L&&0>s(I,P)?(A[G]=I,A[$]=E,G=$):(A[G]=P,A[V]=E,G=V);else if($<L&&0>s(I,E))A[G]=I,A[$]=E,G=$;else break e}}return U}function s(A,U){var E=A.sortIndex-U.sortIndex;return E!==0?E:A.id-U.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,h=null,p=3,v=!1,y=!1,x=!1,j=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,f=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function m(A){for(var U=n(u);U!==null;){if(U.callback===null)r(u);else if(U.startTime<=A)r(u),U.sortIndex=U.expirationTime,t(c,U);else break;U=n(u)}}function w(A){if(x=!1,m(A),!y)if(n(c)!==null)y=!0,M(C);else{var U=n(u);U!==null&&B(w,U.startTime-A)}}function C(A,U){y=!1,x&&(x=!1,g(k),k=-1),v=!0;var E=p;try{for(m(U),h=n(c);h!==null&&(!(h.expirationTime>U)||A&&!T());){var G=h.callback;if(typeof G=="function"){h.callback=null,p=h.priorityLevel;var L=G(h.expirationTime<=U);U=e.unstable_now(),typeof L=="function"?h.callback=L:h===n(c)&&r(c),m(U)}else r(c);h=n(c)}if(h!==null)var F=!0;else{var V=n(u);V!==null&&B(w,V.startTime-U),F=!1}return F}finally{h=null,p=E,v=!1}}var b=!1,z=null,k=-1,_=5,N=-1;function T(){return!(e.unstable_now()-N<_)}function Y(){if(z!==null){var A=e.unstable_now();N=A;var U=!0;try{U=z(!0,A)}finally{U?Q():(b=!1,z=null)}}else b=!1}var Q;if(typeof f=="function")Q=function(){f(Y)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,S=K.port2;K.port1.onmessage=Y,Q=function(){S.postMessage(null)}}else Q=function(){j(Y,0)};function M(A){z=A,b||(b=!0,Q())}function B(A,U){k=j(function(){A(e.unstable_now())},U)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(A){A.callback=null},e.unstable_continueExecution=function(){y||v||(y=!0,M(C))},e.unstable_forceFrameRate=function(A){0>A||125<A?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<A?Math.floor(1e3/A):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(A){switch(p){case 1:case 2:case 3:var U=3;break;default:U=p}var E=p;p=U;try{return A()}finally{p=E}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(A,U){switch(A){case 1:case 2:case 3:case 4:case 5:break;default:A=3}var E=p;p=A;try{return U()}finally{p=E}},e.unstable_scheduleCallback=function(A,U,E){var G=e.unstable_now();switch(typeof E=="object"&&E!==null?(E=E.delay,E=typeof E=="number"&&0<E?G+E:G):E=G,A){case 1:var L=-1;break;case 2:L=250;break;case 5:L=1073741823;break;case 4:L=1e4;break;default:L=5e3}return L=E+L,A={id:d++,callback:U,priorityLevel:A,startTime:E,expirationTime:L,sortIndex:-1},E>G?(A.sortIndex=E,t(u,A),n(c)===null&&A===n(u)&&(x?(g(k),k=-1):x=!0,B(w,E-G))):(A.sortIndex=L,t(c,A),y||v||(y=!0,M(C))),A},e.unstable_shouldYield=T,e.unstable_wrapCallback=function(A){var U=p;return function(){var E=p;p=U;try{return A.apply(this,arguments)}finally{p=E}}}})(Uu);Mu.exports=Uu;var Vf=Mu.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gf=O,Ze=Vf;function D(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Fu=new Set,Fr={};function wn(e,t){Qn(e,t),Qn(e+"Capture",t)}function Qn(e,t){for(Fr[e]=t,e=0;e<t.length;e++)Fu.add(t[e])}var Ct=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ma=Object.prototype.hasOwnProperty,Jf=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ql={},Yl={};function qf(e){return Ma.call(Yl,e)?!0:Ma.call(Ql,e)?!1:Jf.test(e)?Yl[e]=!0:(Ql[e]=!0,!1)}function Qf(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Yf(e,t,n,r){if(t===null||typeof t>"u"||Qf(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ie(e,t,n,r,s,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var we={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){we[e]=new Ie(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];we[t]=new Ie(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){we[e]=new Ie(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){we[e]=new Ie(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){we[e]=new Ie(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){we[e]=new Ie(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){we[e]=new Ie(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){we[e]=new Ie(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){we[e]=new Ie(e,5,!1,e.toLowerCase(),null,!1,!1)});var qo=/[\-:]([a-z])/g;function Qo(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(qo,Qo);we[t]=new Ie(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(qo,Qo);we[t]=new Ie(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(qo,Qo);we[t]=new Ie(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){we[e]=new Ie(e,1,!1,e.toLowerCase(),null,!1,!1)});we.xlinkHref=new Ie("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){we[e]=new Ie(e,1,!1,e.toLowerCase(),null,!0,!0)});function Yo(e,t,n,r){var s=we.hasOwnProperty(t)?we[t]:null;(s!==null?s.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Yf(t,n,s,r)&&(n=null),r||s===null?qf(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,r=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var $t=Gf.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_s=Symbol.for("react.element"),$n=Symbol.for("react.portal"),In=Symbol.for("react.fragment"),Ko=Symbol.for("react.strict_mode"),Ua=Symbol.for("react.profiler"),Bu=Symbol.for("react.provider"),Hu=Symbol.for("react.context"),Xo=Symbol.for("react.forward_ref"),Fa=Symbol.for("react.suspense"),Ba=Symbol.for("react.suspense_list"),el=Symbol.for("react.memo"),At=Symbol.for("react.lazy"),Wu=Symbol.for("react.offscreen"),Kl=Symbol.iterator;function fr(e){return e===null||typeof e!="object"?null:(e=Kl&&e[Kl]||e["@@iterator"],typeof e=="function"?e:null)}var ce=Object.assign,ta;function kr(e){if(ta===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);ta=t&&t[1]||""}return`
`+ta+e}var na=!1;function ra(e,t){if(!e||na)return"";na=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var c=`
`+s[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{na=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?kr(e):""}function Kf(e){switch(e.tag){case 5:return kr(e.type);case 16:return kr("Lazy");case 13:return kr("Suspense");case 19:return kr("SuspenseList");case 0:case 2:case 15:return e=ra(e.type,!1),e;case 11:return e=ra(e.type.render,!1),e;case 1:return e=ra(e.type,!0),e;default:return""}}function Ha(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case In:return"Fragment";case $n:return"Portal";case Ua:return"Profiler";case Ko:return"StrictMode";case Fa:return"Suspense";case Ba:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Hu:return(e.displayName||"Context")+".Consumer";case Bu:return(e._context.displayName||"Context")+".Provider";case Xo:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case el:return t=e.displayName||null,t!==null?t:Ha(e.type)||"Memo";case At:t=e._payload,e=e._init;try{return Ha(e(t))}catch{}}return null}function Xf(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ha(t);case 8:return t===Ko?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Yt(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Zu(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function em(e){var t=Zu(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function bs(e){e._valueTracker||(e._valueTracker=em(e))}function Vu(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Zu(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function ti(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Wa(e,t){var n=t.checked;return ce({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Xl(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Yt(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Gu(e,t){t=t.checked,t!=null&&Yo(e,"checked",t,!1)}function Za(e,t){Gu(e,t);var n=Yt(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Va(e,t.type,n):t.hasOwnProperty("defaultValue")&&Va(e,t.type,Yt(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function ec(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Va(e,t,n){(t!=="number"||ti(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Nr=Array.isArray;function Wn(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Yt(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Ga(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(D(91));return ce({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function tc(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(D(92));if(Nr(n)){if(1<n.length)throw Error(D(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Yt(n)}}function Ju(e,t){var n=Yt(t.value),r=Yt(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function nc(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function qu(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ja(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?qu(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var js,Qu=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(js=js||document.createElement("div"),js.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=js.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Br(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Tr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},tm=["Webkit","ms","Moz","O"];Object.keys(Tr).forEach(function(e){tm.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Tr[t]=Tr[e]})});function Yu(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Tr.hasOwnProperty(e)&&Tr[e]?(""+t).trim():t+"px"}function Ku(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=Yu(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}var nm=ce({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function qa(e,t){if(t){if(nm[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(D(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(D(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(D(61))}if(t.style!=null&&typeof t.style!="object")throw Error(D(62))}}function Qa(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ya=null;function tl(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Ka=null,Zn=null,Vn=null;function rc(e){if(e=ms(e)){if(typeof Ka!="function")throw Error(D(280));var t=e.stateNode;t&&(t=Ai(t),Ka(e.stateNode,e.type,t))}}function Xu(e){Zn?Vn?Vn.push(e):Vn=[e]:Zn=e}function ed(){if(Zn){var e=Zn,t=Vn;if(Vn=Zn=null,rc(e),t)for(e=0;e<t.length;e++)rc(t[e])}}function td(e,t){return e(t)}function nd(){}var sa=!1;function rd(e,t,n){if(sa)return e(t,n);sa=!0;try{return td(e,t,n)}finally{sa=!1,(Zn!==null||Vn!==null)&&(nd(),ed())}}function Hr(e,t){var n=e.stateNode;if(n===null)return null;var r=Ai(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(D(231,t,typeof n));return n}var Xa=!1;if(Ct)try{var mr={};Object.defineProperty(mr,"passive",{get:function(){Xa=!0}}),window.addEventListener("test",mr,mr),window.removeEventListener("test",mr,mr)}catch{Xa=!1}function rm(e,t,n,r,s,i,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(d){this.onError(d)}}var zr=!1,ni=null,ri=!1,eo=null,sm={onError:function(e){zr=!0,ni=e}};function im(e,t,n,r,s,i,o,l,c){zr=!1,ni=null,rm.apply(sm,arguments)}function am(e,t,n,r,s,i,o,l,c){if(im.apply(this,arguments),zr){if(zr){var u=ni;zr=!1,ni=null}else throw Error(D(198));ri||(ri=!0,eo=u)}}function _n(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function sd(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function sc(e){if(_n(e)!==e)throw Error(D(188))}function om(e){var t=e.alternate;if(!t){if(t=_n(e),t===null)throw Error(D(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return sc(s),e;if(i===r)return sc(s),t;i=i.sibling}throw Error(D(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(D(189))}}if(n.alternate!==r)throw Error(D(190))}if(n.tag!==3)throw Error(D(188));return n.stateNode.current===n?e:t}function id(e){return e=om(e),e!==null?ad(e):null}function ad(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=ad(e);if(t!==null)return t;e=e.sibling}return null}var od=Ze.unstable_scheduleCallback,ic=Ze.unstable_cancelCallback,lm=Ze.unstable_shouldYield,cm=Ze.unstable_requestPaint,de=Ze.unstable_now,um=Ze.unstable_getCurrentPriorityLevel,nl=Ze.unstable_ImmediatePriority,ld=Ze.unstable_UserBlockingPriority,si=Ze.unstable_NormalPriority,dm=Ze.unstable_LowPriority,cd=Ze.unstable_IdlePriority,$i=null,mt=null;function hm(e){if(mt&&typeof mt.onCommitFiberRoot=="function")try{mt.onCommitFiberRoot($i,e,void 0,(e.current.flags&128)===128)}catch{}}var ot=Math.clz32?Math.clz32:pm,fm=Math.log,mm=Math.LN2;function pm(e){return e>>>=0,e===0?32:31-(fm(e)/mm|0)|0}var ks=64,Ns=4194304;function Sr(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ii(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,s=e.suspendedLanes,i=e.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=Sr(l):(i&=o,i!==0&&(r=Sr(i)))}else o=n&~s,o!==0?r=Sr(o):i!==0&&(r=Sr(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&s)&&(s=r&-r,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-ot(t),s=1<<n,r|=e[n],t&=~s;return r}function gm(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function vm(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-ot(i),l=1<<o,c=s[o];c===-1?(!(l&n)||l&r)&&(s[o]=gm(l,t)):c<=t&&(e.expiredLanes|=l),i&=~l}}function to(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function ud(){var e=ks;return ks<<=1,!(ks&4194240)&&(ks=64),e}function ia(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function hs(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-ot(t),e[t]=n}function xm(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-ot(n),i=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~i}}function rl(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-ot(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var te=0;function dd(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var hd,sl,fd,md,pd,no=!1,Ss=[],Ht=null,Wt=null,Zt=null,Wr=new Map,Zr=new Map,Rt=[],ym="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ac(e,t){switch(e){case"focusin":case"focusout":Ht=null;break;case"dragenter":case"dragleave":Wt=null;break;case"mouseover":case"mouseout":Zt=null;break;case"pointerover":case"pointerout":Wr.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Zr.delete(t.pointerId)}}function pr(e,t,n,r,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},t!==null&&(t=ms(t),t!==null&&sl(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function wm(e,t,n,r,s){switch(t){case"focusin":return Ht=pr(Ht,e,t,n,r,s),!0;case"dragenter":return Wt=pr(Wt,e,t,n,r,s),!0;case"mouseover":return Zt=pr(Zt,e,t,n,r,s),!0;case"pointerover":var i=s.pointerId;return Wr.set(i,pr(Wr.get(i)||null,e,t,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Zr.set(i,pr(Zr.get(i)||null,e,t,n,r,s)),!0}return!1}function gd(e){var t=un(e.target);if(t!==null){var n=_n(t);if(n!==null){if(t=n.tag,t===13){if(t=sd(n),t!==null){e.blockedOn=t,pd(e.priority,function(){fd(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Bs(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=ro(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Ya=r,n.target.dispatchEvent(r),Ya=null}else return t=ms(n),t!==null&&sl(t),e.blockedOn=n,!1;t.shift()}return!0}function oc(e,t,n){Bs(e)&&n.delete(t)}function _m(){no=!1,Ht!==null&&Bs(Ht)&&(Ht=null),Wt!==null&&Bs(Wt)&&(Wt=null),Zt!==null&&Bs(Zt)&&(Zt=null),Wr.forEach(oc),Zr.forEach(oc)}function gr(e,t){e.blockedOn===t&&(e.blockedOn=null,no||(no=!0,Ze.unstable_scheduleCallback(Ze.unstable_NormalPriority,_m)))}function Vr(e){function t(s){return gr(s,e)}if(0<Ss.length){gr(Ss[0],e);for(var n=1;n<Ss.length;n++){var r=Ss[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Ht!==null&&gr(Ht,e),Wt!==null&&gr(Wt,e),Zt!==null&&gr(Zt,e),Wr.forEach(t),Zr.forEach(t),n=0;n<Rt.length;n++)r=Rt[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Rt.length&&(n=Rt[0],n.blockedOn===null);)gd(n),n.blockedOn===null&&Rt.shift()}var Gn=$t.ReactCurrentBatchConfig,ai=!0;function bm(e,t,n,r){var s=te,i=Gn.transition;Gn.transition=null;try{te=1,il(e,t,n,r)}finally{te=s,Gn.transition=i}}function jm(e,t,n,r){var s=te,i=Gn.transition;Gn.transition=null;try{te=4,il(e,t,n,r)}finally{te=s,Gn.transition=i}}function il(e,t,n,r){if(ai){var s=ro(e,t,n,r);if(s===null)pa(e,t,r,oi,n),ac(e,r);else if(wm(s,e,t,n,r))r.stopPropagation();else if(ac(e,r),t&4&&-1<ym.indexOf(e)){for(;s!==null;){var i=ms(s);if(i!==null&&hd(i),i=ro(e,t,n,r),i===null&&pa(e,t,r,oi,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else pa(e,t,r,null,n)}}var oi=null;function ro(e,t,n,r){if(oi=null,e=tl(r),e=un(e),e!==null)if(t=_n(e),t===null)e=null;else if(n=t.tag,n===13){if(e=sd(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return oi=e,null}function vd(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(um()){case nl:return 1;case ld:return 4;case si:case dm:return 16;case cd:return 536870912;default:return 16}default:return 16}}var Ft=null,al=null,Hs=null;function xd(){if(Hs)return Hs;var e,t=al,n=t.length,r,s="value"in Ft?Ft.value:Ft.textContent,i=s.length;for(e=0;e<n&&t[e]===s[e];e++);var o=n-e;for(r=1;r<=o&&t[n-r]===s[i-r];r++);return Hs=s.slice(e,1<r?1-r:void 0)}function Ws(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Ps(){return!0}function lc(){return!1}function Ge(e){function t(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(n=e[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Ps:lc,this.isPropagationStopped=lc,this}return ce(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Ps)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Ps)},persist:function(){},isPersistent:Ps}),t}var or={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ol=Ge(or),fs=ce({},or,{view:0,detail:0}),km=Ge(fs),aa,oa,vr,Ii=ce({},fs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ll,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==vr&&(vr&&e.type==="mousemove"?(aa=e.screenX-vr.screenX,oa=e.screenY-vr.screenY):oa=aa=0,vr=e),aa)},movementY:function(e){return"movementY"in e?e.movementY:oa}}),cc=Ge(Ii),Nm=ce({},Ii,{dataTransfer:0}),Sm=Ge(Nm),Pm=ce({},fs,{relatedTarget:0}),la=Ge(Pm),Cm=ce({},or,{animationName:0,elapsedTime:0,pseudoElement:0}),Em=Ge(Cm),Tm=ce({},or,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),zm=Ge(Tm),$m=ce({},or,{data:0}),uc=Ge($m),Im={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Lm={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Dm={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Am(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Dm[e])?!!t[e]:!1}function ll(){return Am}var Om=ce({},fs,{key:function(e){if(e.key){var t=Im[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Ws(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Lm[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ll,charCode:function(e){return e.type==="keypress"?Ws(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ws(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Rm=Ge(Om),Mm=ce({},Ii,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),dc=Ge(Mm),Um=ce({},fs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ll}),Fm=Ge(Um),Bm=ce({},or,{propertyName:0,elapsedTime:0,pseudoElement:0}),Hm=Ge(Bm),Wm=ce({},Ii,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Zm=Ge(Wm),Vm=[9,13,27,32],cl=Ct&&"CompositionEvent"in window,$r=null;Ct&&"documentMode"in document&&($r=document.documentMode);var Gm=Ct&&"TextEvent"in window&&!$r,yd=Ct&&(!cl||$r&&8<$r&&11>=$r),hc=String.fromCharCode(32),fc=!1;function wd(e,t){switch(e){case"keyup":return Vm.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function _d(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ln=!1;function Jm(e,t){switch(e){case"compositionend":return _d(t);case"keypress":return t.which!==32?null:(fc=!0,hc);case"textInput":return e=t.data,e===hc&&fc?null:e;default:return null}}function qm(e,t){if(Ln)return e==="compositionend"||!cl&&wd(e,t)?(e=xd(),Hs=al=Ft=null,Ln=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return yd&&t.locale!=="ko"?null:t.data;default:return null}}var Qm={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function mc(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Qm[e.type]:t==="textarea"}function bd(e,t,n,r){Xu(r),t=li(t,"onChange"),0<t.length&&(n=new ol("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Ir=null,Gr=null;function Ym(e){Id(e,0)}function Li(e){var t=On(e);if(Vu(t))return e}function Km(e,t){if(e==="change")return t}var jd=!1;if(Ct){var ca;if(Ct){var ua="oninput"in document;if(!ua){var pc=document.createElement("div");pc.setAttribute("oninput","return;"),ua=typeof pc.oninput=="function"}ca=ua}else ca=!1;jd=ca&&(!document.documentMode||9<document.documentMode)}function gc(){Ir&&(Ir.detachEvent("onpropertychange",kd),Gr=Ir=null)}function kd(e){if(e.propertyName==="value"&&Li(Gr)){var t=[];bd(t,Gr,e,tl(e)),rd(Ym,t)}}function Xm(e,t,n){e==="focusin"?(gc(),Ir=t,Gr=n,Ir.attachEvent("onpropertychange",kd)):e==="focusout"&&gc()}function ep(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Li(Gr)}function tp(e,t){if(e==="click")return Li(t)}function np(e,t){if(e==="input"||e==="change")return Li(t)}function rp(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ct=typeof Object.is=="function"?Object.is:rp;function Jr(e,t){if(ct(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Ma.call(t,s)||!ct(e[s],t[s]))return!1}return!0}function vc(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function xc(e,t){var n=vc(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=vc(n)}}function Nd(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Nd(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Sd(){for(var e=window,t=ti();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=ti(e.document)}return t}function ul(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function sp(e){var t=Sd(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Nd(n.ownerDocument.documentElement,n)){if(r!==null&&ul(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!e.extend&&i>r&&(s=r,r=i,i=s),s=xc(n,i);var o=xc(n,r);s&&o&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var ip=Ct&&"documentMode"in document&&11>=document.documentMode,Dn=null,so=null,Lr=null,io=!1;function yc(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;io||Dn==null||Dn!==ti(r)||(r=Dn,"selectionStart"in r&&ul(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Lr&&Jr(Lr,r)||(Lr=r,r=li(so,"onSelect"),0<r.length&&(t=new ol("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Dn)))}function Cs(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var An={animationend:Cs("Animation","AnimationEnd"),animationiteration:Cs("Animation","AnimationIteration"),animationstart:Cs("Animation","AnimationStart"),transitionend:Cs("Transition","TransitionEnd")},da={},Pd={};Ct&&(Pd=document.createElement("div").style,"AnimationEvent"in window||(delete An.animationend.animation,delete An.animationiteration.animation,delete An.animationstart.animation),"TransitionEvent"in window||delete An.transitionend.transition);function Di(e){if(da[e])return da[e];if(!An[e])return e;var t=An[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Pd)return da[e]=t[n];return e}var Cd=Di("animationend"),Ed=Di("animationiteration"),Td=Di("animationstart"),zd=Di("transitionend"),$d=new Map,wc="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Xt(e,t){$d.set(e,t),wn(t,[e])}for(var ha=0;ha<wc.length;ha++){var fa=wc[ha],ap=fa.toLowerCase(),op=fa[0].toUpperCase()+fa.slice(1);Xt(ap,"on"+op)}Xt(Cd,"onAnimationEnd");Xt(Ed,"onAnimationIteration");Xt(Td,"onAnimationStart");Xt("dblclick","onDoubleClick");Xt("focusin","onFocus");Xt("focusout","onBlur");Xt(zd,"onTransitionEnd");Qn("onMouseEnter",["mouseout","mouseover"]);Qn("onMouseLeave",["mouseout","mouseover"]);Qn("onPointerEnter",["pointerout","pointerover"]);Qn("onPointerLeave",["pointerout","pointerover"]);wn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));wn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));wn("onBeforeInput",["compositionend","keypress","textInput","paste"]);wn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));wn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));wn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),lp=new Set("cancel close invalid load scroll toggle".split(" ").concat(Pr));function _c(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,am(r,t,void 0,e),e.currentTarget=null}function Id(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;_c(s,l,u),i=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;_c(s,l,u),i=c}}}if(ri)throw e=eo,ri=!1,eo=null,e}function se(e,t){var n=t[uo];n===void 0&&(n=t[uo]=new Set);var r=e+"__bubble";n.has(r)||(Ld(t,e,2,!1),n.add(r))}function ma(e,t,n){var r=0;t&&(r|=4),Ld(n,e,r,t)}var Es="_reactListening"+Math.random().toString(36).slice(2);function qr(e){if(!e[Es]){e[Es]=!0,Fu.forEach(function(n){n!=="selectionchange"&&(lp.has(n)||ma(n,!1,e),ma(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Es]||(t[Es]=!0,ma("selectionchange",!1,t))}}function Ld(e,t,n,r){switch(vd(t)){case 1:var s=bm;break;case 4:s=jm;break;default:s=il}n=s.bind(null,t,n,e),s=void 0,!Xa||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function pa(e,t,n,r,s){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=un(l),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}l=l.parentNode}}r=r.return}rd(function(){var u=i,d=tl(n),h=[];e:{var p=$d.get(e);if(p!==void 0){var v=ol,y=e;switch(e){case"keypress":if(Ws(n)===0)break e;case"keydown":case"keyup":v=Rm;break;case"focusin":y="focus",v=la;break;case"focusout":y="blur",v=la;break;case"beforeblur":case"afterblur":v=la;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=cc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=Sm;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=Fm;break;case Cd:case Ed:case Td:v=Em;break;case zd:v=Hm;break;case"scroll":v=km;break;case"wheel":v=Zm;break;case"copy":case"cut":case"paste":v=zm;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=dc}var x=(t&4)!==0,j=!x&&e==="scroll",g=x?p!==null?p+"Capture":null:p;x=[];for(var f=u,m;f!==null;){m=f;var w=m.stateNode;if(m.tag===5&&w!==null&&(m=w,g!==null&&(w=Hr(f,g),w!=null&&x.push(Qr(f,w,m)))),j)break;f=f.return}0<x.length&&(p=new v(p,y,null,n,d),h.push({event:p,listeners:x}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",v=e==="mouseout"||e==="pointerout",p&&n!==Ya&&(y=n.relatedTarget||n.fromElement)&&(un(y)||y[Et]))break e;if((v||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,v?(y=n.relatedTarget||n.toElement,v=u,y=y?un(y):null,y!==null&&(j=_n(y),y!==j||y.tag!==5&&y.tag!==6)&&(y=null)):(v=null,y=u),v!==y)){if(x=cc,w="onMouseLeave",g="onMouseEnter",f="mouse",(e==="pointerout"||e==="pointerover")&&(x=dc,w="onPointerLeave",g="onPointerEnter",f="pointer"),j=v==null?p:On(v),m=y==null?p:On(y),p=new x(w,f+"leave",v,n,d),p.target=j,p.relatedTarget=m,w=null,un(d)===u&&(x=new x(g,f+"enter",y,n,d),x.target=m,x.relatedTarget=j,w=x),j=w,v&&y)t:{for(x=v,g=y,f=0,m=x;m;m=kn(m))f++;for(m=0,w=g;w;w=kn(w))m++;for(;0<f-m;)x=kn(x),f--;for(;0<m-f;)g=kn(g),m--;for(;f--;){if(x===g||g!==null&&x===g.alternate)break t;x=kn(x),g=kn(g)}x=null}else x=null;v!==null&&bc(h,p,v,x,!1),y!==null&&j!==null&&bc(h,j,y,x,!0)}}e:{if(p=u?On(u):window,v=p.nodeName&&p.nodeName.toLowerCase(),v==="select"||v==="input"&&p.type==="file")var C=Km;else if(mc(p))if(jd)C=np;else{C=ep;var b=Xm}else(v=p.nodeName)&&v.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(C=tp);if(C&&(C=C(e,u))){bd(h,C,n,d);break e}b&&b(e,p,u),e==="focusout"&&(b=p._wrapperState)&&b.controlled&&p.type==="number"&&Va(p,"number",p.value)}switch(b=u?On(u):window,e){case"focusin":(mc(b)||b.contentEditable==="true")&&(Dn=b,so=u,Lr=null);break;case"focusout":Lr=so=Dn=null;break;case"mousedown":io=!0;break;case"contextmenu":case"mouseup":case"dragend":io=!1,yc(h,n,d);break;case"selectionchange":if(ip)break;case"keydown":case"keyup":yc(h,n,d)}var z;if(cl)e:{switch(e){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else Ln?wd(e,n)&&(k="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(k="onCompositionStart");k&&(yd&&n.locale!=="ko"&&(Ln||k!=="onCompositionStart"?k==="onCompositionEnd"&&Ln&&(z=xd()):(Ft=d,al="value"in Ft?Ft.value:Ft.textContent,Ln=!0)),b=li(u,k),0<b.length&&(k=new uc(k,e,null,n,d),h.push({event:k,listeners:b}),z?k.data=z:(z=_d(n),z!==null&&(k.data=z)))),(z=Gm?Jm(e,n):qm(e,n))&&(u=li(u,"onBeforeInput"),0<u.length&&(d=new uc("onBeforeInput","beforeinput",null,n,d),h.push({event:d,listeners:u}),d.data=z))}Id(h,t)})}function Qr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function li(e,t){for(var n=t+"Capture",r=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Hr(e,n),i!=null&&r.unshift(Qr(e,i,s)),i=Hr(e,t),i!=null&&r.push(Qr(e,i,s))),e=e.return}return r}function kn(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function bc(e,t,n,r,s){for(var i=t._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&u!==null&&(l=u,s?(c=Hr(n,i),c!=null&&o.unshift(Qr(n,c,l))):s||(c=Hr(n,i),c!=null&&o.push(Qr(n,c,l)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var cp=/\r\n?/g,up=/\u0000|\uFFFD/g;function jc(e){return(typeof e=="string"?e:""+e).replace(cp,`
`).replace(up,"")}function Ts(e,t,n){if(t=jc(t),jc(e)!==t&&n)throw Error(D(425))}function ci(){}var ao=null,oo=null;function lo(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var co=typeof setTimeout=="function"?setTimeout:void 0,dp=typeof clearTimeout=="function"?clearTimeout:void 0,kc=typeof Promise=="function"?Promise:void 0,hp=typeof queueMicrotask=="function"?queueMicrotask:typeof kc<"u"?function(e){return kc.resolve(null).then(e).catch(fp)}:co;function fp(e){setTimeout(function(){throw e})}function ga(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){e.removeChild(s),Vr(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Vr(t)}function Vt(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Nc(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var lr=Math.random().toString(36).slice(2),ft="__reactFiber$"+lr,Yr="__reactProps$"+lr,Et="__reactContainer$"+lr,uo="__reactEvents$"+lr,mp="__reactListeners$"+lr,pp="__reactHandles$"+lr;function un(e){var t=e[ft];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Et]||n[ft]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Nc(e);e!==null;){if(n=e[ft])return n;e=Nc(e)}return t}e=n,n=e.parentNode}return null}function ms(e){return e=e[ft]||e[Et],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function On(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(D(33))}function Ai(e){return e[Yr]||null}var ho=[],Rn=-1;function en(e){return{current:e}}function ie(e){0>Rn||(e.current=ho[Rn],ho[Rn]=null,Rn--)}function re(e,t){Rn++,ho[Rn]=e.current,e.current=t}var Kt={},Pe=en(Kt),Me=en(!1),pn=Kt;function Yn(e,t){var n=e.type.contextTypes;if(!n)return Kt;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Ue(e){return e=e.childContextTypes,e!=null}function ui(){ie(Me),ie(Pe)}function Sc(e,t,n){if(Pe.current!==Kt)throw Error(D(168));re(Pe,t),re(Me,n)}function Dd(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in t))throw Error(D(108,Xf(e)||"Unknown",s));return ce({},n,r)}function di(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Kt,pn=Pe.current,re(Pe,e),re(Me,Me.current),!0}function Pc(e,t,n){var r=e.stateNode;if(!r)throw Error(D(169));n?(e=Dd(e,t,pn),r.__reactInternalMemoizedMergedChildContext=e,ie(Me),ie(Pe),re(Pe,e)):ie(Me),re(Me,n)}var jt=null,Oi=!1,va=!1;function Ad(e){jt===null?jt=[e]:jt.push(e)}function gp(e){Oi=!0,Ad(e)}function tn(){if(!va&&jt!==null){va=!0;var e=0,t=te;try{var n=jt;for(te=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}jt=null,Oi=!1}catch(s){throw jt!==null&&(jt=jt.slice(e+1)),od(nl,tn),s}finally{te=t,va=!1}}return null}var Mn=[],Un=0,hi=null,fi=0,Je=[],qe=0,gn=null,kt=1,Nt="";function an(e,t){Mn[Un++]=fi,Mn[Un++]=hi,hi=e,fi=t}function Od(e,t,n){Je[qe++]=kt,Je[qe++]=Nt,Je[qe++]=gn,gn=e;var r=kt;e=Nt;var s=32-ot(r)-1;r&=~(1<<s),n+=1;var i=32-ot(t)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,kt=1<<32-ot(t)+s|n<<s|r,Nt=i+e}else kt=1<<i|n<<s|r,Nt=e}function dl(e){e.return!==null&&(an(e,1),Od(e,1,0))}function hl(e){for(;e===hi;)hi=Mn[--Un],Mn[Un]=null,fi=Mn[--Un],Mn[Un]=null;for(;e===gn;)gn=Je[--qe],Je[qe]=null,Nt=Je[--qe],Je[qe]=null,kt=Je[--qe],Je[qe]=null}var We=null,He=null,ae=!1,at=null;function Rd(e,t){var n=Qe(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function Cc(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,We=e,He=Vt(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,We=e,He=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=gn!==null?{id:kt,overflow:Nt}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Qe(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,We=e,He=null,!0):!1;default:return!1}}function fo(e){return(e.mode&1)!==0&&(e.flags&128)===0}function mo(e){if(ae){var t=He;if(t){var n=t;if(!Cc(e,t)){if(fo(e))throw Error(D(418));t=Vt(n.nextSibling);var r=We;t&&Cc(e,t)?Rd(r,n):(e.flags=e.flags&-4097|2,ae=!1,We=e)}}else{if(fo(e))throw Error(D(418));e.flags=e.flags&-4097|2,ae=!1,We=e}}}function Ec(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;We=e}function zs(e){if(e!==We)return!1;if(!ae)return Ec(e),ae=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!lo(e.type,e.memoizedProps)),t&&(t=He)){if(fo(e))throw Md(),Error(D(418));for(;t;)Rd(e,t),t=Vt(t.nextSibling)}if(Ec(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(D(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){He=Vt(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}He=null}}else He=We?Vt(e.stateNode.nextSibling):null;return!0}function Md(){for(var e=He;e;)e=Vt(e.nextSibling)}function Kn(){He=We=null,ae=!1}function fl(e){at===null?at=[e]:at.push(e)}var vp=$t.ReactCurrentBatchConfig;function xr(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(D(309));var r=n.stateNode}if(!r)throw Error(D(147,e));var s=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error(D(284));if(!n._owner)throw Error(D(290,e))}return e}function $s(e,t){throw e=Object.prototype.toString.call(t),Error(D(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Tc(e){var t=e._init;return t(e._payload)}function Ud(e){function t(g,f){if(e){var m=g.deletions;m===null?(g.deletions=[f],g.flags|=16):m.push(f)}}function n(g,f){if(!e)return null;for(;f!==null;)t(g,f),f=f.sibling;return null}function r(g,f){for(g=new Map;f!==null;)f.key!==null?g.set(f.key,f):g.set(f.index,f),f=f.sibling;return g}function s(g,f){return g=Qt(g,f),g.index=0,g.sibling=null,g}function i(g,f,m){return g.index=m,e?(m=g.alternate,m!==null?(m=m.index,m<f?(g.flags|=2,f):m):(g.flags|=2,f)):(g.flags|=1048576,f)}function o(g){return e&&g.alternate===null&&(g.flags|=2),g}function l(g,f,m,w){return f===null||f.tag!==6?(f=ka(m,g.mode,w),f.return=g,f):(f=s(f,m),f.return=g,f)}function c(g,f,m,w){var C=m.type;return C===In?d(g,f,m.props.children,w,m.key):f!==null&&(f.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===At&&Tc(C)===f.type)?(w=s(f,m.props),w.ref=xr(g,f,m),w.return=g,w):(w=Ys(m.type,m.key,m.props,null,g.mode,w),w.ref=xr(g,f,m),w.return=g,w)}function u(g,f,m,w){return f===null||f.tag!==4||f.stateNode.containerInfo!==m.containerInfo||f.stateNode.implementation!==m.implementation?(f=Na(m,g.mode,w),f.return=g,f):(f=s(f,m.children||[]),f.return=g,f)}function d(g,f,m,w,C){return f===null||f.tag!==7?(f=mn(m,g.mode,w,C),f.return=g,f):(f=s(f,m),f.return=g,f)}function h(g,f,m){if(typeof f=="string"&&f!==""||typeof f=="number")return f=ka(""+f,g.mode,m),f.return=g,f;if(typeof f=="object"&&f!==null){switch(f.$$typeof){case _s:return m=Ys(f.type,f.key,f.props,null,g.mode,m),m.ref=xr(g,null,f),m.return=g,m;case $n:return f=Na(f,g.mode,m),f.return=g,f;case At:var w=f._init;return h(g,w(f._payload),m)}if(Nr(f)||fr(f))return f=mn(f,g.mode,m,null),f.return=g,f;$s(g,f)}return null}function p(g,f,m,w){var C=f!==null?f.key:null;if(typeof m=="string"&&m!==""||typeof m=="number")return C!==null?null:l(g,f,""+m,w);if(typeof m=="object"&&m!==null){switch(m.$$typeof){case _s:return m.key===C?c(g,f,m,w):null;case $n:return m.key===C?u(g,f,m,w):null;case At:return C=m._init,p(g,f,C(m._payload),w)}if(Nr(m)||fr(m))return C!==null?null:d(g,f,m,w,null);$s(g,m)}return null}function v(g,f,m,w,C){if(typeof w=="string"&&w!==""||typeof w=="number")return g=g.get(m)||null,l(f,g,""+w,C);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case _s:return g=g.get(w.key===null?m:w.key)||null,c(f,g,w,C);case $n:return g=g.get(w.key===null?m:w.key)||null,u(f,g,w,C);case At:var b=w._init;return v(g,f,m,b(w._payload),C)}if(Nr(w)||fr(w))return g=g.get(m)||null,d(f,g,w,C,null);$s(f,w)}return null}function y(g,f,m,w){for(var C=null,b=null,z=f,k=f=0,_=null;z!==null&&k<m.length;k++){z.index>k?(_=z,z=null):_=z.sibling;var N=p(g,z,m[k],w);if(N===null){z===null&&(z=_);break}e&&z&&N.alternate===null&&t(g,z),f=i(N,f,k),b===null?C=N:b.sibling=N,b=N,z=_}if(k===m.length)return n(g,z),ae&&an(g,k),C;if(z===null){for(;k<m.length;k++)z=h(g,m[k],w),z!==null&&(f=i(z,f,k),b===null?C=z:b.sibling=z,b=z);return ae&&an(g,k),C}for(z=r(g,z);k<m.length;k++)_=v(z,g,k,m[k],w),_!==null&&(e&&_.alternate!==null&&z.delete(_.key===null?k:_.key),f=i(_,f,k),b===null?C=_:b.sibling=_,b=_);return e&&z.forEach(function(T){return t(g,T)}),ae&&an(g,k),C}function x(g,f,m,w){var C=fr(m);if(typeof C!="function")throw Error(D(150));if(m=C.call(m),m==null)throw Error(D(151));for(var b=C=null,z=f,k=f=0,_=null,N=m.next();z!==null&&!N.done;k++,N=m.next()){z.index>k?(_=z,z=null):_=z.sibling;var T=p(g,z,N.value,w);if(T===null){z===null&&(z=_);break}e&&z&&T.alternate===null&&t(g,z),f=i(T,f,k),b===null?C=T:b.sibling=T,b=T,z=_}if(N.done)return n(g,z),ae&&an(g,k),C;if(z===null){for(;!N.done;k++,N=m.next())N=h(g,N.value,w),N!==null&&(f=i(N,f,k),b===null?C=N:b.sibling=N,b=N);return ae&&an(g,k),C}for(z=r(g,z);!N.done;k++,N=m.next())N=v(z,g,k,N.value,w),N!==null&&(e&&N.alternate!==null&&z.delete(N.key===null?k:N.key),f=i(N,f,k),b===null?C=N:b.sibling=N,b=N);return e&&z.forEach(function(Y){return t(g,Y)}),ae&&an(g,k),C}function j(g,f,m,w){if(typeof m=="object"&&m!==null&&m.type===In&&m.key===null&&(m=m.props.children),typeof m=="object"&&m!==null){switch(m.$$typeof){case _s:e:{for(var C=m.key,b=f;b!==null;){if(b.key===C){if(C=m.type,C===In){if(b.tag===7){n(g,b.sibling),f=s(b,m.props.children),f.return=g,g=f;break e}}else if(b.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===At&&Tc(C)===b.type){n(g,b.sibling),f=s(b,m.props),f.ref=xr(g,b,m),f.return=g,g=f;break e}n(g,b);break}else t(g,b);b=b.sibling}m.type===In?(f=mn(m.props.children,g.mode,w,m.key),f.return=g,g=f):(w=Ys(m.type,m.key,m.props,null,g.mode,w),w.ref=xr(g,f,m),w.return=g,g=w)}return o(g);case $n:e:{for(b=m.key;f!==null;){if(f.key===b)if(f.tag===4&&f.stateNode.containerInfo===m.containerInfo&&f.stateNode.implementation===m.implementation){n(g,f.sibling),f=s(f,m.children||[]),f.return=g,g=f;break e}else{n(g,f);break}else t(g,f);f=f.sibling}f=Na(m,g.mode,w),f.return=g,g=f}return o(g);case At:return b=m._init,j(g,f,b(m._payload),w)}if(Nr(m))return y(g,f,m,w);if(fr(m))return x(g,f,m,w);$s(g,m)}return typeof m=="string"&&m!==""||typeof m=="number"?(m=""+m,f!==null&&f.tag===6?(n(g,f.sibling),f=s(f,m),f.return=g,g=f):(n(g,f),f=ka(m,g.mode,w),f.return=g,g=f),o(g)):n(g,f)}return j}var Xn=Ud(!0),Fd=Ud(!1),mi=en(null),pi=null,Fn=null,ml=null;function pl(){ml=Fn=pi=null}function gl(e){var t=mi.current;ie(mi),e._currentValue=t}function po(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Jn(e,t){pi=e,ml=Fn=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Re=!0),e.firstContext=null)}function Xe(e){var t=e._currentValue;if(ml!==e)if(e={context:e,memoizedValue:t,next:null},Fn===null){if(pi===null)throw Error(D(308));Fn=e,pi.dependencies={lanes:0,firstContext:e}}else Fn=Fn.next=e;return t}var dn=null;function vl(e){dn===null?dn=[e]:dn.push(e)}function Bd(e,t,n,r){var s=t.interleaved;return s===null?(n.next=n,vl(t)):(n.next=s.next,s.next=n),t.interleaved=n,Tt(e,r)}function Tt(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Ot=!1;function xl(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Hd(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Pt(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Gt(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,ee&2){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,Tt(e,n)}return s=r.interleaved,s===null?(t.next=t,vl(r)):(t.next=s.next,s.next=t),r.interleaved=t,Tt(e,n)}function Zs(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,rl(e,n)}}function zc(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=t:i=i.next=t}else s=i=t;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function gi(e,t,n,r){var s=e.updateQueue;Ot=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?i=u:o.next=u,o=c;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(i!==null){var h=s.baseState;o=0,d=u=c=null,l=i;do{var p=l.lane,v=l.eventTime;if((r&p)===p){d!==null&&(d=d.next={eventTime:v,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var y=e,x=l;switch(p=t,v=n,x.tag){case 1:if(y=x.payload,typeof y=="function"){h=y.call(v,h,p);break e}h=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=x.payload,p=typeof y=="function"?y.call(v,h,p):y,p==null)break e;h=ce({},h,p);break e;case 2:Ot=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,p=s.effects,p===null?s.effects=[l]:p.push(l))}else v={eventTime:v,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=v,c=h):d=d.next=v,o|=p;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;p=l,l=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(1);if(d===null&&(c=h),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,t=s.shared.interleaved,t!==null){s=t;do o|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);xn|=o,e.lanes=o,e.memoizedState=h}}function $c(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(D(191,s));s.call(r)}}}var ps={},pt=en(ps),Kr=en(ps),Xr=en(ps);function hn(e){if(e===ps)throw Error(D(174));return e}function yl(e,t){switch(re(Xr,t),re(Kr,e),re(pt,ps),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Ja(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Ja(t,e)}ie(pt),re(pt,t)}function er(){ie(pt),ie(Kr),ie(Xr)}function Wd(e){hn(Xr.current);var t=hn(pt.current),n=Ja(t,e.type);t!==n&&(re(Kr,e),re(pt,n))}function wl(e){Kr.current===e&&(ie(pt),ie(Kr))}var oe=en(0);function vi(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var xa=[];function _l(){for(var e=0;e<xa.length;e++)xa[e]._workInProgressVersionPrimary=null;xa.length=0}var Vs=$t.ReactCurrentDispatcher,ya=$t.ReactCurrentBatchConfig,vn=0,le=null,fe=null,ge=null,xi=!1,Dr=!1,es=0,xp=0;function be(){throw Error(D(321))}function bl(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ct(e[n],t[n]))return!1;return!0}function jl(e,t,n,r,s,i){if(vn=i,le=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Vs.current=e===null||e.memoizedState===null?bp:jp,e=n(r,s),Dr){i=0;do{if(Dr=!1,es=0,25<=i)throw Error(D(301));i+=1,ge=fe=null,t.updateQueue=null,Vs.current=kp,e=n(r,s)}while(Dr)}if(Vs.current=yi,t=fe!==null&&fe.next!==null,vn=0,ge=fe=le=null,xi=!1,t)throw Error(D(300));return e}function kl(){var e=es!==0;return es=0,e}function ht(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ge===null?le.memoizedState=ge=e:ge=ge.next=e,ge}function et(){if(fe===null){var e=le.alternate;e=e!==null?e.memoizedState:null}else e=fe.next;var t=ge===null?le.memoizedState:ge.next;if(t!==null)ge=t,fe=e;else{if(e===null)throw Error(D(310));fe=e,e={memoizedState:fe.memoizedState,baseState:fe.baseState,baseQueue:fe.baseQueue,queue:fe.queue,next:null},ge===null?le.memoizedState=ge=e:ge=ge.next=e}return ge}function ts(e,t){return typeof t=="function"?t(e):t}function wa(e){var t=et(),n=t.queue;if(n===null)throw Error(D(311));n.lastRenderedReducer=e;var r=fe,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,c=null,u=i;do{var d=u.lane;if((vn&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=h,o=r):c=c.next=h,le.lanes|=d,xn|=d}u=u.next}while(u!==null&&u!==i);c===null?o=r:c.next=l,ct(r,t.memoizedState)||(Re=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}if(e=n.interleaved,e!==null){s=e;do i=s.lane,le.lanes|=i,xn|=i,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function _a(e){var t=et(),n=t.queue;if(n===null)throw Error(D(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,i=t.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=e(i,o.action),o=o.next;while(o!==s);ct(i,t.memoizedState)||(Re=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function Zd(){}function Vd(e,t){var n=le,r=et(),s=t(),i=!ct(r.memoizedState,s);if(i&&(r.memoizedState=s,Re=!0),r=r.queue,Nl(qd.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||ge!==null&&ge.memoizedState.tag&1){if(n.flags|=2048,ns(9,Jd.bind(null,n,r,s,t),void 0,null),ve===null)throw Error(D(349));vn&30||Gd(n,t,s)}return s}function Gd(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=le.updateQueue,t===null?(t={lastEffect:null,stores:null},le.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Jd(e,t,n,r){t.value=n,t.getSnapshot=r,Qd(t)&&Yd(e)}function qd(e,t,n){return n(function(){Qd(t)&&Yd(e)})}function Qd(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ct(e,n)}catch{return!0}}function Yd(e){var t=Tt(e,1);t!==null&&lt(t,e,1,-1)}function Ic(e){var t=ht();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ts,lastRenderedState:e},t.queue=e,e=e.dispatch=_p.bind(null,le,e),[t.memoizedState,e]}function ns(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=le.updateQueue,t===null?(t={lastEffect:null,stores:null},le.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function Kd(){return et().memoizedState}function Gs(e,t,n,r){var s=ht();le.flags|=e,s.memoizedState=ns(1|t,n,void 0,r===void 0?null:r)}function Ri(e,t,n,r){var s=et();r=r===void 0?null:r;var i=void 0;if(fe!==null){var o=fe.memoizedState;if(i=o.destroy,r!==null&&bl(r,o.deps)){s.memoizedState=ns(t,n,i,r);return}}le.flags|=e,s.memoizedState=ns(1|t,n,i,r)}function Lc(e,t){return Gs(8390656,8,e,t)}function Nl(e,t){return Ri(2048,8,e,t)}function Xd(e,t){return Ri(4,2,e,t)}function eh(e,t){return Ri(4,4,e,t)}function th(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function nh(e,t,n){return n=n!=null?n.concat([e]):null,Ri(4,4,th.bind(null,t,e),n)}function Sl(){}function rh(e,t){var n=et();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&bl(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function sh(e,t){var n=et();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&bl(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function ih(e,t,n){return vn&21?(ct(n,t)||(n=ud(),le.lanes|=n,xn|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Re=!0),e.memoizedState=n)}function yp(e,t){var n=te;te=n!==0&&4>n?n:4,e(!0);var r=ya.transition;ya.transition={};try{e(!1),t()}finally{te=n,ya.transition=r}}function ah(){return et().memoizedState}function wp(e,t,n){var r=qt(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},oh(e))lh(t,n);else if(n=Bd(e,t,n,r),n!==null){var s=ze();lt(n,e,r,s),ch(n,t,r)}}function _p(e,t,n){var r=qt(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(oh(e))lh(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,ct(l,o)){var c=t.interleaved;c===null?(s.next=s,vl(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}n=Bd(e,t,s,r),n!==null&&(s=ze(),lt(n,e,r,s),ch(n,t,r))}}function oh(e){var t=e.alternate;return e===le||t!==null&&t===le}function lh(e,t){Dr=xi=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function ch(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,rl(e,n)}}var yi={readContext:Xe,useCallback:be,useContext:be,useEffect:be,useImperativeHandle:be,useInsertionEffect:be,useLayoutEffect:be,useMemo:be,useReducer:be,useRef:be,useState:be,useDebugValue:be,useDeferredValue:be,useTransition:be,useMutableSource:be,useSyncExternalStore:be,useId:be,unstable_isNewReconciler:!1},bp={readContext:Xe,useCallback:function(e,t){return ht().memoizedState=[e,t===void 0?null:t],e},useContext:Xe,useEffect:Lc,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Gs(4194308,4,th.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Gs(4194308,4,e,t)},useInsertionEffect:function(e,t){return Gs(4,2,e,t)},useMemo:function(e,t){var n=ht();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=ht();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=wp.bind(null,le,e),[r.memoizedState,e]},useRef:function(e){var t=ht();return e={current:e},t.memoizedState=e},useState:Ic,useDebugValue:Sl,useDeferredValue:function(e){return ht().memoizedState=e},useTransition:function(){var e=Ic(!1),t=e[0];return e=yp.bind(null,e[1]),ht().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=le,s=ht();if(ae){if(n===void 0)throw Error(D(407));n=n()}else{if(n=t(),ve===null)throw Error(D(349));vn&30||Gd(r,t,n)}s.memoizedState=n;var i={value:n,getSnapshot:t};return s.queue=i,Lc(qd.bind(null,r,i,e),[e]),r.flags|=2048,ns(9,Jd.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=ht(),t=ve.identifierPrefix;if(ae){var n=Nt,r=kt;n=(r&~(1<<32-ot(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=es++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=xp++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},jp={readContext:Xe,useCallback:rh,useContext:Xe,useEffect:Nl,useImperativeHandle:nh,useInsertionEffect:Xd,useLayoutEffect:eh,useMemo:sh,useReducer:wa,useRef:Kd,useState:function(){return wa(ts)},useDebugValue:Sl,useDeferredValue:function(e){var t=et();return ih(t,fe.memoizedState,e)},useTransition:function(){var e=wa(ts)[0],t=et().memoizedState;return[e,t]},useMutableSource:Zd,useSyncExternalStore:Vd,useId:ah,unstable_isNewReconciler:!1},kp={readContext:Xe,useCallback:rh,useContext:Xe,useEffect:Nl,useImperativeHandle:nh,useInsertionEffect:Xd,useLayoutEffect:eh,useMemo:sh,useReducer:_a,useRef:Kd,useState:function(){return _a(ts)},useDebugValue:Sl,useDeferredValue:function(e){var t=et();return fe===null?t.memoizedState=e:ih(t,fe.memoizedState,e)},useTransition:function(){var e=_a(ts)[0],t=et().memoizedState;return[e,t]},useMutableSource:Zd,useSyncExternalStore:Vd,useId:ah,unstable_isNewReconciler:!1};function rt(e,t){if(e&&e.defaultProps){t=ce({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function go(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:ce({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Mi={isMounted:function(e){return(e=e._reactInternals)?_n(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ze(),s=qt(e),i=Pt(r,s);i.payload=t,n!=null&&(i.callback=n),t=Gt(e,i,s),t!==null&&(lt(t,e,s,r),Zs(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ze(),s=qt(e),i=Pt(r,s);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=Gt(e,i,s),t!==null&&(lt(t,e,s,r),Zs(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ze(),r=qt(e),s=Pt(n,r);s.tag=2,t!=null&&(s.callback=t),t=Gt(e,s,r),t!==null&&(lt(t,e,r,n),Zs(t,e,r))}};function Dc(e,t,n,r,s,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,o):t.prototype&&t.prototype.isPureReactComponent?!Jr(n,r)||!Jr(s,i):!0}function uh(e,t,n){var r=!1,s=Kt,i=t.contextType;return typeof i=="object"&&i!==null?i=Xe(i):(s=Ue(t)?pn:Pe.current,r=t.contextTypes,i=(r=r!=null)?Yn(e,s):Kt),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Mi,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function Ac(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Mi.enqueueReplaceState(t,t.state,null)}function vo(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},xl(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=Xe(i):(i=Ue(t)?pn:Pe.current,s.context=Yn(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(go(e,t,i,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&Mi.enqueueReplaceState(s,s.state,null),gi(e,n,s,r),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function tr(e,t){try{var n="",r=t;do n+=Kf(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function ba(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function xo(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var Np=typeof WeakMap=="function"?WeakMap:Map;function dh(e,t,n){n=Pt(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){_i||(_i=!0,Co=r),xo(e,t)},n}function hh(e,t,n){n=Pt(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){xo(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){xo(e,t),typeof r!="function"&&(Jt===null?Jt=new Set([this]):Jt.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function Oc(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new Np;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=Mp.bind(null,e,t,n),t.then(e,e))}function Rc(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Mc(e,t,n,r,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Pt(-1,1),t.tag=2,Gt(n,t,1))),n.lanes|=1),e)}var Sp=$t.ReactCurrentOwner,Re=!1;function Ee(e,t,n,r){t.child=e===null?Fd(t,null,n,r):Xn(t,e.child,n,r)}function Uc(e,t,n,r,s){n=n.render;var i=t.ref;return Jn(t,s),r=jl(e,t,n,r,i,s),n=kl(),e!==null&&!Re?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,zt(e,t,s)):(ae&&n&&dl(t),t.flags|=1,Ee(e,t,r,s),t.child)}function Fc(e,t,n,r,s){if(e===null){var i=n.type;return typeof i=="function"&&!Ll(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,fh(e,t,i,r,s)):(e=Ys(n.type,null,r,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Jr,n(o,r)&&e.ref===t.ref)return zt(e,t,s)}return t.flags|=1,e=Qt(i,r),e.ref=t.ref,e.return=t,t.child=e}function fh(e,t,n,r,s){if(e!==null){var i=e.memoizedProps;if(Jr(i,r)&&e.ref===t.ref)if(Re=!1,t.pendingProps=r=i,(e.lanes&s)!==0)e.flags&131072&&(Re=!0);else return t.lanes=e.lanes,zt(e,t,s)}return yo(e,t,n,r,s)}function mh(e,t,n){var r=t.pendingProps,s=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},re(Hn,Be),Be|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,re(Hn,Be),Be|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,re(Hn,Be),Be|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,re(Hn,Be),Be|=r;return Ee(e,t,s,n),t.child}function ph(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function yo(e,t,n,r,s){var i=Ue(n)?pn:Pe.current;return i=Yn(t,i),Jn(t,s),n=jl(e,t,n,r,i,s),r=kl(),e!==null&&!Re?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,zt(e,t,s)):(ae&&r&&dl(t),t.flags|=1,Ee(e,t,n,s),t.child)}function Bc(e,t,n,r,s){if(Ue(n)){var i=!0;di(t)}else i=!1;if(Jn(t,s),t.stateNode===null)Js(e,t),uh(t,n,r),vo(t,n,r,s),r=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=Xe(u):(u=Ue(n)?pn:Pe.current,u=Yn(t,u));var d=n.getDerivedStateFromProps,h=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==u)&&Ac(t,o,r,u),Ot=!1;var p=t.memoizedState;o.state=p,gi(t,r,o,s),c=t.memoizedState,l!==r||p!==c||Me.current||Ot?(typeof d=="function"&&(go(t,n,d,r),c=t.memoizedState),(l=Ot||Dc(t,n,l,r,p,c,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),o.props=r,o.state=c,o.context=u,r=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Hd(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:rt(t.type,l),o.props=u,h=t.pendingProps,p=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=Xe(c):(c=Ue(n)?pn:Pe.current,c=Yn(t,c));var v=n.getDerivedStateFromProps;(d=typeof v=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==h||p!==c)&&Ac(t,o,r,c),Ot=!1,p=t.memoizedState,o.state=p,gi(t,r,o,s);var y=t.memoizedState;l!==h||p!==y||Me.current||Ot?(typeof v=="function"&&(go(t,n,v,r),y=t.memoizedState),(u=Ot||Dc(t,n,u,r,p,y,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,y,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,y,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=y),o.props=r,o.state=y,o.context=c,r=u):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),r=!1)}return wo(e,t,n,r,i,s)}function wo(e,t,n,r,s,i){ph(e,t);var o=(t.flags&128)!==0;if(!r&&!o)return s&&Pc(t,n,!1),zt(e,t,i);r=t.stateNode,Sp.current=t;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&o?(t.child=Xn(t,e.child,null,i),t.child=Xn(t,null,l,i)):Ee(e,t,l,i),t.memoizedState=r.state,s&&Pc(t,n,!0),t.child}function gh(e){var t=e.stateNode;t.pendingContext?Sc(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Sc(e,t.context,!1),yl(e,t.containerInfo)}function Hc(e,t,n,r,s){return Kn(),fl(s),t.flags|=256,Ee(e,t,n,r),t.child}var _o={dehydrated:null,treeContext:null,retryLane:0};function bo(e){return{baseLanes:e,cachePool:null,transitions:null}}function vh(e,t,n){var r=t.pendingProps,s=oe.current,i=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),re(oe,s&1),e===null)return mo(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=r.children,e=r.fallback,i?(r=t.mode,i=t.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Bi(o,r,0,null),e=mn(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=bo(n),t.memoizedState=_o,e):Pl(t,o));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return Pp(e,t,o,r,l,s,n);if(i){i=r.fallback,o=t.mode,s=e.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&t.child!==s?(r=t.child,r.childLanes=0,r.pendingProps=c,t.deletions=null):(r=Qt(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Qt(l,i):(i=mn(i,o,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,o=e.child.memoizedState,o=o===null?bo(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~n,t.memoizedState=_o,r}return i=e.child,e=i.sibling,r=Qt(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Pl(e,t){return t=Bi({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Is(e,t,n,r){return r!==null&&fl(r),Xn(t,e.child,null,n),e=Pl(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Pp(e,t,n,r,s,i,o){if(n)return t.flags&256?(t.flags&=-257,r=ba(Error(D(422))),Is(e,t,o,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,s=t.mode,r=Bi({mode:"visible",children:r.children},s,0,null),i=mn(i,s,o,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&Xn(t,e.child,null,o),t.child.memoizedState=bo(o),t.memoizedState=_o,i);if(!(t.mode&1))return Is(e,t,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(D(419)),r=ba(i,r,void 0),Is(e,t,o,r)}if(l=(o&e.childLanes)!==0,Re||l){if(r=ve,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Tt(e,s),lt(r,e,s,-1))}return Il(),r=ba(Error(D(421))),Is(e,t,o,r)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=Up.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,He=Vt(s.nextSibling),We=t,ae=!0,at=null,e!==null&&(Je[qe++]=kt,Je[qe++]=Nt,Je[qe++]=gn,kt=e.id,Nt=e.overflow,gn=t),t=Pl(t,r.children),t.flags|=4096,t)}function Wc(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),po(e.return,t,n)}function ja(e,t,n,r,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function xh(e,t,n){var r=t.pendingProps,s=r.revealOrder,i=r.tail;if(Ee(e,t,r.children,n),r=oe.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Wc(e,n,t);else if(e.tag===19)Wc(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(re(oe,r),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&vi(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),ja(t,!1,s,n,i);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&vi(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}ja(t,!0,n,null,i);break;case"together":ja(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Js(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function zt(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),xn|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(D(153));if(t.child!==null){for(e=t.child,n=Qt(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Qt(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Cp(e,t,n){switch(t.tag){case 3:gh(t),Kn();break;case 5:Wd(t);break;case 1:Ue(t.type)&&di(t);break;case 4:yl(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;re(mi,r._currentValue),r._currentValue=s;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(re(oe,oe.current&1),t.flags|=128,null):n&t.child.childLanes?vh(e,t,n):(re(oe,oe.current&1),e=zt(e,t,n),e!==null?e.sibling:null);re(oe,oe.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return xh(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),re(oe,oe.current),r)break;return null;case 22:case 23:return t.lanes=0,mh(e,t,n)}return zt(e,t,n)}var yh,jo,wh,_h;yh=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};jo=function(){};wh=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,hn(pt.current);var i=null;switch(n){case"input":s=Wa(e,s),r=Wa(e,r),i=[];break;case"select":s=ce({},s,{value:void 0}),r=ce({},r,{value:void 0}),i=[];break;case"textarea":s=Ga(e,s),r=Ga(e,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=ci)}qa(n,r);var o;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Fr.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var c=r[u];if(l=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Fr.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&se("scroll",e),i||l===c||(i=[])):(i=i||[]).push(u,c))}n&&(i=i||[]).push("style",n);var u=i;(t.updateQueue=u)&&(t.flags|=4)}};_h=function(e,t,n,r){n!==r&&(t.flags|=4)};function yr(e,t){if(!ae)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function je(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Ep(e,t,n){var r=t.pendingProps;switch(hl(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return je(t),null;case 1:return Ue(t.type)&&ui(),je(t),null;case 3:return r=t.stateNode,er(),ie(Me),ie(Pe),_l(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(zs(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,at!==null&&(zo(at),at=null))),jo(e,t),je(t),null;case 5:wl(t);var s=hn(Xr.current);if(n=t.type,e!==null&&t.stateNode!=null)wh(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(D(166));return je(t),null}if(e=hn(pt.current),zs(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[ft]=t,r[Yr]=i,e=(t.mode&1)!==0,n){case"dialog":se("cancel",r),se("close",r);break;case"iframe":case"object":case"embed":se("load",r);break;case"video":case"audio":for(s=0;s<Pr.length;s++)se(Pr[s],r);break;case"source":se("error",r);break;case"img":case"image":case"link":se("error",r),se("load",r);break;case"details":se("toggle",r);break;case"input":Xl(r,i),se("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},se("invalid",r);break;case"textarea":tc(r,i),se("invalid",r)}qa(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&Ts(r.textContent,l,e),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Ts(r.textContent,l,e),s=["children",""+l]):Fr.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&se("scroll",r)}switch(n){case"input":bs(r),ec(r,i,!0);break;case"textarea":bs(r),nc(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=ci)}r=s,t.updateQueue=r,r!==null&&(t.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=qu(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=o.createElement(n,{is:r.is}):(e=o.createElement(n),n==="select"&&(o=e,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):e=o.createElementNS(e,n),e[ft]=t,e[Yr]=r,yh(e,t,!1,!1),t.stateNode=e;e:{switch(o=Qa(n,r),n){case"dialog":se("cancel",e),se("close",e),s=r;break;case"iframe":case"object":case"embed":se("load",e),s=r;break;case"video":case"audio":for(s=0;s<Pr.length;s++)se(Pr[s],e);s=r;break;case"source":se("error",e),s=r;break;case"img":case"image":case"link":se("error",e),se("load",e),s=r;break;case"details":se("toggle",e),s=r;break;case"input":Xl(e,r),s=Wa(e,r),se("invalid",e);break;case"option":s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=ce({},r,{value:void 0}),se("invalid",e);break;case"textarea":tc(e,r),s=Ga(e,r),se("invalid",e);break;default:s=r}qa(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?Ku(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Qu(e,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Br(e,c):typeof c=="number"&&Br(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Fr.hasOwnProperty(i)?c!=null&&i==="onScroll"&&se("scroll",e):c!=null&&Yo(e,i,c,o))}switch(n){case"input":bs(e),ec(e,r,!1);break;case"textarea":bs(e),nc(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Yt(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?Wn(e,!!r.multiple,i,!1):r.defaultValue!=null&&Wn(e,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=ci)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return je(t),null;case 6:if(e&&t.stateNode!=null)_h(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(D(166));if(n=hn(Xr.current),hn(pt.current),zs(t)){if(r=t.stateNode,n=t.memoizedProps,r[ft]=t,(i=r.nodeValue!==n)&&(e=We,e!==null))switch(e.tag){case 3:Ts(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Ts(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[ft]=t,t.stateNode=r}return je(t),null;case 13:if(ie(oe),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(ae&&He!==null&&t.mode&1&&!(t.flags&128))Md(),Kn(),t.flags|=98560,i=!1;else if(i=zs(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(D(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(D(317));i[ft]=t}else Kn(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;je(t),i=!1}else at!==null&&(zo(at),at=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||oe.current&1?me===0&&(me=3):Il())),t.updateQueue!==null&&(t.flags|=4),je(t),null);case 4:return er(),jo(e,t),e===null&&qr(t.stateNode.containerInfo),je(t),null;case 10:return gl(t.type._context),je(t),null;case 17:return Ue(t.type)&&ui(),je(t),null;case 19:if(ie(oe),i=t.memoizedState,i===null)return je(t),null;if(r=(t.flags&128)!==0,o=i.rendering,o===null)if(r)yr(i,!1);else{if(me!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=vi(e),o!==null){for(t.flags|=128,yr(i,!1),r=o.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return re(oe,oe.current&1|2),t.child}e=e.sibling}i.tail!==null&&de()>nr&&(t.flags|=128,r=!0,yr(i,!1),t.lanes=4194304)}else{if(!r)if(e=vi(o),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),yr(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!ae)return je(t),null}else 2*de()-i.renderingStartTime>nr&&n!==1073741824&&(t.flags|=128,r=!0,yr(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(n=i.last,n!==null?n.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=de(),t.sibling=null,n=oe.current,re(oe,r?n&1|2:n&1),t):(je(t),null);case 22:case 23:return $l(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Be&1073741824&&(je(t),t.subtreeFlags&6&&(t.flags|=8192)):je(t),null;case 24:return null;case 25:return null}throw Error(D(156,t.tag))}function Tp(e,t){switch(hl(t),t.tag){case 1:return Ue(t.type)&&ui(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return er(),ie(Me),ie(Pe),_l(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return wl(t),null;case 13:if(ie(oe),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(D(340));Kn()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ie(oe),null;case 4:return er(),null;case 10:return gl(t.type._context),null;case 22:case 23:return $l(),null;case 24:return null;default:return null}}var Ls=!1,Ne=!1,zp=typeof WeakSet=="function"?WeakSet:Set,R=null;function Bn(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ue(e,t,r)}else n.current=null}function ko(e,t,n){try{n()}catch(r){ue(e,t,r)}}var Zc=!1;function $p(e,t){if(ao=ai,e=Sd(),ul(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,u=0,d=0,h=e,p=null;t:for(;;){for(var v;h!==n||s!==0&&h.nodeType!==3||(l=o+s),h!==i||r!==0&&h.nodeType!==3||(c=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(v=h.firstChild)!==null;)p=h,h=v;for(;;){if(h===e)break t;if(p===n&&++u===s&&(l=o),p===i&&++d===r&&(c=o),(v=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=v}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(oo={focusedElem:e,selectionRange:n},ai=!1,R=t;R!==null;)if(t=R,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,R=e;else for(;R!==null;){t=R;try{var y=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var x=y.memoizedProps,j=y.memoizedState,g=t.stateNode,f=g.getSnapshotBeforeUpdate(t.elementType===t.type?x:rt(t.type,x),j);g.__reactInternalSnapshotBeforeUpdate=f}break;case 3:var m=t.stateNode.containerInfo;m.nodeType===1?m.textContent="":m.nodeType===9&&m.documentElement&&m.removeChild(m.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(D(163))}}catch(w){ue(t,t.return,w)}if(e=t.sibling,e!==null){e.return=t.return,R=e;break}R=t.return}return y=Zc,Zc=!1,y}function Ar(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&ko(t,n,i)}s=s.next}while(s!==r)}}function Ui(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function No(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function bh(e){var t=e.alternate;t!==null&&(e.alternate=null,bh(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[ft],delete t[Yr],delete t[uo],delete t[mp],delete t[pp])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function jh(e){return e.tag===5||e.tag===3||e.tag===4}function Vc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||jh(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function So(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=ci));else if(r!==4&&(e=e.child,e!==null))for(So(e,t,n),e=e.sibling;e!==null;)So(e,t,n),e=e.sibling}function Po(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Po(e,t,n),e=e.sibling;e!==null;)Po(e,t,n),e=e.sibling}var xe=null,st=!1;function It(e,t,n){for(n=n.child;n!==null;)kh(e,t,n),n=n.sibling}function kh(e,t,n){if(mt&&typeof mt.onCommitFiberUnmount=="function")try{mt.onCommitFiberUnmount($i,n)}catch{}switch(n.tag){case 5:Ne||Bn(n,t);case 6:var r=xe,s=st;xe=null,It(e,t,n),xe=r,st=s,xe!==null&&(st?(e=xe,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):xe.removeChild(n.stateNode));break;case 18:xe!==null&&(st?(e=xe,n=n.stateNode,e.nodeType===8?ga(e.parentNode,n):e.nodeType===1&&ga(e,n),Vr(e)):ga(xe,n.stateNode));break;case 4:r=xe,s=st,xe=n.stateNode.containerInfo,st=!0,It(e,t,n),xe=r,st=s;break;case 0:case 11:case 14:case 15:if(!Ne&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&ko(n,t,o),s=s.next}while(s!==r)}It(e,t,n);break;case 1:if(!Ne&&(Bn(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){ue(n,t,l)}It(e,t,n);break;case 21:It(e,t,n);break;case 22:n.mode&1?(Ne=(r=Ne)||n.memoizedState!==null,It(e,t,n),Ne=r):It(e,t,n);break;default:It(e,t,n)}}function Gc(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new zp),t.forEach(function(r){var s=Fp.bind(null,e,r);n.has(r)||(n.add(r),r.then(s,s))})}}function tt(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:xe=l.stateNode,st=!1;break e;case 3:xe=l.stateNode.containerInfo,st=!0;break e;case 4:xe=l.stateNode.containerInfo,st=!0;break e}l=l.return}if(xe===null)throw Error(D(160));kh(i,o,s),xe=null,st=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){ue(s,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Nh(t,e),t=t.sibling}function Nh(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(tt(t,e),dt(e),r&4){try{Ar(3,e,e.return),Ui(3,e)}catch(x){ue(e,e.return,x)}try{Ar(5,e,e.return)}catch(x){ue(e,e.return,x)}}break;case 1:tt(t,e),dt(e),r&512&&n!==null&&Bn(n,n.return);break;case 5:if(tt(t,e),dt(e),r&512&&n!==null&&Bn(n,n.return),e.flags&32){var s=e.stateNode;try{Br(s,"")}catch(x){ue(e,e.return,x)}}if(r&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,o=n!==null?n.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&Gu(s,i),Qa(l,o);var u=Qa(l,i);for(o=0;o<c.length;o+=2){var d=c[o],h=c[o+1];d==="style"?Ku(s,h):d==="dangerouslySetInnerHTML"?Qu(s,h):d==="children"?Br(s,h):Yo(s,d,h,u)}switch(l){case"input":Za(s,i);break;case"textarea":Ju(s,i);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var v=i.value;v!=null?Wn(s,!!i.multiple,v,!1):p!==!!i.multiple&&(i.defaultValue!=null?Wn(s,!!i.multiple,i.defaultValue,!0):Wn(s,!!i.multiple,i.multiple?[]:"",!1))}s[Yr]=i}catch(x){ue(e,e.return,x)}}break;case 6:if(tt(t,e),dt(e),r&4){if(e.stateNode===null)throw Error(D(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(x){ue(e,e.return,x)}}break;case 3:if(tt(t,e),dt(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Vr(t.containerInfo)}catch(x){ue(e,e.return,x)}break;case 4:tt(t,e),dt(e);break;case 13:tt(t,e),dt(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Tl=de())),r&4&&Gc(e);break;case 22:if(d=n!==null&&n.memoizedState!==null,e.mode&1?(Ne=(u=Ne)||d,tt(t,e),Ne=u):tt(t,e),dt(e),r&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(R=e,d=e.child;d!==null;){for(h=R=d;R!==null;){switch(p=R,v=p.child,p.tag){case 0:case 11:case 14:case 15:Ar(4,p,p.return);break;case 1:Bn(p,p.return);var y=p.stateNode;if(typeof y.componentWillUnmount=="function"){r=p,n=p.return;try{t=r,y.props=t.memoizedProps,y.state=t.memoizedState,y.componentWillUnmount()}catch(x){ue(r,n,x)}}break;case 5:Bn(p,p.return);break;case 22:if(p.memoizedState!==null){qc(h);continue}}v!==null?(v.return=p,R=v):qc(h)}d=d.sibling}e:for(d=null,h=e;;){if(h.tag===5){if(d===null){d=h;try{s=h.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=h.stateNode,c=h.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=Yu("display",o))}catch(x){ue(e,e.return,x)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(x){ue(e,e.return,x)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:tt(t,e),dt(e),r&4&&Gc(e);break;case 21:break;default:tt(t,e),dt(e)}}function dt(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(jh(n)){var r=n;break e}n=n.return}throw Error(D(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Br(s,""),r.flags&=-33);var i=Vc(e);Po(e,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=Vc(e);So(e,l,o);break;default:throw Error(D(161))}}catch(c){ue(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Ip(e,t,n){R=e,Sh(e)}function Sh(e,t,n){for(var r=(e.mode&1)!==0;R!==null;){var s=R,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Ls;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||Ne;l=Ls;var u=Ne;if(Ls=o,(Ne=c)&&!u)for(R=s;R!==null;)o=R,c=o.child,o.tag===22&&o.memoizedState!==null?Qc(s):c!==null?(c.return=o,R=c):Qc(s);for(;i!==null;)R=i,Sh(i),i=i.sibling;R=s,Ls=l,Ne=u}Jc(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,R=i):Jc(e)}}function Jc(e){for(;R!==null;){var t=R;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ne||Ui(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!Ne)if(n===null)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:rt(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&$c(t,i,r);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}$c(t,o,n)}break;case 5:var l=t.stateNode;if(n===null&&t.flags&4){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&Vr(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(D(163))}Ne||t.flags&512&&No(t)}catch(p){ue(t,t.return,p)}}if(t===e){R=null;break}if(n=t.sibling,n!==null){n.return=t.return,R=n;break}R=t.return}}function qc(e){for(;R!==null;){var t=R;if(t===e){R=null;break}var n=t.sibling;if(n!==null){n.return=t.return,R=n;break}R=t.return}}function Qc(e){for(;R!==null;){var t=R;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Ui(4,t)}catch(c){ue(t,n,c)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var s=t.return;try{r.componentDidMount()}catch(c){ue(t,s,c)}}var i=t.return;try{No(t)}catch(c){ue(t,i,c)}break;case 5:var o=t.return;try{No(t)}catch(c){ue(t,o,c)}}}catch(c){ue(t,t.return,c)}if(t===e){R=null;break}var l=t.sibling;if(l!==null){l.return=t.return,R=l;break}R=t.return}}var Lp=Math.ceil,wi=$t.ReactCurrentDispatcher,Cl=$t.ReactCurrentOwner,Ye=$t.ReactCurrentBatchConfig,ee=0,ve=null,he=null,ye=0,Be=0,Hn=en(0),me=0,rs=null,xn=0,Fi=0,El=0,Or=null,Ae=null,Tl=0,nr=1/0,wt=null,_i=!1,Co=null,Jt=null,Ds=!1,Bt=null,bi=0,Rr=0,Eo=null,qs=-1,Qs=0;function ze(){return ee&6?de():qs!==-1?qs:qs=de()}function qt(e){return e.mode&1?ee&2&&ye!==0?ye&-ye:vp.transition!==null?(Qs===0&&(Qs=ud()),Qs):(e=te,e!==0||(e=window.event,e=e===void 0?16:vd(e.type)),e):1}function lt(e,t,n,r){if(50<Rr)throw Rr=0,Eo=null,Error(D(185));hs(e,n,r),(!(ee&2)||e!==ve)&&(e===ve&&(!(ee&2)&&(Fi|=n),me===4&&Mt(e,ye)),Fe(e,r),n===1&&ee===0&&!(t.mode&1)&&(nr=de()+500,Oi&&tn()))}function Fe(e,t){var n=e.callbackNode;vm(e,t);var r=ii(e,e===ve?ye:0);if(r===0)n!==null&&ic(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&ic(n),t===1)e.tag===0?gp(Yc.bind(null,e)):Ad(Yc.bind(null,e)),hp(function(){!(ee&6)&&tn()}),n=null;else{switch(dd(r)){case 1:n=nl;break;case 4:n=ld;break;case 16:n=si;break;case 536870912:n=cd;break;default:n=si}n=Lh(n,Ph.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Ph(e,t){if(qs=-1,Qs=0,ee&6)throw Error(D(327));var n=e.callbackNode;if(qn()&&e.callbackNode!==n)return null;var r=ii(e,e===ve?ye:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=ji(e,r);else{t=r;var s=ee;ee|=2;var i=Eh();(ve!==e||ye!==t)&&(wt=null,nr=de()+500,fn(e,t));do try{Op();break}catch(l){Ch(e,l)}while(1);pl(),wi.current=i,ee=s,he!==null?t=0:(ve=null,ye=0,t=me)}if(t!==0){if(t===2&&(s=to(e),s!==0&&(r=s,t=To(e,s))),t===1)throw n=rs,fn(e,0),Mt(e,r),Fe(e,de()),n;if(t===6)Mt(e,r);else{if(s=e.current.alternate,!(r&30)&&!Dp(s)&&(t=ji(e,r),t===2&&(i=to(e),i!==0&&(r=i,t=To(e,i))),t===1))throw n=rs,fn(e,0),Mt(e,r),Fe(e,de()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(D(345));case 2:on(e,Ae,wt);break;case 3:if(Mt(e,r),(r&130023424)===r&&(t=Tl+500-de(),10<t)){if(ii(e,0)!==0)break;if(s=e.suspendedLanes,(s&r)!==r){ze(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=co(on.bind(null,e,Ae,wt),t);break}on(e,Ae,wt);break;case 4:if(Mt(e,r),(r&4194240)===r)break;for(t=e.eventTimes,s=-1;0<r;){var o=31-ot(r);i=1<<o,o=t[o],o>s&&(s=o),r&=~i}if(r=s,r=de()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Lp(r/1960))-r,10<r){e.timeoutHandle=co(on.bind(null,e,Ae,wt),r);break}on(e,Ae,wt);break;case 5:on(e,Ae,wt);break;default:throw Error(D(329))}}}return Fe(e,de()),e.callbackNode===n?Ph.bind(null,e):null}function To(e,t){var n=Or;return e.current.memoizedState.isDehydrated&&(fn(e,t).flags|=256),e=ji(e,t),e!==2&&(t=Ae,Ae=n,t!==null&&zo(t)),e}function zo(e){Ae===null?Ae=e:Ae.push.apply(Ae,e)}function Dp(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!ct(i(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Mt(e,t){for(t&=~El,t&=~Fi,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),r=1<<n;e[n]=-1,t&=~r}}function Yc(e){if(ee&6)throw Error(D(327));qn();var t=ii(e,0);if(!(t&1))return Fe(e,de()),null;var n=ji(e,t);if(e.tag!==0&&n===2){var r=to(e);r!==0&&(t=r,n=To(e,r))}if(n===1)throw n=rs,fn(e,0),Mt(e,t),Fe(e,de()),n;if(n===6)throw Error(D(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,on(e,Ae,wt),Fe(e,de()),null}function zl(e,t){var n=ee;ee|=1;try{return e(t)}finally{ee=n,ee===0&&(nr=de()+500,Oi&&tn())}}function yn(e){Bt!==null&&Bt.tag===0&&!(ee&6)&&qn();var t=ee;ee|=1;var n=Ye.transition,r=te;try{if(Ye.transition=null,te=1,e)return e()}finally{te=r,Ye.transition=n,ee=t,!(ee&6)&&tn()}}function $l(){Be=Hn.current,ie(Hn)}function fn(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,dp(n)),he!==null)for(n=he.return;n!==null;){var r=n;switch(hl(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&ui();break;case 3:er(),ie(Me),ie(Pe),_l();break;case 5:wl(r);break;case 4:er();break;case 13:ie(oe);break;case 19:ie(oe);break;case 10:gl(r.type._context);break;case 22:case 23:$l()}n=n.return}if(ve=e,he=e=Qt(e.current,null),ye=Be=t,me=0,rs=null,El=Fi=xn=0,Ae=Or=null,dn!==null){for(t=0;t<dn.length;t++)if(n=dn[t],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}dn=null}return e}function Ch(e,t){do{var n=he;try{if(pl(),Vs.current=yi,xi){for(var r=le.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}xi=!1}if(vn=0,ge=fe=le=null,Dr=!1,es=0,Cl.current=null,n===null||n.return===null){me=1,rs=t,he=null;break}e:{var i=e,o=n.return,l=n,c=t;if(t=ye,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var v=Rc(o);if(v!==null){v.flags&=-257,Mc(v,o,l,i,t),v.mode&1&&Oc(i,u,t),t=v,c=u;var y=t.updateQueue;if(y===null){var x=new Set;x.add(c),t.updateQueue=x}else y.add(c);break e}else{if(!(t&1)){Oc(i,u,t),Il();break e}c=Error(D(426))}}else if(ae&&l.mode&1){var j=Rc(o);if(j!==null){!(j.flags&65536)&&(j.flags|=256),Mc(j,o,l,i,t),fl(tr(c,l));break e}}i=c=tr(c,l),me!==4&&(me=2),Or===null?Or=[i]:Or.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var g=dh(i,c,t);zc(i,g);break e;case 1:l=c;var f=i.type,m=i.stateNode;if(!(i.flags&128)&&(typeof f.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(Jt===null||!Jt.has(m)))){i.flags|=65536,t&=-t,i.lanes|=t;var w=hh(i,l,t);zc(i,w);break e}}i=i.return}while(i!==null)}zh(n)}catch(C){t=C,he===n&&n!==null&&(he=n=n.return);continue}break}while(1)}function Eh(){var e=wi.current;return wi.current=yi,e===null?yi:e}function Il(){(me===0||me===3||me===2)&&(me=4),ve===null||!(xn&268435455)&&!(Fi&268435455)||Mt(ve,ye)}function ji(e,t){var n=ee;ee|=2;var r=Eh();(ve!==e||ye!==t)&&(wt=null,fn(e,t));do try{Ap();break}catch(s){Ch(e,s)}while(1);if(pl(),ee=n,wi.current=r,he!==null)throw Error(D(261));return ve=null,ye=0,me}function Ap(){for(;he!==null;)Th(he)}function Op(){for(;he!==null&&!lm();)Th(he)}function Th(e){var t=Ih(e.alternate,e,Be);e.memoizedProps=e.pendingProps,t===null?zh(e):he=t,Cl.current=null}function zh(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=Tp(n,t),n!==null){n.flags&=32767,he=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{me=6,he=null;return}}else if(n=Ep(n,t,Be),n!==null){he=n;return}if(t=t.sibling,t!==null){he=t;return}he=t=e}while(t!==null);me===0&&(me=5)}function on(e,t,n){var r=te,s=Ye.transition;try{Ye.transition=null,te=1,Rp(e,t,n,r)}finally{Ye.transition=s,te=r}return null}function Rp(e,t,n,r){do qn();while(Bt!==null);if(ee&6)throw Error(D(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(D(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(xm(e,i),e===ve&&(he=ve=null,ye=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ds||(Ds=!0,Lh(si,function(){return qn(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Ye.transition,Ye.transition=null;var o=te;te=1;var l=ee;ee|=4,Cl.current=null,$p(e,n),Nh(n,e),sp(oo),ai=!!ao,oo=ao=null,e.current=n,Ip(n),cm(),ee=l,te=o,Ye.transition=i}else e.current=n;if(Ds&&(Ds=!1,Bt=e,bi=s),i=e.pendingLanes,i===0&&(Jt=null),hm(n.stateNode),Fe(e,de()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(_i)throw _i=!1,e=Co,Co=null,e;return bi&1&&e.tag!==0&&qn(),i=e.pendingLanes,i&1?e===Eo?Rr++:(Rr=0,Eo=e):Rr=0,tn(),null}function qn(){if(Bt!==null){var e=dd(bi),t=Ye.transition,n=te;try{if(Ye.transition=null,te=16>e?16:e,Bt===null)var r=!1;else{if(e=Bt,Bt=null,bi=0,ee&6)throw Error(D(331));var s=ee;for(ee|=4,R=e.current;R!==null;){var i=R,o=i.child;if(R.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(R=u;R!==null;){var d=R;switch(d.tag){case 0:case 11:case 15:Ar(8,d,i)}var h=d.child;if(h!==null)h.return=d,R=h;else for(;R!==null;){d=R;var p=d.sibling,v=d.return;if(bh(d),d===u){R=null;break}if(p!==null){p.return=v,R=p;break}R=v}}}var y=i.alternate;if(y!==null){var x=y.child;if(x!==null){y.child=null;do{var j=x.sibling;x.sibling=null,x=j}while(x!==null)}}R=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,R=o;else e:for(;R!==null;){if(i=R,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Ar(9,i,i.return)}var g=i.sibling;if(g!==null){g.return=i.return,R=g;break e}R=i.return}}var f=e.current;for(R=f;R!==null;){o=R;var m=o.child;if(o.subtreeFlags&2064&&m!==null)m.return=o,R=m;else e:for(o=f;R!==null;){if(l=R,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Ui(9,l)}}catch(C){ue(l,l.return,C)}if(l===o){R=null;break e}var w=l.sibling;if(w!==null){w.return=l.return,R=w;break e}R=l.return}}if(ee=s,tn(),mt&&typeof mt.onPostCommitFiberRoot=="function")try{mt.onPostCommitFiberRoot($i,e)}catch{}r=!0}return r}finally{te=n,Ye.transition=t}}return!1}function Kc(e,t,n){t=tr(n,t),t=dh(e,t,1),e=Gt(e,t,1),t=ze(),e!==null&&(hs(e,1,t),Fe(e,t))}function ue(e,t,n){if(e.tag===3)Kc(e,e,n);else for(;t!==null;){if(t.tag===3){Kc(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Jt===null||!Jt.has(r))){e=tr(n,e),e=hh(t,e,1),t=Gt(t,e,1),e=ze(),t!==null&&(hs(t,1,e),Fe(t,e));break}}t=t.return}}function Mp(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=ze(),e.pingedLanes|=e.suspendedLanes&n,ve===e&&(ye&n)===n&&(me===4||me===3&&(ye&130023424)===ye&&500>de()-Tl?fn(e,0):El|=n),Fe(e,t)}function $h(e,t){t===0&&(e.mode&1?(t=Ns,Ns<<=1,!(Ns&130023424)&&(Ns=4194304)):t=1);var n=ze();e=Tt(e,t),e!==null&&(hs(e,t,n),Fe(e,n))}function Up(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),$h(e,n)}function Fp(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(D(314))}r!==null&&r.delete(t),$h(e,n)}var Ih;Ih=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Me.current)Re=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Re=!1,Cp(e,t,n);Re=!!(e.flags&131072)}else Re=!1,ae&&t.flags&1048576&&Od(t,fi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Js(e,t),e=t.pendingProps;var s=Yn(t,Pe.current);Jn(t,n),s=jl(null,t,r,e,s,n);var i=kl();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ue(r)?(i=!0,di(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,xl(t),s.updater=Mi,t.stateNode=s,s._reactInternals=t,vo(t,r,e,n),t=wo(null,t,r,!0,i,n)):(t.tag=0,ae&&i&&dl(t),Ee(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Js(e,t),e=t.pendingProps,s=r._init,r=s(r._payload),t.type=r,s=t.tag=Hp(r),e=rt(r,e),s){case 0:t=yo(null,t,r,e,n);break e;case 1:t=Bc(null,t,r,e,n);break e;case 11:t=Uc(null,t,r,e,n);break e;case 14:t=Fc(null,t,r,rt(r.type,e),n);break e}throw Error(D(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:rt(r,s),yo(e,t,r,s,n);case 1:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:rt(r,s),Bc(e,t,r,s,n);case 3:e:{if(gh(t),e===null)throw Error(D(387));r=t.pendingProps,i=t.memoizedState,s=i.element,Hd(e,t),gi(t,r,null,n);var o=t.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=tr(Error(D(423)),t),t=Hc(e,t,r,n,s);break e}else if(r!==s){s=tr(Error(D(424)),t),t=Hc(e,t,r,n,s);break e}else for(He=Vt(t.stateNode.containerInfo.firstChild),We=t,ae=!0,at=null,n=Fd(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Kn(),r===s){t=zt(e,t,n);break e}Ee(e,t,r,n)}t=t.child}return t;case 5:return Wd(t),e===null&&mo(t),r=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,o=s.children,lo(r,s)?o=null:i!==null&&lo(r,i)&&(t.flags|=32),ph(e,t),Ee(e,t,o,n),t.child;case 6:return e===null&&mo(t),null;case 13:return vh(e,t,n);case 4:return yl(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Xn(t,null,r,n):Ee(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:rt(r,s),Uc(e,t,r,s,n);case 7:return Ee(e,t,t.pendingProps,n),t.child;case 8:return Ee(e,t,t.pendingProps.children,n),t.child;case 12:return Ee(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,i=t.memoizedProps,o=s.value,re(mi,r._currentValue),r._currentValue=o,i!==null)if(ct(i.value,o)){if(i.children===s.children&&!Me.current){t=zt(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=Pt(-1,n&-n),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),po(i.return,n,t),l.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(D(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),po(o,n,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Ee(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,Jn(t,n),s=Xe(s),r=r(s),t.flags|=1,Ee(e,t,r,n),t.child;case 14:return r=t.type,s=rt(r,t.pendingProps),s=rt(r.type,s),Fc(e,t,r,s,n);case 15:return fh(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:rt(r,s),Js(e,t),t.tag=1,Ue(r)?(e=!0,di(t)):e=!1,Jn(t,n),uh(t,r,s),vo(t,r,s,n),wo(null,t,r,!0,e,n);case 19:return xh(e,t,n);case 22:return mh(e,t,n)}throw Error(D(156,t.tag))};function Lh(e,t){return od(e,t)}function Bp(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qe(e,t,n,r){return new Bp(e,t,n,r)}function Ll(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Hp(e){if(typeof e=="function")return Ll(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Xo)return 11;if(e===el)return 14}return 2}function Qt(e,t){var n=e.alternate;return n===null?(n=Qe(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Ys(e,t,n,r,s,i){var o=2;if(r=e,typeof e=="function")Ll(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case In:return mn(n.children,s,i,t);case Ko:o=8,s|=8;break;case Ua:return e=Qe(12,n,t,s|2),e.elementType=Ua,e.lanes=i,e;case Fa:return e=Qe(13,n,t,s),e.elementType=Fa,e.lanes=i,e;case Ba:return e=Qe(19,n,t,s),e.elementType=Ba,e.lanes=i,e;case Wu:return Bi(n,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Bu:o=10;break e;case Hu:o=9;break e;case Xo:o=11;break e;case el:o=14;break e;case At:o=16,r=null;break e}throw Error(D(130,e==null?e:typeof e,""))}return t=Qe(o,n,t,s),t.elementType=e,t.type=r,t.lanes=i,t}function mn(e,t,n,r){return e=Qe(7,e,r,t),e.lanes=n,e}function Bi(e,t,n,r){return e=Qe(22,e,r,t),e.elementType=Wu,e.lanes=n,e.stateNode={isHidden:!1},e}function ka(e,t,n){return e=Qe(6,e,null,t),e.lanes=n,e}function Na(e,t,n){return t=Qe(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Wp(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ia(0),this.expirationTimes=ia(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ia(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Dl(e,t,n,r,s,i,o,l,c){return e=new Wp(e,t,n,l,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Qe(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},xl(i),e}function Zp(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:$n,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function Dh(e){if(!e)return Kt;e=e._reactInternals;e:{if(_n(e)!==e||e.tag!==1)throw Error(D(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ue(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(D(171))}if(e.tag===1){var n=e.type;if(Ue(n))return Dd(e,n,t)}return t}function Ah(e,t,n,r,s,i,o,l,c){return e=Dl(n,r,!0,e,s,i,o,l,c),e.context=Dh(null),n=e.current,r=ze(),s=qt(n),i=Pt(r,s),i.callback=t??null,Gt(n,i,s),e.current.lanes=s,hs(e,s,r),Fe(e,r),e}function Hi(e,t,n,r){var s=t.current,i=ze(),o=qt(s);return n=Dh(n),t.context===null?t.context=n:t.pendingContext=n,t=Pt(i,o),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Gt(s,t,o),e!==null&&(lt(e,s,o,i),Zs(e,s,o)),o}function ki(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Xc(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Al(e,t){Xc(e,t),(e=e.alternate)&&Xc(e,t)}function Vp(){return null}var Oh=typeof reportError=="function"?reportError:function(e){console.error(e)};function Ol(e){this._internalRoot=e}Wi.prototype.render=Ol.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(D(409));Hi(e,t,null,null)};Wi.prototype.unmount=Ol.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;yn(function(){Hi(null,e,null,null)}),t[Et]=null}};function Wi(e){this._internalRoot=e}Wi.prototype.unstable_scheduleHydration=function(e){if(e){var t=md();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Rt.length&&t!==0&&t<Rt[n].priority;n++);Rt.splice(n,0,e),n===0&&gd(e)}};function Rl(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Zi(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function eu(){}function Gp(e,t,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var u=ki(o);i.call(u)}}var o=Ah(t,r,e,0,null,!1,!1,"",eu);return e._reactRootContainer=o,e[Et]=o.current,qr(e.nodeType===8?e.parentNode:e),yn(),o}for(;s=e.lastChild;)e.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var u=ki(c);l.call(u)}}var c=Dl(e,0,!1,null,null,!1,!1,"",eu);return e._reactRootContainer=c,e[Et]=c.current,qr(e.nodeType===8?e.parentNode:e),yn(function(){Hi(t,c,n,r)}),c}function Vi(e,t,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var c=ki(o);l.call(c)}}Hi(t,o,e,s)}else o=Gp(n,t,e,s,r);return ki(o)}hd=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Sr(t.pendingLanes);n!==0&&(rl(t,n|1),Fe(t,de()),!(ee&6)&&(nr=de()+500,tn()))}break;case 13:yn(function(){var r=Tt(e,1);if(r!==null){var s=ze();lt(r,e,1,s)}}),Al(e,1)}};sl=function(e){if(e.tag===13){var t=Tt(e,134217728);if(t!==null){var n=ze();lt(t,e,134217728,n)}Al(e,134217728)}};fd=function(e){if(e.tag===13){var t=qt(e),n=Tt(e,t);if(n!==null){var r=ze();lt(n,e,t,r)}Al(e,t)}};md=function(){return te};pd=function(e,t){var n=te;try{return te=e,t()}finally{te=n}};Ka=function(e,t,n){switch(t){case"input":if(Za(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=Ai(r);if(!s)throw Error(D(90));Vu(r),Za(r,s)}}}break;case"textarea":Ju(e,n);break;case"select":t=n.value,t!=null&&Wn(e,!!n.multiple,t,!1)}};td=zl;nd=yn;var Jp={usingClientEntryPoint:!1,Events:[ms,On,Ai,Xu,ed,zl]},wr={findFiberByHostInstance:un,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},qp={bundleType:wr.bundleType,version:wr.version,rendererPackageName:wr.rendererPackageName,rendererConfig:wr.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:$t.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=id(e),e===null?null:e.stateNode},findFiberByHostInstance:wr.findFiberByHostInstance||Vp,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var As=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!As.isDisabled&&As.supportsFiber)try{$i=As.inject(qp),mt=As}catch{}}Ve.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Jp;Ve.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Rl(t))throw Error(D(200));return Zp(e,t,null,n)};Ve.createRoot=function(e,t){if(!Rl(e))throw Error(D(299));var n=!1,r="",s=Oh;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Dl(e,1,!1,null,null,n,!1,r,s),e[Et]=t.current,qr(e.nodeType===8?e.parentNode:e),new Ol(t)};Ve.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(D(188)):(e=Object.keys(e).join(","),Error(D(268,e)));return e=id(t),e=e===null?null:e.stateNode,e};Ve.flushSync=function(e){return yn(e)};Ve.hydrate=function(e,t,n){if(!Zi(t))throw Error(D(200));return Vi(null,e,t,!0,n)};Ve.hydrateRoot=function(e,t,n){if(!Rl(e))throw Error(D(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=Oh;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=Ah(t,null,e,1,n??null,s,!1,i,o),e[Et]=t.current,qr(e),r)for(e=0;e<r.length;e++)n=r[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new Wi(t)};Ve.render=function(e,t,n){if(!Zi(t))throw Error(D(200));return Vi(null,e,t,!1,n)};Ve.unmountComponentAtNode=function(e){if(!Zi(e))throw Error(D(40));return e._reactRootContainer?(yn(function(){Vi(null,null,e,!1,function(){e._reactRootContainer=null,e[Et]=null})}),!0):!1};Ve.unstable_batchedUpdates=zl;Ve.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Zi(n))throw Error(D(200));if(e==null||e._reactInternals===void 0)throw Error(D(38));return Vi(e,t,n,!1,r)};Ve.version="18.3.1-next-f1338f8080-20240426";function Rh(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Rh)}catch(e){console.error(e)}}Rh(),Ru.exports=Ve;var Qp=Ru.exports,tu=Qp;Ra.createRoot=tu.createRoot,Ra.hydrateRoot=tu.hydrateRoot;const Yp="modulepreload",Kp=function(e){return"/"+e},nu={},gs=function(t,n,r){if(!n||n.length===0)return t();const s=document.getElementsByTagName("link");return Promise.all(n.map(i=>{if(i=Kp(i),i in nu)return;nu[i]=!0;const o=i.endsWith(".css"),l=o?'[rel="stylesheet"]':"";if(!!r)for(let d=s.length-1;d>=0;d--){const h=s[d];if(h.href===i&&(!o||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${l}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":Yp,o||(u.as="script",u.crossOrigin=""),u.href=i,document.head.appendChild(u),o)return new Promise((d,h)=>{u.addEventListener("load",d),u.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>t()).catch(i=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i})},Xp=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...n)=>gs(()=>Promise.resolve().then(()=>cr),void 0).then(({default:r})=>r(...n)):t=fetch,(...n)=>t(...n)};class Ml extends Error{constructor(t,n="FunctionsError",r){super(t),this.name=n,this.context=r}}class eg extends Ml{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class ru extends Ml{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class su extends Ml{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var $o;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})($o||($o={}));var tg=globalThis&&globalThis.__awaiter||function(e,t,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((r=r.apply(e,t||[])).next())})};class ng{constructor(t,{headers:n={},customFetch:r,region:s=$o.Any}={}){this.url=t,this.headers=n,this.region=s,this.fetch=Xp(r)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,n={}){var r;return tg(this,void 0,void 0,function*(){try{const{headers:s,method:i,body:o}=n;let l={},{region:c}=n;c||(c=this.region);const u=new URL(`${this.url}/${t}`);c&&c!=="any"&&(l["x-region"]=c,u.searchParams.set("forceFunctionRegion",c));let d;o&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",d=o):typeof o=="string"?(l["Content-Type"]="text/plain",d=o):typeof FormData<"u"&&o instanceof FormData?d=o:(l["Content-Type"]="application/json",d=JSON.stringify(o)));const h=yield this.fetch(u.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),s),body:d}).catch(x=>{throw new eg(x)}),p=h.headers.get("x-relay-error");if(p&&p==="true")throw new ru(h);if(!h.ok)throw new su(h);let v=((r=h.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),y;return v==="application/json"?y=yield h.json():v==="application/octet-stream"?y=yield h.blob():v==="text/event-stream"?y=h:v==="multipart/form-data"?y=yield h.formData():y=yield h.text(),{data:y,error:null,response:h}}catch(s){return{data:null,error:s,response:s instanceof su||s instanceof ru?s.context:void 0}}})}}var Oe={},Ul={},Gi={},vs={},Ji={},qi={},rg=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},rr=rg();const sg=rr.fetch,Mh=rr.fetch.bind(rr),Uh=rr.Headers,ig=rr.Request,ag=rr.Response,cr=Object.freeze(Object.defineProperty({__proto__:null,Headers:Uh,Request:ig,Response:ag,default:Mh,fetch:sg},Symbol.toStringTag,{value:"Module"})),og=jf(cr);var Qi={};Object.defineProperty(Qi,"__esModule",{value:!0});let lg=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};Qi.default=lg;var Fh=Ke&&Ke.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(qi,"__esModule",{value:!0});const cg=Fh(og),ug=Fh(Qi);let dg=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=cg.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,n){return this.headers=Object.assign({},this.headers),this.headers[t]=n,this}then(t,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const r=this.fetch;let s=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var o,l,c;let u=null,d=null,h=null,p=i.status,v=i.statusText;if(i.ok){if(this.method!=="HEAD"){const g=await i.text();g===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?d=g:d=JSON.parse(g))}const x=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),j=(l=i.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");x&&j&&j.length>1&&(h=parseInt(j[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(d)&&(d.length>1?(u={code:"PGRST116",details:`Results contain ${d.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},d=null,h=null,p=406,v="Not Acceptable"):d.length===1?d=d[0]:d=null)}else{const x=await i.text();try{u=JSON.parse(x),Array.isArray(u)&&i.status===404&&(d=[],u=null,p=200,v="OK")}catch{i.status===404&&x===""?(p=204,v="No Content"):u={message:x}}if(u&&this.isMaybeSingle&&(!((c=u==null?void 0:u.details)===null||c===void 0)&&c.includes("0 rows"))&&(u=null,p=200,v="OK"),u&&this.shouldThrowOnError)throw new ug.default(u)}return{error:u,data:d,count:h,status:p,statusText:v}});return this.shouldThrowOnError||(s=s.catch(i=>{var o,l,c;return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(l=i==null?void 0:i.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(c=i==null?void 0:i.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),s.then(t,n)}returns(){return this}overrideTypes(){return this}};qi.default=dg;var hg=Ke&&Ke.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ji,"__esModule",{value:!0});const fg=hg(qi);let mg=class extends fg.default{select(t){let n=!1;const r=(t??"*").split("").map(s=>/\s/.test(s)&&!n?"":(s==='"'&&(n=!n),s)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:n=!0,nullsFirst:r,foreignTable:s,referencedTable:i=s}={}){const o=i?`${i}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${t}.${n?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:n,referencedTable:r=n}={}){const s=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${t}`),this}range(t,n,{foreignTable:r,referencedTable:s=r}={}){const i=typeof s>"u"?"offset":`${s}.offset`,o=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(i,`${t}`),this.url.searchParams.set(o,`${n-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:n=!1,settings:r=!1,buffers:s=!1,wal:i=!1,format:o="text"}={}){var l;const c=[t?"analyze":null,n?"verbose":null,r?"settings":null,s?"buffers":null,i?"wal":null].filter(Boolean).join("|"),u=(l=this.headers.Accept)!==null&&l!==void 0?l:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${u}"; options=${c};`,o==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Ji.default=mg;var pg=Ke&&Ke.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(vs,"__esModule",{value:!0});const gg=pg(Ji);let vg=class extends gg.default{eq(t,n){return this.url.searchParams.append(t,`eq.${n}`),this}neq(t,n){return this.url.searchParams.append(t,`neq.${n}`),this}gt(t,n){return this.url.searchParams.append(t,`gt.${n}`),this}gte(t,n){return this.url.searchParams.append(t,`gte.${n}`),this}lt(t,n){return this.url.searchParams.append(t,`lt.${n}`),this}lte(t,n){return this.url.searchParams.append(t,`lte.${n}`),this}like(t,n){return this.url.searchParams.append(t,`like.${n}`),this}likeAllOf(t,n){return this.url.searchParams.append(t,`like(all).{${n.join(",")}}`),this}likeAnyOf(t,n){return this.url.searchParams.append(t,`like(any).{${n.join(",")}}`),this}ilike(t,n){return this.url.searchParams.append(t,`ilike.${n}`),this}ilikeAllOf(t,n){return this.url.searchParams.append(t,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(t,n){return this.url.searchParams.append(t,`ilike(any).{${n.join(",")}}`),this}is(t,n){return this.url.searchParams.append(t,`is.${n}`),this}in(t,n){const r=Array.from(new Set(n)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`in.(${r})`),this}contains(t,n){return typeof n=="string"?this.url.searchParams.append(t,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(t,`cs.{${n.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(n)}`),this}containedBy(t,n){return typeof n=="string"?this.url.searchParams.append(t,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(t,`cd.{${n.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(n)}`),this}rangeGt(t,n){return this.url.searchParams.append(t,`sr.${n}`),this}rangeGte(t,n){return this.url.searchParams.append(t,`nxl.${n}`),this}rangeLt(t,n){return this.url.searchParams.append(t,`sl.${n}`),this}rangeLte(t,n){return this.url.searchParams.append(t,`nxr.${n}`),this}rangeAdjacent(t,n){return this.url.searchParams.append(t,`adj.${n}`),this}overlaps(t,n){return typeof n=="string"?this.url.searchParams.append(t,`ov.${n}`):this.url.searchParams.append(t,`ov.{${n.join(",")}}`),this}textSearch(t,n,{config:r,type:s}={}){let i="";s==="plain"?i="pl":s==="phrase"?i="ph":s==="websearch"&&(i="w");const o=r===void 0?"":`(${r})`;return this.url.searchParams.append(t,`${i}fts${o}.${n}`),this}match(t){return Object.entries(t).forEach(([n,r])=>{this.url.searchParams.append(n,`eq.${r}`)}),this}not(t,n,r){return this.url.searchParams.append(t,`not.${n}.${r}`),this}or(t,{foreignTable:n,referencedTable:r=n}={}){const s=r?`${r}.or`:"or";return this.url.searchParams.append(s,`(${t})`),this}filter(t,n,r){return this.url.searchParams.append(t,`${n}.${r}`),this}};vs.default=vg;var xg=Ke&&Ke.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Gi,"__esModule",{value:!0});const _r=xg(vs);let yg=class{constructor(t,{headers:n={},schema:r,fetch:s}){this.url=t,this.headers=n,this.schema=r,this.fetch=s}select(t,{head:n=!1,count:r}={}){const s=n?"HEAD":"GET";let i=!1;const o=(t??"*").split("").map(l=>/\s/.test(l)&&!i?"":(l==='"'&&(i=!i),l)).join("");return this.url.searchParams.set("select",o),r&&(this.headers.Prefer=`count=${r}`),new _r.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:n,defaultToNull:r=!0}={}){const s="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),n&&i.push(`count=${n}`),r||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(t)){const o=t.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(o.length>0){const l=[...new Set(o)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new _r.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:n,ignoreDuplicates:r=!1,count:s,defaultToNull:i=!0}={}){const o="POST",l=[`resolution=${r?"ignore":"merge"}-duplicates`];if(n!==void 0&&this.url.searchParams.set("on_conflict",n),this.headers.Prefer&&l.push(this.headers.Prefer),s&&l.push(`count=${s}`),i||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(t)){const c=t.reduce((u,d)=>u.concat(Object.keys(d)),[]);if(c.length>0){const u=[...new Set(c)].map(d=>`"${d}"`);this.url.searchParams.set("columns",u.join(","))}}return new _r.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:n}={}){const r="PATCH",s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),n&&s.push(`count=${n}`),this.headers.Prefer=s.join(","),new _r.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const n="DELETE",r=[];return t&&r.push(`count=${t}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new _r.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};Gi.default=yg;var Yi={},Ki={};Object.defineProperty(Ki,"__esModule",{value:!0});Ki.version=void 0;Ki.version="0.0.0-automated";Object.defineProperty(Yi,"__esModule",{value:!0});Yi.DEFAULT_HEADERS=void 0;const wg=Ki;Yi.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${wg.version}`};var Bh=Ke&&Ke.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ul,"__esModule",{value:!0});const _g=Bh(Gi),bg=Bh(vs),jg=Yi;let kg=class Hh{constructor(t,{headers:n={},schema:r,fetch:s}={}){this.url=t,this.headers=Object.assign(Object.assign({},jg.DEFAULT_HEADERS),n),this.schemaName=r,this.fetch=s}from(t){const n=new URL(`${this.url}/${t}`);return new _g.default(n,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new Hh(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,n={},{head:r=!1,get:s=!1,count:i}={}){let o;const l=new URL(`${this.url}/rpc/${t}`);let c;r||s?(o=r?"HEAD":"GET",Object.entries(n).filter(([d,h])=>h!==void 0).map(([d,h])=>[d,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([d,h])=>{l.searchParams.append(d,h)})):(o="POST",c=n);const u=Object.assign({},this.headers);return i&&(u.Prefer=`count=${i}`),new bg.default({method:o,url:l,headers:u,schema:this.schemaName,body:c,fetch:this.fetch,allowEmpty:!1})}};Ul.default=kg;var ur=Ke&&Ke.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Oe,"__esModule",{value:!0});Oe.PostgrestError=Oe.PostgrestBuilder=Oe.PostgrestTransformBuilder=Oe.PostgrestFilterBuilder=Oe.PostgrestQueryBuilder=Oe.PostgrestClient=void 0;const Wh=ur(Ul);Oe.PostgrestClient=Wh.default;const Zh=ur(Gi);Oe.PostgrestQueryBuilder=Zh.default;const Vh=ur(vs);Oe.PostgrestFilterBuilder=Vh.default;const Gh=ur(Ji);Oe.PostgrestTransformBuilder=Gh.default;const Jh=ur(qi);Oe.PostgrestBuilder=Jh.default;const qh=ur(Qi);Oe.PostgrestError=qh.default;var Ng=Oe.default={PostgrestClient:Wh.default,PostgrestQueryBuilder:Zh.default,PostgrestFilterBuilder:Vh.default,PostgrestTransformBuilder:Gh.default,PostgrestBuilder:Jh.default,PostgrestError:qh.default};const{PostgrestClient:Sg,PostgrestQueryBuilder:ty,PostgrestFilterBuilder:ny,PostgrestTransformBuilder:ry,PostgrestBuilder:sy,PostgrestError:iy}=Ng;function Pg(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const Cg=Pg(),Eg="2.11.15",Tg=`realtime-js/${Eg}`,zg="1.0.0",Qh=1e4,$g=1e3;var Mr;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Mr||(Mr={}));var ke;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(ke||(ke={}));var it;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(it||(it={}));var Io;(function(e){e.websocket="websocket"})(Io||(Io={}));var cn;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(cn||(cn={}));class Ig{constructor(){this.HEADER_LENGTH=1}decode(t,n){return t.constructor===ArrayBuffer?n(this._binaryDecode(t)):n(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const n=new DataView(t),r=new TextDecoder;return this._decodeBroadcast(t,n,r)}_decodeBroadcast(t,n,r){const s=n.getUint8(1),i=n.getUint8(2);let o=this.HEADER_LENGTH+2;const l=r.decode(t.slice(o,o+s));o=o+s;const c=r.decode(t.slice(o,o+i));o=o+i;const u=JSON.parse(r.decode(t.slice(o,t.byteLength)));return{ref:null,topic:l,event:c,payload:u}}}class Yh{constructor(t,n){this.callback=t,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var ne;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(ne||(ne={}));const iu=(e,t,n={})=>{var r;const s=(r=n.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(t).reduce((i,o)=>(i[o]=Lg(o,e,t,s),i),{})},Lg=(e,t,n,r)=>{const s=t.find(l=>l.name===e),i=s==null?void 0:s.type,o=n[e];return i&&!r.includes(i)?Kh(i,o):Lo(o)},Kh=(e,t)=>{if(e.charAt(0)==="_"){const n=e.slice(1,e.length);return Rg(t,n)}switch(e){case ne.bool:return Dg(t);case ne.float4:case ne.float8:case ne.int2:case ne.int4:case ne.int8:case ne.numeric:case ne.oid:return Ag(t);case ne.json:case ne.jsonb:return Og(t);case ne.timestamp:return Mg(t);case ne.abstime:case ne.date:case ne.daterange:case ne.int4range:case ne.int8range:case ne.money:case ne.reltime:case ne.text:case ne.time:case ne.timestamptz:case ne.timetz:case ne.tsrange:case ne.tstzrange:return Lo(t);default:return Lo(t)}},Lo=e=>e,Dg=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},Ag=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},Og=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},Rg=(e,t)=>{if(typeof e!="string")return e;const n=e.length-1,r=e[n];if(e[0]==="{"&&r==="}"){let i;const o=e.slice(1,n);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(l=>Kh(t,l))}return e},Mg=e=>typeof e=="string"?e.replace(" ","T"):e,Xh=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class Sa{constructor(t,n,r={},s=Qh){this.channel=t,this.event=n,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,n){var r;return this._hasReceived(t)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:t,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:n}){this.recHooks.filter(r=>r.status===t).forEach(r=>r.callback(n))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var au;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(au||(au={}));class Ur{constructor(t,n){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},s=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ur.syncState(this.state,s,i,o),this.pendingDiffs.forEach(c=>{this.state=Ur.syncDiff(this.state,c,i,o)}),this.pendingDiffs=[],l()}),this.channel._on(r.diff,{},s=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Ur.syncDiff(this.state,s,i,o),l())}),this.onJoin((s,i,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:o})}),this.onLeave((s,i,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,n,r,s){const i=this.cloneDeep(t),o=this.transformState(n),l={},c={};return this.map(i,(u,d)=>{o[u]||(c[u]=d)}),this.map(o,(u,d)=>{const h=i[u];if(h){const p=d.map(j=>j.presence_ref),v=h.map(j=>j.presence_ref),y=d.filter(j=>v.indexOf(j.presence_ref)<0),x=h.filter(j=>p.indexOf(j.presence_ref)<0);y.length>0&&(l[u]=y),x.length>0&&(c[u]=x)}else l[u]=d}),this.syncDiff(i,{joins:l,leaves:c},r,s)}static syncDiff(t,n,r,s){const{joins:i,leaves:o}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(i,(l,c)=>{var u;const d=(u=t[l])!==null&&u!==void 0?u:[];if(t[l]=this.cloneDeep(c),d.length>0){const h=t[l].map(v=>v.presence_ref),p=d.filter(v=>h.indexOf(v.presence_ref)<0);t[l].unshift(...p)}r(l,d,c)}),this.map(o,(l,c)=>{let u=t[l];if(!u)return;const d=c.map(h=>h.presence_ref);u=u.filter(h=>d.indexOf(h.presence_ref)<0),t[l]=u,s(l,u,c),u.length===0&&delete t[l]}),t}static map(t,n){return Object.getOwnPropertyNames(t).map(r=>n(r,t[r]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((n,r)=>{const s=t[r];return"metas"in s?n[r]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):n[r]=s,n},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var ou;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(ou||(ou={}));var lu;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(lu||(lu={}));var _t;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(_t||(_t={}));class Fl{constructor(t,n={config:{}},r){this.topic=t,this.params=n,this.socket=r,this.bindings={},this.state=ke.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new Sa(this,it.join,this.params,this.timeout),this.rejoinTimer=new Yh(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ke.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ke.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=ke.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ke.errored,this.rejoinTimer.scheduleTimeout())}),this._on(it.reply,{},(s,i)=>{this._trigger(this._replyEventName(i),s)}),this.presence=new Ur(this),this.broadcastEndpointURL=Xh(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,n=this.timeout){var r,s;if(this.socket.isConnected()||this.socket.connect(),this.state==ke.closed){const{config:{broadcast:i,presence:o,private:l}}=this.params;this._onError(d=>t==null?void 0:t(_t.CHANNEL_ERROR,d)),this._onClose(()=>t==null?void 0:t(_t.CLOSED));const c={},u={broadcast:i,presence:o,postgres_changes:(s=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(d=>d.filter))!==null&&s!==void 0?s:[],private:l};this.socket.accessTokenValue&&(c.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:u},c)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:d})=>{var h;if(this.socket.setAuth(),d===void 0){t==null||t(_t.SUBSCRIBED);return}else{const p=this.bindings.postgres_changes,v=(h=p==null?void 0:p.length)!==null&&h!==void 0?h:0,y=[];for(let x=0;x<v;x++){const j=p[x],{filter:{event:g,schema:f,table:m,filter:w}}=j,C=d&&d[x];if(C&&C.event===g&&C.schema===f&&C.table===m&&C.filter===w)y.push(Object.assign(Object.assign({},j),{id:C.id}));else{this.unsubscribe(),this.state=ke.errored,t==null||t(_t.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,t&&t(_t.SUBSCRIBED);return}}).receive("error",d=>{this.state=ke.errored,t==null||t(_t.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(d).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(_t.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,n={}){return await this.send({type:"presence",event:"track",payload:t},n.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,n,r){return this._on(t,n,r)}async send(t,n={}){var r,s;if(!this._canPush()&&t.type==="broadcast"){const{event:i,payload:o}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((s=u.body)===null||s===void 0?void 0:s.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,l,c;const u=this._push(t.type,t,n.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("error",()=>i("error")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=ke.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(it.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(s=>{r=new Sa(this,it.leave,{},t),r.receive("ok",()=>{n(),s("ok")}).receive("timeout",()=>{n(),s("timed out")}).receive("error",()=>{s("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(t,n,r){const s=new AbortController,i=setTimeout(()=>s.abort(),r),o=await this.socket.fetch(t,Object.assign(Object.assign({},n),{signal:s.signal}));return clearTimeout(i),o}_push(t,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Sa(this,t,n,r);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(t,n,r){return n}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,n,r){var s,i;const o=t.toLocaleLowerCase(),{close:l,error:c,leave:u,join:d}=it;if(r&&[l,c,u,d].indexOf(o)>=0&&r!==this._joinRef())return;let p=this._onMessage(o,n,r);if(n&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(v=>{var y,x,j;return((y=v.filter)===null||y===void 0?void 0:y.event)==="*"||((j=(x=v.filter)===null||x===void 0?void 0:x.event)===null||j===void 0?void 0:j.toLocaleLowerCase())===o}).map(v=>v.callback(p,r)):(i=this.bindings[o])===null||i===void 0||i.filter(v=>{var y,x,j,g,f,m;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in v){const w=v.id,C=(y=v.filter)===null||y===void 0?void 0:y.event;return w&&((x=n.ids)===null||x===void 0?void 0:x.includes(w))&&(C==="*"||(C==null?void 0:C.toLocaleLowerCase())===((j=n.data)===null||j===void 0?void 0:j.type.toLocaleLowerCase()))}else{const w=(f=(g=v==null?void 0:v.filter)===null||g===void 0?void 0:g.event)===null||f===void 0?void 0:f.toLocaleLowerCase();return w==="*"||w===((m=n==null?void 0:n.event)===null||m===void 0?void 0:m.toLocaleLowerCase())}else return v.type.toLocaleLowerCase()===o}).map(v=>{if(typeof p=="object"&&"ids"in p){const y=p.data,{schema:x,table:j,commit_timestamp:g,type:f,errors:m}=y;p=Object.assign(Object.assign({},{schema:x,table:j,commit_timestamp:g,eventType:f,new:{},old:{},errors:m}),this._getPayloadRecords(y))}v.callback(p,r)})}_isClosed(){return this.state===ke.closed}_isJoined(){return this.state===ke.joined}_isJoining(){return this.state===ke.joining}_isLeaving(){return this.state===ke.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,n,r){const s=t.toLocaleLowerCase(),i={type:s,filter:n,callback:r};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(t,n){const r=t.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&Fl.isEqual(s.filter,n))}),this}static isEqual(t,n){if(Object.keys(t).length!==Object.keys(n).length)return!1;for(const r in t)if(t[r]!==n[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(it.close,{},t)}_onError(t){this._on(it.error,{},n=>t(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ke.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const n={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(n.new=iu(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(n.old=iu(t.columns,t.old_record)),n}}const cu=()=>{},Ug=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Fg{constructor(t,n){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Qh,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=cu,this.ref=0,this.logger=cu,this.conn=null,this.sendBuffer=[],this.serializer=new Ig,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let o;return i?o=i:typeof fetch>"u"?o=(...l)=>gs(()=>Promise.resolve().then(()=>cr),void 0).then(({default:c})=>c(...l)):o=fetch,(...l)=>o(...l)},this.endPoint=`${t}/${Io.websocket}`,this.httpEndpoint=Xh(t),n!=null&&n.transport?this.transport=n.transport:this.transport=null,n!=null&&n.params&&(this.params=n.params),n!=null&&n.timeout&&(this.timeout=n.timeout),n!=null&&n.logger&&(this.logger=n.logger),(n!=null&&n.logLevel||n!=null&&n.log_level)&&(this.logLevel=n.logLevel||n.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),n!=null&&n.heartbeatIntervalMs&&(this.heartbeatIntervalMs=n.heartbeatIntervalMs);const s=(r=n==null?void 0:n.params)===null||r===void 0?void 0:r.apikey;if(s&&(this.accessTokenValue=s,this.apiKey=s),this.reconnectAfterMs=n!=null&&n.reconnectAfterMs?n.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=n!=null&&n.encode?n.encode:(i,o)=>o(JSON.stringify(i)),this.decode=n!=null&&n.decode?n.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Yh(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(n==null?void 0:n.fetch),n!=null&&n.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(n==null?void 0:n.worker)||!1,this.workerUrl=n==null?void 0:n.workerUrl}this.accessToken=(n==null?void 0:n.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=Cg),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:zg}))}disconnect(t,n){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,n??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(r=>r.teardown()))}getChannels(){return this.channels}async removeChannel(t){const n=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const t=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,n,r){this.logger(t,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Mr.connecting:return cn.Connecting;case Mr.open:return cn.Open;case Mr.closing:return cn.Closing;default:return cn.Closed}}isConnected(){return this.connectionState()===cn.Open}channel(t,n={config:{}}){const r=`realtime:${t}`,s=this.getChannels().find(i=>i.topic===r);if(s)return s;{const i=new Fl(`realtime:${t}`,n,this);return this.channels.push(i),i}}push(t){const{topic:n,event:r,payload:s,ref:i}=t,o=()=>{this.encode(t,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${n} ${r} (${i})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(t=null){let n=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(r=>{const s={access_token:n,version:Tg};n&&r.updateJoinPayload(s),r.joinedOnce&&r._isJoined()&&r._push(it.access_token,{access_token:n})}))}async sendHeartbeat(){var t;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(t=this.conn)===null||t===void 0||t.close($g,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let n=this.channels.find(r=>r.topic===t&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${t}"`),n.unsubscribe())}_remove(t){this.channels=this.channels.filter(n=>n.topic!==t.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,n=>{let{topic:r,event:s,payload:i,ref:o}=n;r==="phoenix"&&s==="phx_reply"&&this.heartbeatCallback(n.payload.status=="ok"?"ok":"error"),o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${r} ${s} ${o&&"("+o+")"||""}`,i),Array.from(this.channels).filter(l=>l._isMember(r)).forEach(l=>l._trigger(s,i,o)),this.stateChangeCallbacks.message.forEach(l=>l(n))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(t=>t())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(n=>n(t))}_onConnError(t){this.log("transport",`${t}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(n=>n(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(it.error))}_appendParams(t,n){if(Object.keys(n).length===0)return t;const r=t.match(/\?/)?"&":"?",s=new URLSearchParams(n);return`${t}${r}${s}`}_workerObjectUrl(t){let n;if(t)n=t;else{const r=new Blob([Ug],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}}class Bl extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function pe(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class Bg extends Bl{constructor(t,n,r){super(t),this.name="StorageApiError",this.status=n,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Do extends Bl{constructor(t,n){super(t),this.name="StorageUnknownError",this.originalError=n}}var Hg=globalThis&&globalThis.__awaiter||function(e,t,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((r=r.apply(e,t||[])).next())})};const ef=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...n)=>gs(()=>Promise.resolve().then(()=>cr),void 0).then(({default:r})=>r(...n)):t=fetch,(...n)=>t(...n)},Wg=()=>Hg(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield gs(()=>Promise.resolve().then(()=>cr),void 0)).Response:Response}),Ao=e=>{if(Array.isArray(e))return e.map(n=>Ao(n));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([n,r])=>{const s=n.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[s]=Ao(r)}),t},Zg=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var bn=globalThis&&globalThis.__awaiter||function(e,t,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((r=r.apply(e,t||[])).next())})};const Pa=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Vg=(e,t,n)=>bn(void 0,void 0,void 0,function*(){const r=yield Wg();e instanceof r&&!(n!=null&&n.noResolveJson)?e.json().then(s=>{const i=e.status||500,o=(s==null?void 0:s.statusCode)||i+"";t(new Bg(Pa(s),i,o))}).catch(s=>{t(new Do(Pa(s),s))}):t(new Do(Pa(e),e))}),Gg=(e,t,n,r)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!r?s:(Zg(r)?(s.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),s.body=JSON.stringify(r)):s.body=r,Object.assign(Object.assign({},s),n))};function xs(e,t,n,r,s,i){return bn(this,void 0,void 0,function*(){return new Promise((o,l)=>{e(n,Gg(t,r,s,i)).then(c=>{if(!c.ok)throw c;return r!=null&&r.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>Vg(c,l,r))})})}function Ni(e,t,n,r){return bn(this,void 0,void 0,function*(){return xs(e,"GET",t,n,r)})}function bt(e,t,n,r,s){return bn(this,void 0,void 0,function*(){return xs(e,"POST",t,r,s,n)})}function Oo(e,t,n,r,s){return bn(this,void 0,void 0,function*(){return xs(e,"PUT",t,r,s,n)})}function Jg(e,t,n,r){return bn(this,void 0,void 0,function*(){return xs(e,"HEAD",t,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)})}function tf(e,t,n,r,s){return bn(this,void 0,void 0,function*(){return xs(e,"DELETE",t,r,s,n)})}var De=globalThis&&globalThis.__awaiter||function(e,t,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((r=r.apply(e,t||[])).next())})};const qg={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},uu={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Qg{constructor(t,n={},r,s){this.url=t,this.headers=n,this.bucketId=r,this.fetch=ef(s)}uploadOrUpdate(t,n,r,s){return De(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},uu),s);let l=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c))):(i=r,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),s!=null&&s.headers&&(l=Object.assign(Object.assign({},l),s.headers));const u=this._removeEmptyFolders(n),d=this._getFinalPath(u),h=yield(t=="PUT"?Oo:bt)(this.fetch,`${this.url}/object/${d}`,i,Object.assign({headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:u,id:h.Id,fullPath:h.Key},error:null}}catch(i){if(pe(i))return{data:null,error:i};throw i}})}upload(t,n,r){return De(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,n,r)})}uploadToSignedUrl(t,n,r,s){return De(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(t),o=this._getFinalPath(i),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",n);try{let c;const u=Object.assign({upsert:uu.upsert},s),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&r instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",r)):typeof FormData<"u"&&r instanceof FormData?(c=r,c.append("cacheControl",u.cacheControl)):(c=r,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType);const h=yield Oo(this.fetch,l.toString(),c,{headers:d});return{data:{path:i,fullPath:h.Key},error:null}}catch(c){if(pe(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,n){return De(this,void 0,void 0,function*(){try{let r=this._getFinalPath(t);const s=Object.assign({},this.headers);n!=null&&n.upsert&&(s["x-upsert"]="true");const i=yield bt(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:s}),o=new URL(this.url+i.url),l=o.searchParams.get("token");if(!l)throw new Bl("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:l},error:null}}catch(r){if(pe(r))return{data:null,error:r};throw r}})}update(t,n,r){return De(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,n,r)})}move(t,n,r){return De(this,void 0,void 0,function*(){try{return{data:yield bt(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(pe(s))return{data:null,error:s};throw s}})}copy(t,n,r){return De(this,void 0,void 0,function*(){try{return{data:{path:(yield bt(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(pe(s))return{data:null,error:s};throw s}})}createSignedUrl(t,n,r){return De(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t),i=yield bt(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:n},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(s){if(pe(s))return{data:null,error:s};throw s}})}createSignedUrls(t,n,r){return De(this,void 0,void 0,function*(){try{const s=yield bt(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:t},{headers:this.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(s){if(pe(s))return{data:null,error:s};throw s}})}download(t,n){return De(this,void 0,void 0,function*(){const s=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),o=i?`?${i}`:"";try{const l=this._getFinalPath(t);return{data:yield(yield Ni(this.fetch,`${this.url}/${s}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(pe(l))return{data:null,error:l};throw l}})}info(t){return De(this,void 0,void 0,function*(){const n=this._getFinalPath(t);try{const r=yield Ni(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:Ao(r),error:null}}catch(r){if(pe(r))return{data:null,error:r};throw r}})}exists(t){return De(this,void 0,void 0,function*(){const n=this._getFinalPath(t);try{return yield Jg(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(pe(r)&&r instanceof Do){const s=r.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:r}}throw r}})}getPublicUrl(t,n){const r=this._getFinalPath(t),s=[],i=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";i!==""&&s.push(i);const l=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});c!==""&&s.push(c);let u=s.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${r}${u}`)}}}remove(t){return De(this,void 0,void 0,function*(){try{return{data:yield tf(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(n){if(pe(n))return{data:null,error:n};throw n}})}list(t,n,r){return De(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},qg),n),{prefix:t||""});return{data:yield bt(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(pe(s))return{data:null,error:s};throw s}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const n=[];return t.width&&n.push(`width=${t.width}`),t.height&&n.push(`height=${t.height}`),t.resize&&n.push(`resize=${t.resize}`),t.format&&n.push(`format=${t.format}`),t.quality&&n.push(`quality=${t.quality}`),n.join("&")}}const Yg="2.10.4",Kg={"X-Client-Info":`storage-js/${Yg}`};var Nn=globalThis&&globalThis.__awaiter||function(e,t,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((r=r.apply(e,t||[])).next())})};class Xg{constructor(t,n={},r,s){const i=new URL(t);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href,this.headers=Object.assign(Object.assign({},Kg),n),this.fetch=ef(r)}listBuckets(){return Nn(this,void 0,void 0,function*(){try{return{data:yield Ni(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(pe(t))return{data:null,error:t};throw t}})}getBucket(t){return Nn(this,void 0,void 0,function*(){try{return{data:yield Ni(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(n){if(pe(n))return{data:null,error:n};throw n}})}createBucket(t,n={public:!1}){return Nn(this,void 0,void 0,function*(){try{return{data:yield bt(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(pe(r))return{data:null,error:r};throw r}})}updateBucket(t,n){return Nn(this,void 0,void 0,function*(){try{return{data:yield Oo(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(pe(r))return{data:null,error:r};throw r}})}emptyBucket(t){return Nn(this,void 0,void 0,function*(){try{return{data:yield bt(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(pe(n))return{data:null,error:n};throw n}})}deleteBucket(t){return Nn(this,void 0,void 0,function*(){try{return{data:yield tf(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(n){if(pe(n))return{data:null,error:n};throw n}})}}class e0 extends Xg{constructor(t,n={},r,s){super(t,n,r,s)}from(t){return new Qg(this.url,this.headers,t,this.fetch)}}const t0="2.53.0";let Cr="";typeof Deno<"u"?Cr="deno":typeof document<"u"?Cr="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Cr="react-native":Cr="node";const n0={"X-Client-Info":`supabase-js-${Cr}/${t0}`},r0={headers:n0},s0={schema:"public"},i0={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},a0={};var o0=globalThis&&globalThis.__awaiter||function(e,t,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((r=r.apply(e,t||[])).next())})};const l0=e=>{let t;return e?t=e:typeof fetch>"u"?t=Mh:t=fetch,(...n)=>t(...n)},c0=()=>typeof Headers>"u"?Uh:Headers,u0=(e,t,n)=>{const r=l0(n),s=c0();return(i,o)=>o0(void 0,void 0,void 0,function*(){var l;const c=(l=yield t())!==null&&l!==void 0?l:e;let u=new s(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",e),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),r(i,Object.assign(Object.assign({},o),{headers:u}))})};var d0=globalThis&&globalThis.__awaiter||function(e,t,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((r=r.apply(e,t||[])).next())})};function h0(e){return e.endsWith("/")?e:e+"/"}function f0(e,t){var n,r;const{db:s,auth:i,realtime:o,global:l}=e,{db:c,auth:u,realtime:d,global:h}=t,p={db:Object.assign(Object.assign({},c),s),auth:Object.assign(Object.assign({},u),i),realtime:Object.assign(Object.assign({},d),o),storage:{},global:Object.assign(Object.assign(Object.assign({},h),l),{headers:Object.assign(Object.assign({},(n=h==null?void 0:h.headers)!==null&&n!==void 0?n:{}),(r=l==null?void 0:l.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>d0(this,void 0,void 0,function*(){return""})};return e.accessToken?p.accessToken=e.accessToken:delete p.accessToken,p}const nf="2.71.1",Tn=30*1e3,Ro=3,Ca=Ro*Tn,m0="http://localhost:9999",p0="supabase.auth.token",g0={"X-Client-Info":`gotrue-js/${nf}`},Mo="X-Supabase-Api-Version",rf={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},v0=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,x0=10*60*1e3;class Hl extends Error{constructor(t,n,r){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function Z(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class y0 extends Hl{constructor(t,n,r){super(t,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function w0(e){return Z(e)&&e.name==="AuthApiError"}class sf extends Hl{constructor(t,n){super(t),this.name="AuthUnknownError",this.originalError=n}}class nn extends Hl{constructor(t,n,r,s){super(t,r,s),this.name=n,this.status=r}}class Dt extends nn{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function _0(e){return Z(e)&&e.name==="AuthSessionMissingError"}class Os extends nn{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Rs extends nn{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Ms extends nn{constructor(t,n=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function b0(e){return Z(e)&&e.name==="AuthImplicitGrantRedirectError"}class du extends nn{constructor(t,n=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Uo extends nn{constructor(t,n){super(t,"AuthRetryableFetchError",n,void 0)}}function Ea(e){return Z(e)&&e.name==="AuthRetryableFetchError"}class hu extends nn{constructor(t,n,r){super(t,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}class Fo extends nn{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Si="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),fu=` 	
\r=`.split(""),j0=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<fu.length;t+=1)e[fu[t].charCodeAt(0)]=-2;for(let t=0;t<Si.length;t+=1)e[Si[t].charCodeAt(0)]=t;return e})();function mu(e,t,n){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const r=t.queue>>t.queuedBits-6&63;n(Si[r]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const r=t.queue>>t.queuedBits-6&63;n(Si[r]),t.queuedBits-=6}}function af(e,t,n){const r=j0[e];if(r>-1)for(t.queue=t.queue<<6|r,t.queuedBits+=6;t.queuedBits>=8;)n(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function pu(e){const t=[],n=o=>{t.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=o=>{S0(o,r,n)};for(let o=0;o<e.length;o+=1)af(e.charCodeAt(o),s,i);return t.join("")}function k0(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function N0(e,t){for(let n=0;n<e.length;n+=1){let r=e.charCodeAt(n);if(r>55295&&r<=56319){const s=(r-55296)*1024&65535;r=(e.charCodeAt(n+1)-56320&65535|s)+65536,n+=1}k0(r,t)}}function S0(e,t,n){if(t.utf8seq===0){if(e<=127){n(e);return}for(let r=1;r<6;r+=1)if(!(e>>7-r&1)){t.utf8seq=r;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&n(t.codepoint)}}function P0(e){const t=[],n={queue:0,queuedBits:0},r=s=>{t.push(s)};for(let s=0;s<e.length;s+=1)af(e.charCodeAt(s),n,r);return new Uint8Array(t)}function C0(e){const t=[];return N0(e,n=>t.push(n)),new Uint8Array(t)}function E0(e){const t=[],n={queue:0,queuedBits:0},r=s=>{t.push(s)};return e.forEach(s=>mu(s,n,r)),mu(null,n,r),t.join("")}function T0(e){return Math.round(Date.now()/1e3)+e}function z0(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const nt=()=>typeof window<"u"&&typeof document<"u",rn={tested:!1,writable:!1},of=()=>{if(!nt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(rn.tested)return rn.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),rn.tested=!0,rn.writable=!0}catch{rn.tested=!0,rn.writable=!1}return rn.writable};function $0(e){const t={},n=new URL(e);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((s,i)=>{t[i]=s})}catch{}return n.searchParams.forEach((r,s)=>{t[s]=r}),t}const lf=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...n)=>gs(()=>Promise.resolve().then(()=>cr),void 0).then(({default:r})=>r(...n)):t=fetch,(...n)=>t(...n)},I0=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",zn=async(e,t,n)=>{await e.setItem(t,JSON.stringify(n))},sn=async(e,t)=>{const n=await e.getItem(t);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Lt=async(e,t)=>{await e.removeItem(t)};class Xi{constructor(){this.promise=new Xi.promiseConstructor((t,n)=>{this.resolve=t,this.reject=n})}}Xi.promiseConstructor=Promise;function Ta(e){const t=e.split(".");if(t.length!==3)throw new Fo("Invalid JWT structure");for(let r=0;r<t.length;r++)if(!v0.test(t[r]))throw new Fo("JWT not in base64url format");return{header:JSON.parse(pu(t[0])),payload:JSON.parse(pu(t[1])),signature:P0(t[2]),raw:{header:t[0],payload:t[1]}}}async function L0(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function D0(e,t){return new Promise((r,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await e(i);if(!t(i,null,o)){r(o);return}}catch(o){if(!t(i,o)){s(o);return}}})()})}function A0(e){return("0"+e.toString(16)).substr(-2)}function O0(){const t=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let s="";for(let i=0;i<56;i++)s+=n.charAt(Math.floor(Math.random()*r));return s}return crypto.getRandomValues(t),Array.from(t,A0).join("")}async function R0(e){const n=new TextEncoder().encode(e),r=await crypto.subtle.digest("SHA-256",n),s=new Uint8Array(r);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function M0(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const n=await R0(e);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Sn(e,t,n=!1){const r=O0();let s=r;n&&(s+="/PASSWORD_RECOVERY"),await zn(e,`${t}-code-verifier`,s);const i=await M0(r);return[i,r===i?"plain":"s256"]}const U0=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function F0(e){const t=e.headers.get(Mo);if(!t||!t.match(U0))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function B0(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function H0(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const W0=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Pn(e){if(!W0.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function za(){const e={};return new Proxy(e,{get:(t,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const r=n.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function gu(e){return JSON.parse(JSON.stringify(e))}var Z0=globalThis&&globalThis.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]]);return n};const ln=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),V0=[502,503,504];async function vu(e){var t;if(!I0(e))throw new Uo(ln(e),0);if(V0.includes(e.status))throw new Uo(ln(e),e.status);let n;try{n=await e.json()}catch(i){throw new sf(ln(i),i)}let r;const s=F0(e);if(s&&s.getTime()>=rf["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new hu(ln(n),e.status,((t=n.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(r==="session_not_found")throw new Dt}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new hu(ln(n),e.status,n.weak_password.reasons);throw new y0(ln(n),e.status||500,r)}const G0=(e,t,n,r)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),n))};async function J(e,t,n,r){var s;const i=Object.assign({},r==null?void 0:r.headers);i[Mo]||(i[Mo]=rf["2024-01-01"].name),r!=null&&r.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const o=(s=r==null?void 0:r.query)!==null&&s!==void 0?s:{};r!=null&&r.redirectTo&&(o.redirect_to=r.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await J0(e,t,n+l,{headers:i,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(c):{data:Object.assign({},c),error:null}}async function J0(e,t,n,r,s,i){const o=G0(t,r,s,i);let l;try{l=await e(n,Object.assign({},o))}catch(c){throw console.error(c),new Uo(ln(c),0)}if(l.ok||await vu(l),r!=null&&r.noResolveJson)return l;try{return await l.json()}catch(c){await vu(c)}}function yt(e){var t;let n=null;K0(e)&&(n=Object.assign({},e),e.expires_at||(n.expires_at=T0(e.expires_in)));const r=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:n,user:r},error:null}}function xu(e){const t=yt(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Ut(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function q0(e){return{data:e,error:null}}function Q0(e){const{action_link:t,email_otp:n,hashed_token:r,redirect_to:s,verification_type:i}=e,o=Z0(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:n,hashed_token:r,redirect_to:s,verification_type:i},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function Y0(e){return e}function K0(e){return e.access_token&&e.refresh_token&&e.expires_in}const $a=["global","local","others"];var X0=globalThis&&globalThis.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]]);return n};class ev{constructor({url:t="",headers:n={},fetch:r}){this.url=t,this.headers=n,this.fetch=lf(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,n=$a[0]){if($a.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${$a.join(", ")}`);try{return await J(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Z(r))return{data:null,error:r};throw r}}async inviteUserByEmail(t,n={}){try{return await J(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:Ut})}catch(r){if(Z(r))return{data:{user:null},error:r};throw r}}async generateLink(t){try{const{options:n}=t,r=X0(t,["options"]),s=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(s.new_email=r==null?void 0:r.newEmail,delete s.newEmail),await J(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:Q0,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(Z(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(t){try{return await J(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Ut})}catch(n){if(Z(n))return{data:{user:null},error:n};throw n}}async listUsers(t){var n,r,s,i,o,l,c;try{const u={nextPage:null,lastPage:0,total:0},d=await J(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=t==null?void 0:t.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(i=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:Y0});if(d.error)throw d.error;const h=await d.json(),p=(o=d.headers.get("x-total-count"))!==null&&o!==void 0?o:0,v=(c=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return v.length>0&&(v.forEach(y=>{const x=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),j=JSON.parse(y.split(";")[1].split("=")[1]);u[`${j}Page`]=x}),u.total=parseInt(p)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(Z(u))return{data:{users:[]},error:u};throw u}}async getUserById(t){Pn(t);try{return await J(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Ut})}catch(n){if(Z(n))return{data:{user:null},error:n};throw n}}async updateUserById(t,n){Pn(t);try{return await J(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:n,headers:this.headers,xform:Ut})}catch(r){if(Z(r))return{data:{user:null},error:r};throw r}}async deleteUser(t,n=!1){Pn(t);try{return await J(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:n},xform:Ut})}catch(r){if(Z(r))return{data:{user:null},error:r};throw r}}async _listFactors(t){Pn(t.userId);try{const{data:n,error:r}=await J(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:n,error:r}}catch(n){if(Z(n))return{data:null,error:n};throw n}}async _deleteFactor(t){Pn(t.userId),Pn(t.id);try{return{data:await J(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(n){if(Z(n))return{data:null,error:n};throw n}}}function yu(e={}){return{getItem:t=>e[t]||null,setItem:(t,n)=>{e[t]=n},removeItem:t=>{delete e[t]}}}function tv(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Cn={debug:!!(globalThis&&of()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class cf extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class nv extends cf{}async function rv(e,t,n){Cn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const r=new globalThis.AbortController;return t>0&&setTimeout(()=>{r.abort(),Cn.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async s=>{if(s){Cn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await n()}finally{Cn.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw Cn.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new nv(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Cn.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}tv();const sv={url:m0,storageKey:p0,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:g0,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function wu(e,t,n){return await n()}const En={};class ss{constructor(t){var n,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=ss.nextInstanceID,ss.nextInstanceID+=1,this.instanceID>0&&nt()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},sv),t);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new ev({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=lf(s.fetch),this.lock=s.lock||wu,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:nt()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=rv:this.lock=wu,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:of()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=yu(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=yu(this.memoryStorage)),nt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}get jwks(){var t,n;return(n=(t=En[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(t){En[this.storageKey]=Object.assign(Object.assign({},En[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,n;return(n=(t=En[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){En[this.storageKey]=Object.assign(Object.assign({},En[this.storageKey]),{cachedAt:t})}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${nf}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const n=$0(window.location.href);let r="none";if(this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce"),nt()&&this.detectSessionInUrl&&r!=="none"){const{data:s,error:i}=await this._getSessionFromURL(n,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),b0(i)){const c=(t=i.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:l}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return Z(n)?{error:n}:{error:new sf("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var n,r,s;try{const i=await J(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=t==null?void 0:t.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(s=t==null?void 0:t.options)===null||s===void 0?void 0:s.captchaToken}},xform:yt}),{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(i){if(Z(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(t){var n,r,s;try{let i;if("email"in t){const{email:d,password:h,options:p}=t;let v=null,y=null;this.flowType==="pkce"&&([v,y]=await Sn(this.storage,this.storageKey)),i=await J(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p==null?void 0:p.emailRedirectTo,body:{email:d,password:h,data:(n=p==null?void 0:p.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:v,code_challenge_method:y},xform:yt})}else if("phone"in t){const{phone:d,password:h,options:p}=t;i=await J(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:h,data:(r=p==null?void 0:p.data)!==null&&r!==void 0?r:{},channel:(s=p==null?void 0:p.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken}},xform:yt})}else throw new Rs("You must provide either an email or phone number and a password");const{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(i){if(Z(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(t){try{let n;if("email"in t){const{email:i,password:o,options:l}=t;n=await J(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:xu})}else if("phone"in t){const{phone:i,password:o,options:l}=t;n=await J(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:xu})}else throw new Rs("You must provide either an email or phone number and a password");const{data:r,error:s}=n;return s?{data:{user:null,session:null},error:s}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new Os}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s})}catch(n){if(Z(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(t){var n,r,s,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(n=t.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=t.options)===null||r===void 0?void 0:r.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:n}=t;if(n==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}async signInWithSolana(t){var n,r,s,i,o,l,c,u,d,h,p,v;let y,x;if("message"in t)y=t.message,x=t.signature;else{const{chain:j,wallet:g,statement:f,options:m}=t;let w;if(nt())if(typeof g=="object")w=g;else{const b=window;if("solana"in b&&typeof b.solana=="object"&&("signIn"in b.solana&&typeof b.solana.signIn=="function"||"signMessage"in b.solana&&typeof b.solana.signMessage=="function"))w=b.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof g!="object"||!(m!=null&&m.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=g}const C=new URL((n=m==null?void 0:m.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in w&&w.signIn){const b=await w.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},m==null?void 0:m.signInWithSolana),{version:"1",domain:C.host,uri:C.href}),f?{statement:f}:null));let z;if(Array.isArray(b)&&b[0]&&typeof b[0]=="object")z=b[0];else if(b&&typeof b=="object"&&"signedMessage"in b&&"signature"in b)z=b;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in z&&"signature"in z&&(typeof z.signedMessage=="string"||z.signedMessage instanceof Uint8Array)&&z.signature instanceof Uint8Array)y=typeof z.signedMessage=="string"?z.signedMessage:new TextDecoder().decode(z.signedMessage),x=z.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in w)||typeof w.signMessage!="function"||!("publicKey"in w)||typeof w!="object"||!w.publicKey||!("toBase58"in w.publicKey)||typeof w.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");y=[`${C.host} wants you to sign in with your Solana account:`,w.publicKey.toBase58(),...f?["",f,""]:[""],"Version: 1",`URI: ${C.href}`,`Issued At: ${(s=(r=m==null?void 0:m.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((i=m==null?void 0:m.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${m.signInWithSolana.notBefore}`]:[],...!((o=m==null?void 0:m.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${m.signInWithSolana.expirationTime}`]:[],...!((l=m==null?void 0:m.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${m.signInWithSolana.chainId}`]:[],...!((c=m==null?void 0:m.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${m.signInWithSolana.nonce}`]:[],...!((u=m==null?void 0:m.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${m.signInWithSolana.requestId}`]:[],...!((h=(d=m==null?void 0:m.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||h===void 0)&&h.length?["Resources",...m.signInWithSolana.resources.map(z=>`- ${z}`)]:[]].join(`
`);const b=await w.signMessage(new TextEncoder().encode(y),"utf8");if(!b||!(b instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");x=b}}try{const{data:j,error:g}=await J(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:y,signature:E0(x)},!((p=t.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(v=t.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:yt});if(g)throw g;return!j||!j.session||!j.user?{data:{user:null,session:null},error:new Os}:(j.session&&(await this._saveSession(j.session),await this._notifyAllSubscribers("SIGNED_IN",j.session)),{data:Object.assign({},j),error:g})}catch(j){if(Z(j))return{data:{user:null,session:null},error:j};throw j}}async _exchangeCodeForSession(t){const n=await sn(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(n??"").split("/");try{const{data:i,error:o}=await J(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:r},xform:yt});if(await Lt(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Os}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:o})}catch(i){if(Z(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(t){try{const{options:n,provider:r,token:s,access_token:i,nonce:o}=t,l=await J(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:yt}),{data:c,error:u}=l;return u?{data:{user:null,session:null},error:u}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new Os}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:u})}catch(n){if(Z(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(t){var n,r,s,i,o;try{if("email"in t){const{email:l,options:c}=t;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await Sn(this.storage,this.storageKey));const{error:h}=await J(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(n=c==null?void 0:c.data)!==null&&n!==void 0?n:{},create_user:(r=c==null?void 0:c.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in t){const{phone:l,options:c}=t,{data:u,error:d}=await J(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(s=c==null?void 0:c.data)!==null&&s!==void 0?s:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d}}throw new Rs("You must provide either an email or phone number.")}catch(l){if(Z(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(t){var n,r;try{let s,i;"options"in t&&(s=(n=t.options)===null||n===void 0?void 0:n.redirectTo,i=(r=t.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:l}=await J(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:yt});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,u=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(s){if(Z(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(t){var n,r,s;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await Sn(this.storage,this.storageKey)),await J(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(r=(n=t.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((s=t==null?void 0:t.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:q0})}catch(i){if(Z(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:n},error:r}=t;if(r)throw r;if(!n)throw new Dt;const{error:s}=await J(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:s}})}catch(t){if(Z(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const n=`${this.url}/resend`;if("email"in t){const{email:r,type:s,options:i}=t,{error:o}=await J(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in t){const{phone:r,type:s,options:i}=t,{data:o,error:l}=await J(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new Rs("You must provide either an email or phone number and a type")}catch(n){if(Z(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(t,n){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await t(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const n=await sn(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?t=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const r=t.expires_at?t.expires_at*1e3-Date.now()<Ca:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",t.expires_at),!r){if(this.userStorage){const o=await sn(this.userStorage,this.storageKey+"-user");o!=null&&o.user?t.user=o.user:t.user=za()}if(this.storage.isServer&&t.user){let o=this.suppressGetSessionWarning;t=new Proxy(t,{get:(c,u,d)=>(!o&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,u,d))})}return{data:{session:t},error:null}}const{session:s,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{session:null},error:i}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await J(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Ut}):await this._useSession(async n=>{var r,s,i;const{data:o,error:l}=n;if(l)throw l;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Dt}:await J(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:Ut})})}catch(n){if(Z(n))return _0(n)&&(await this._removeSession(),await Lt(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(t,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,n))}async _updateUser(t,n={}){try{return await this._useSession(async r=>{const{data:s,error:i}=r;if(i)throw i;if(!s.session)throw new Dt;const o=s.session;let l=null,c=null;this.flowType==="pkce"&&t.email!=null&&([l,c]=await Sn(this.storage,this.storageKey));const{data:u,error:d}=await J(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:Ut});if(d)throw d;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(r){if(Z(r))return{data:{user:null},error:r};throw r}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Dt;const n=Date.now()/1e3;let r=n,s=!0,i=null;const{payload:o}=Ta(t.access_token);if(o.exp&&(r=o.exp,s=r<=n),s){const{session:l,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:c}=await this._getUser(t.access_token);if(c)throw c;i={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(n){if(Z(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async n=>{var r;if(!t){const{data:o,error:l}=n;if(l)throw l;t=(r=o.session)!==null&&r!==void 0?r:void 0}if(!(t!=null&&t.refresh_token))throw new Dt;const{session:s,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(Z(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(t,n){try{if(!nt())throw new Ms("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Ms(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new du("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ms("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new du("No code detected.");const{data:f,error:m}=await this._exchangeCodeForSession(t.code);if(m)throw m;const w=new URL(window.location.href);return w.searchParams.delete("code"),window.history.replaceState(window.history.state,"",w.toString()),{data:{session:f.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:s,access_token:i,refresh_token:o,expires_in:l,expires_at:c,token_type:u}=t;if(!i||!l||!o||!u)throw new Ms("No session defined in URL");const d=Math.round(Date.now()/1e3),h=parseInt(l);let p=d+h;c&&(p=parseInt(c));const v=p-d;v*1e3<=Tn&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${v}s, should have been closer to ${h}s`);const y=p-h;d-y>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",y,p,d):d-y<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",y,p,d);const{data:x,error:j}=await this._getUser(i);if(j)throw j;const g={provider_token:r,provider_refresh_token:s,access_token:i,expires_in:h,expires_at:p,refresh_token:o,token_type:u,user:x.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:g,redirectType:t.type},error:null}}catch(r){if(Z(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const n=await sn(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&n)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:s,error:i}=n;if(i)return{error:i};const o=(r=s.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:l}=await this.admin.signOut(o,t);if(l&&!(w0(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return t!=="others"&&(await this._removeSession(),await Lt(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const n=z0(),r={id:n,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(t){return await this._useSession(async n=>{var r,s;try{const{data:{session:i},error:o}=n;if(o)throw o;await((r=this.stateChangeEmitters.get(t))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,n={}){let r=null,s=null;this.flowType==="pkce"&&([r,s]=await Sn(this.storage,this.storageKey,!0));try{return await J(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(i){if(Z(i))return{data:null,error:i};throw i}}async getUserIdentities(){var t;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(t=n.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(n){if(Z(n))return{data:null,error:n};throw n}}async linkIdentity(t){var n;try{const{data:r,error:s}=await this._useSession(async i=>{var o,l,c,u,d;const{data:h,error:p}=i;if(p)throw p;const v=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await J(this.fetch,"GET",v,{headers:this.headers,jwt:(d=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(s)throw s;return nt()&&!(!((n=t.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:t.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(Z(r))return{data:{provider:t.provider,url:null},error:r};throw r}}async unlinkIdentity(t){try{return await this._useSession(async n=>{var r,s;const{data:i,error:o}=n;if(o)throw o;return await J(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0})})}catch(n){if(Z(n))return{data:null,error:n};throw n}}async _refreshAccessToken(t){const n=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await D0(async s=>(s>0&&await L0(200*Math.pow(2,s-1)),this._debug(n,"refreshing attempt",s),await J(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:yt})),(s,i)=>{const o=200*Math.pow(2,s);return i&&Ea(i)&&Date.now()+o-r<Tn})}catch(r){if(this._debug(n,"error",r),Z(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(n,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",n,"url",r),nt()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:t,url:r},error:null}}async _recoverAndRefresh(){var t,n;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const s=await sn(this.storage,this.storageKey);if(s&&this.userStorage){let o=await sn(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:s.user},await zn(this.userStorage,this.storageKey+"-user",o)),s.user=(t=o==null?void 0:o.user)!==null&&t!==void 0?t:za()}else if(s&&!s.user&&!s.user){const o=await sn(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(s.user=o.user,await Lt(this.storage,this.storageKey+"-user"),await zn(this.storage,this.storageKey,s)):s.user=za()}if(this._debug(r,"session from storage",s),!this._isValidSession(s)){this._debug(r,"session is not valid"),s!==null&&await this._removeSession();return}const i=((n=s.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<Ca;if(this._debug(r,`session has${i?"":" not"} expired with margin of ${Ca}s`),i){if(this.autoRefreshToken&&s.refresh_token){const{error:o}=await this._callRefreshToken(s.refresh_token);o&&(console.error(o),Ea(o)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(s.access_token);!l&&(o!=null&&o.user)?(s.user=o.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(r,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(r,"error",s),console.error(s);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var n,r;if(!t)throw new Dt;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Xi;const{data:i,error:o}=await this._refreshAccessToken(t);if(o)throw o;if(!i.session)throw new Dt;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={session:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(s,"error",i),Z(i)){const o={session:null,error:i};return Ea(i)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,n,r=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:t,session:n});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,n)}catch(c){i.push(c)}});if(await Promise.all(o),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const n=Object.assign({},t),r=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&n.user&&await zn(this.userStorage,this.storageKey+"-user",{user:n.user});const s=Object.assign({},n);delete s.user;const i=gu(s);await zn(this.storage,this.storageKey,i)}else{const s=gu(n);await zn(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await Lt(this.storage,this.storageKey),await Lt(this.storage,this.storageKey+"-code-verifier"),await Lt(this.storage,this.storageKey+"-user"),this.userStorage&&await Lt(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&nt()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Tn);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((r.expires_at*1e3-t)/Tn);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Tn}ms, refresh threshold is ${Ro} ticks`),s<=Ro&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof cf)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!nt()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const n=`#_onVisibilityChanged(${t})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,n,r){const s=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[i,o]=await Sn(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(l.toString())}if(r!=null&&r.queryParams){const i=new URLSearchParams(r.queryParams);s.push(i.toString())}return r!=null&&r.skipBrowserRedirect&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async n=>{var r;const{data:s,error:i}=n;return i?{data:null,error:i}:await J(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(Z(n))return{data:null,error:n};throw n}}async _enroll(t){try{return await this._useSession(async n=>{var r,s;const{data:i,error:o}=n;if(o)return{data:null,error:o};const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:c,error:u}=await J(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return u?{data:null,error:u}:(t.factorType==="totp"&&(!((s=c==null?void 0:c.totp)===null||s===void 0)&&s.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(n){if(Z(n))return{data:null,error:n};throw n}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:s,error:i}=n;if(i)return{data:null,error:i};const{data:o,error:l}=await J(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(n){if(Z(n))return{data:null,error:n};throw n}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:s,error:i}=n;return i?{data:null,error:i}:await J(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(Z(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(t){const{data:n,error:r}=await this._challenge({factorId:t.factorId});return r?{data:null,error:r}:await this._verify({factorId:t.factorId,challengeId:n.id,code:t.code})}async _listFactors(){const{data:{user:t},error:n}=await this.getUser();if(n)return{data:null,error:n};const r=(t==null?void 0:t.factors)||[],s=r.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=r.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:r,totp:s,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var n,r;const{data:{session:s},error:i}=t;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=Ta(s.access_token);let l=null;o.aal&&(l=o.aal);let c=l;((r=(n=s.user.factors)===null||n===void 0?void 0:n.filter(h=>h.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(c="aal2");const d=o.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:d},error:null}}))}async fetchJwk(t,n={keys:[]}){let r=n.keys.find(l=>l.kid===t);if(r)return r;const s=Date.now();if(r=this.jwks.keys.find(l=>l.kid===t),r&&this.jwks_cached_at+x0>s)return r;const{data:i,error:o}=await J(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=s,r=i.keys.find(l=>l.kid===t),!r)?null:r}async getClaims(t,n={}){try{let r=t;if(!r){const{data:v,error:y}=await this.getSession();if(y||!v.session)return{data:null,error:y};r=v.session.access_token}const{header:s,payload:i,signature:o,raw:{header:l,payload:c}}=Ta(r);n!=null&&n.allowExpired||B0(i.exp);const u=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!u){const{error:v}=await this.getUser(r);if(v)throw v;return{data:{claims:i,header:s,signature:o},error:null}}const d=H0(s.alg),h=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,h,o,C0(`${l}.${c}`)))throw new Fo("Invalid JWT signature");return{data:{claims:i,header:s,signature:o},error:null}}catch(r){if(Z(r))return{data:null,error:r};throw r}}}ss.nextInstanceID=0;const iv=ss;class av extends iv{constructor(t){super(t)}}var ov=globalThis&&globalThis.__awaiter||function(e,t,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((r=r.apply(e,t||[])).next())})};class lv{constructor(t,n,r){var s,i,o;if(this.supabaseUrl=t,this.supabaseKey=n,!t)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const l=h0(t),c=new URL(l);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const u=`sb-${c.hostname.split(".")[0]}-auth-token`,d={db:s0,realtime:a0,auth:Object.assign(Object.assign({},i0),{storageKey:u}),global:r0},h=f0(r??{},d);this.storageKey=(s=h.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=h.global.headers)!==null&&i!==void 0?i:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(p,v)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(v)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=h.auth)!==null&&o!==void 0?o:{},this.headers,h.global.fetch),this.fetch=u0(n,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new Sg(new URL("rest/v1",c).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),this.storage=new e0(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new ng(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,n={},r={}){return this.rest.rpc(t,n,r)}channel(t,n={config:{}}){return this.realtime.channel(t,n)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,n;return ov(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(n=(t=r.session)===null||t===void 0?void 0:t.access_token)!==null&&n!==void 0?n:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:n,detectSessionInUrl:r,storage:s,storageKey:i,flowType:o,lock:l,debug:c},u,d){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new av({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),u),storageKey:i,autoRefreshToken:t,persistSession:n,detectSessionInUrl:r,storage:s,flowType:o,lock:l,debug:c,fetch:d,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new Fg(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,r)=>{this._handleTokenChanged(n,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(t,n,r){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:t==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const cv=(e,t,n)=>new lv(e,t,n);function uv(){if(typeof window<"u"||typeof process>"u"||process.version===void 0||process.version===null)return!1;const e=process.version.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}uv()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const dv="https://yqnvmjbizbgtapfffgdt.supabase.co",hv="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlxbnZtamJpemJndGFwZmZmZ2R0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU3MDEwOTUsImV4cCI6MjA3MTI3NzA5NX0.i8swy_UwmvmOIwdr8SnxCHkTbQkQ_jy-gRYrEtcsj7k",W=cv(dv,hv,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!1}}),uf=O.createContext(void 0);function fv({children:e}){const[t,n]=O.useState(null),[r,s]=O.useState(!1),[i,o]=O.useState(!1),[l,c]=O.useState(null);function u(f){c(f)}function d(){c(null)}O.useEffect(()=>{h();const{data:{subscription:f}}=W.auth.onAuthStateChange(async(m,w)=>{var C;console.log("🔐 Auth state changed:",m,(C=w==null?void 0:w.user)==null?void 0:C.email),w!=null&&w.user?await p(w.user.id):(n(null),s(!1))});return()=>f.unsubscribe()},[]);const h=async()=>{try{const{data:{session:f}}=await W.auth.getSession();f!=null&&f.user&&await p(f.user.id)}catch(f){console.error("Error initializing auth:",f)}},p=async f=>{var m,w,C,b;try{console.log("👤 Loading user profile for:",f);const{data:z,error:k}=await W.from("users").select("*").eq("id",f).single();if(k){console.warn("⚠️ User profile not found, creating new profile:",k.message);const{data:T}=await W.auth.getUser();if(T.user){const Y=((m=T.user.user_metadata)==null?void 0:m.name)||T.user.email.split("@")[0]||"User",Q=((w=T.user.user_metadata)==null?void 0:w.phone)||null,K=((C=T.user.user_metadata)==null?void 0:C.region)||"Christchurch",S=((b=T.user.user_metadata)==null?void 0:b.language)||"en",{data:M,error:B}=await W.from("users").insert([{id:T.user.id,email:T.user.email,name:Y,phone:Q,region:K,language:S}]).select().single();!B&&M?(console.log("✅ Created new user profile"),n({id:M.id,name:M.name,email:M.email,phone:M.phone,region:M.region,language:M.language,avatar:M.avatar_url,favoriteProducts:[],createdAt:M.created_at,lastLoginAt:M.last_login_at}),s(!0)):(console.error("❌ Failed to create user profile:",B),u("Failed to create user profile"))}return}console.log("✅ User profile found:",z.name);const{data:_}=await W.from("user_favorites").select("product_id").eq("user_id",f),N={id:z.id,name:z.name,email:z.email,phone:z.phone,region:z.region,language:z.language||"en",avatar:z.avatar_url,favoriteProducts:(_==null?void 0:_.map(T=>T.product_id))||[],createdAt:z.created_at,lastLoginAt:z.last_login_at};n(N),s(!0),console.log("✅ User profile loaded successfully:",N.name)}catch(z){console.error("Error in loadUserProfile:",z),u("Failed to load user profile")}},v=async f=>{o(!0),d();try{console.log("🔑 Attempting login for:",f.email);const{data:m,error:w}=await W.auth.signInWithPassword({email:f.email,password:f.password});return w?(console.error("❌ Login failed:",w.message),w.message.includes("Email logins are disabled")||w.message.includes("email_provider_disabled")?c(`邮箱登录功能已被禁用。请联系管理员启用邮箱认证功能。

Email login is disabled. Please contact administrator to enable email authentication.`):c(w.message),!1):m.user?(await W.from("users").update({last_login_at:new Date().toISOString()}).eq("id",m.user.id),console.log("✅ Login successful"),!0):!1}catch(m){return console.error("❌ Login error:",m),c(typeof m=="string"?m:(m==null?void 0:m.message)||"Login failed"),!1}finally{o(!1)}},y=async f=>{o(!0),d();try{if(f.password!==f.confirmPassword)return c("Passwords do not match"),!1;if(f.password.length<6)return c("Password must be at least 6 characters"),!1;if(!f.name.trim())return c("Name is required"),!1;console.log("📝 Attempting registration for:",f.email);const{data:m,error:w}=await W.auth.signUp({email:f.email,password:f.password,options:{emailRedirectTo:void 0,data:{name:f.name,phone:f.phone,region:f.region||"Christchurch",language:"en"}}});if(w)return console.error("❌ Auth registration failed:",w.message),w.message.includes("Email signups are disabled")||w.message.includes("email_provider_disabled")?c(`邮箱注册功能已被禁用。请联系管理员启用邮箱认证功能。

Email signup is disabled. Please contact administrator to enable email authentication.`):c(w.message),!1;if(!m.user)return c("Registration failed - no user created"),!1;const C={id:m.user.id,email:m.user.email,name:f.name,phone:f.phone||null,region:f.region||"Christchurch",language:"en"},{error:b}=await W.from("users").insert([C]);return b&&console.warn("⚠️ Profile creation failed but auth user exists:",b.message),console.log("✅ Registration successful"),!0}catch(m){return console.error("❌ Registration error:",m),c(typeof m=="string"?m:(m==null?void 0:m.message)||"Registration failed"),!1}finally{o(!1)}},x=async()=>{o(!0);try{await W.auth.signOut(),n(null),s(!1),console.log("✅ Logout successful")}catch(f){console.error("❌ Logout error:",f)}finally{o(!1)}},j=async f=>{if(!t)return!1;o(!0),d();try{const{data:m,error:w}=await W.from("users").update({name:f.name,phone:f.phone,region:f.region,avatar_url:f.avatar,updated_at:new Date().toISOString()}).eq("id",t.id).select().single();return w?(c(w.message),!1):(n({...t,...f}),console.log("✅ Profile updated successfully"),!0)}catch(m){return console.error("❌ Profile update error:",m),c(typeof m=="string"?m:(m==null?void 0:m.message)||"Update failed"),!1}finally{o(!1)}},g=async()=>{o(!0),d();try{console.log("🎭 Creating demo accounts...");const f=[{email:"admin@upick.life",password:"admin123",name:"Administrator",region:"Christchurch",language:"en"},{email:"user@upick.life",password:"user123",name:"Demo User",region:"Christchurch",language:"en"},{email:"test@upick.life",password:"test123",name:"Test User",region:"Auckland",language:"en"}];let m=0,w=0;for(const C of f)try{console.log(`🎭 Creating account: ${C.email}`);const{data:b,error:z}=await W.auth.signUp({email:C.email,password:C.password,options:{emailRedirectTo:void 0,data:{name:C.name,region:C.region,language:C.language}}});if(z){if(z.message.includes("already registered")){console.log(`✅ Account ${C.email} already exists`),m++;continue}if(z.message.includes("Email signups are disabled")){console.warn(`⚠️ Email signups disabled for ${C.email}`),w++;continue}console.warn(`⚠️ Failed to create ${C.email}:`,z.message),w++;continue}if(b.user){const{error:k}=await W.from("users").insert([{id:b.user.id,email:b.user.email,name:C.name,region:C.region,language:C.language}]);k?(console.warn(`⚠️ Failed to create profile for ${C.email}:`,k.message),w++):(console.log(`✅ Successfully created ${C.email}`),m++)}}catch(b){console.warn(`⚠️ Error creating ${C.email}:`,b),w++}if(console.log(`✅ Demo accounts process completed: ${m} success, ${w} errors`),o(!1),w>0&&m===0)throw o(!1),new Error("Failed to create any demo accounts. Please check Supabase email authentication settings.")}catch(f){throw console.error("❌ Error creating demo accounts:",f),o(!1),f}};return a.jsx(uf.Provider,{value:{user:t,isAuthenticated:r,isLoading:i,error:l,login:v,register:y,logout:x,updateProfile:j,clearError:d,setError:u,createDemoAccounts:g},children:e})}function jn(){const e=O.useContext(uf);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e}const Er=[{id:1,name_en:"Pak'nSave Riccarton",name_zh:"派克储蓄超市",location:"Riccarton",logo_url:"https://images.pexels.com/photos/264636/pexels-photo-264636.jpeg?auto=compress&cs=tinysrgb&w=100",lat:-43.53,lng:172.62,phone:"+64 3 348 8052",hours:"7:00 AM - 10:00 PM",rating:4.2},{id:2,name_en:"Countdown Westfield",name_zh:"倒计时超市",location:"Riccarton",logo_url:"https://images.pexels.com/photos/1005638/pexels-photo-1005638.jpeg?auto=compress&cs=tinysrgb&w=100",lat:-43.53,lng:172.61,phone:"+64 3 348 7766",hours:"6:00 AM - 12:00 AM",rating:4},{id:3,name_en:"New World Riccarton",name_zh:"新世界超市",location:"Riccarton",logo_url:"https://images.pexels.com/photos/4199098/pexels-photo-4199098.jpeg?auto=compress&cs=tinysrgb&w=100",lat:-43.528,lng:172.615,phone:"+64 3 349 7018",hours:"7:00 AM - 10:00 PM",rating:4.1},{id:4,name_en:"FreshChoice Barrington",name_zh:"新鲜选择超市",location:"Barrington",logo_url:"https://images.pexels.com/photos/2292919/pexels-photo-2292919.jpeg?auto=compress&cs=tinysrgb&w=100",lat:-43.54,lng:172.61,phone:"+64 3 338 3045",hours:"7:00 AM - 9:00 PM",rating:4.3},{id:5,name_en:"Countdown Northlands",name_zh:"倒计时北地超市",location:"Papanui",logo_url:"https://images.pexels.com/photos/1005638/pexels-photo-1005638.jpeg?auto=compress&cs=tinysrgb&w=100",lat:-43.485,lng:172.605,phone:"+64 3 352 5050",hours:"6:00 AM - 12:00 AM",rating:4.1},{id:6,name_en:"Pak'nSave Hornby",name_zh:"派克储蓄霍恩比店",location:"Hornby",logo_url:"https://images.pexels.com/photos/264636/pexels-photo-264636.jpeg?auto=compress&cs=tinysrgb&w=100",lat:-43.535,lng:172.52,phone:"+64 3 349 8800",hours:"7:00 AM - 10:00 PM",rating:4},{id:7,name_en:"New World Bishopdale",name_zh:"新世界主教谷店",location:"Bishopdale",logo_url:"https://images.pexels.com/photos/4199098/pexels-photo-4199098.jpeg?auto=compress&cs=tinysrgb&w=100",lat:-43.495,lng:172.555,phone:"+64 3 359 4040",hours:"7:00 AM - 10:00 PM",rating:4.2},{id:8,name_en:"Countdown Eastgate",name_zh:"倒计时东门店",location:"Linwood",logo_url:"https://images.pexels.com/photos/1005638/pexels-photo-1005638.jpeg?auto=compress&cs=tinysrgb&w=100",lat:-43.55,lng:172.68,phone:"+64 3 381 4500",hours:"6:00 AM - 12:00 AM",rating:3.9},{id:9,name_en:"Four Square Addington",name_zh:"四方超市",location:"Addington",logo_url:"https://images.pexels.com/photos/2292919/pexels-photo-2292919.jpeg?auto=compress&cs=tinysrgb&w=100",lat:-43.545,lng:172.595,phone:"+64 3 338 2020",hours:"7:00 AM - 9:00 PM",rating:4}],Ks=[{id:1,name_en:"Fresh Tomatoes",name_zh:"新鲜番茄",image:"https://images.pexels.com/photos/533280/pexels-photo-533280.jpeg?auto=compress&cs=tinysrgb&w=300",price:2.99,originalPrice:3.99,unit:"NZD/kg",supermarket_id:1,category:"vegetable",updated_at:"2025-01-20",isSpecial:!0,specialEndDate:"2025-01-25",discount:25,origin:"New Zealand",freshness:"Grade A",rating:4.5},{id:2,name_en:"Royal Gala Apples",name_zh:"皇家嘎拉苹果",image:"https://images.pexels.com/photos/206959/pexels-photo-206959.jpeg?auto=compress&cs=tinysrgb&w=300",price:4.5,unit:"NZD/kg",supermarket_id:2,category:"fruit",updated_at:"2025-01-20",origin:"New Zealand",freshness:"Premium",rating:4.8},{id:3,name_en:"Fresh Salmon Fillet",name_zh:"新鲜三文鱼片",image:"https://images.pexels.com/photos/725991/pexels-photo-725991.jpeg?auto=compress&cs=tinysrgb&w=300",price:28.99,unit:"NZD/kg",supermarket_id:3,category:"seafood",updated_at:"2025-01-20",origin:"South Island",freshness:"Premium",rating:4.7},{id:4,name_en:"Organic Carrots",name_zh:"有机胡萝卜",image:"https://images.pexels.com/photos/143133/pexels-photo-143133.jpeg?auto=compress&cs=tinysrgb&w=300",price:3.2,originalPrice:3.8,unit:"NZD/kg",supermarket_id:4,category:"vegetable",updated_at:"2025-01-19",isSpecial:!0,specialEndDate:"2025-01-24",discount:16,origin:"Canterbury",freshness:"Organic",rating:4.6},{id:5,name_en:"Premium Beef",name_zh:"优质牛肉",image:"https://images.pexels.com/photos/65175/pexels-photo-65175.jpeg?auto=compress&cs=tinysrgb&w=300",price:12.99,unit:"NZD/kg",supermarket_id:1,category:"meat",updated_at:"2025-01-19",origin:"Canterbury",freshness:"Grade A",rating:4.4},{id:6,name_en:"Fresh Milk",name_zh:"新鲜牛奶",image:"https://images.pexels.com/photos/248412/pexels-photo-248412.jpeg?auto=compress&cs=tinysrgb&w=300",price:2.8,unit:"NZD/L",supermarket_id:2,category:"dairy",updated_at:"2025-01-19",origin:"Canterbury",freshness:"Fresh",rating:4.3},{id:7,name_en:"Mandarin Oranges",name_zh:"蜜柑",image:"https://images.pexels.com/photos/1070946/pexels-photo-1070946.jpeg?auto=compress&cs=tinysrgb&w=300",price:5.99,originalPrice:7.99,unit:"NZD/kg",supermarket_id:5,category:"fruit",updated_at:"2025-01-18",isSpecial:!0,specialEndDate:"2025-01-26",discount:25,origin:"Nelson",freshness:"Premium",rating:4.7},{id:8,name_en:"Fresh Spinach",name_zh:"新鲜菠菜",image:"https://images.pexels.com/photos/2255935/pexels-photo-2255935.jpeg?auto=compress&cs=tinysrgb&w=300",price:4.5,unit:"NZD/bunch",supermarket_id:3,category:"vegetable",updated_at:"2025-01-18",origin:"Canterbury",freshness:"Grade A",rating:4.2},{id:9,name_en:"Chicken Breast",name_zh:"鸡胸肉",image:"https://images.pexels.com/photos/616354/pexels-photo-616354.jpeg?auto=compress&cs=tinysrgb&w=300",price:15.99,originalPrice:18.99,unit:"NZD/kg",supermarket_id:4,category:"meat",updated_at:"2025-01-17",isSpecial:!0,specialEndDate:"2025-01-27",discount:16,origin:"New Zealand",freshness:"Premium",rating:4.6},{id:10,name_en:"Fresh Bananas",name_zh:"新鲜香蕉",image:"https://images.pexels.com/photos/1093038/pexels-photo-1093038.jpeg?auto=compress&cs=tinysrgb&w=300",price:2.99,unit:"NZD/kg",supermarket_id:1,category:"fruit",updated_at:"2025-01-17",origin:"Ecuador",freshness:"Grade A",rating:4.1},{id:11,name_en:"Fresh Tomatoes",name_zh:"新鲜番茄",image:"https://images.pexels.com/photos/533280/pexels-photo-533280.jpeg?auto=compress&cs=tinysrgb&w=300",price:3.49,unit:"NZD/kg",supermarket_id:2,category:"vegetable",updated_at:"2025-01-20",origin:"New Zealand",freshness:"Grade A",rating:4.3},{id:12,name_en:"Fresh Tomatoes",name_zh:"新鲜番茄",image:"https://images.pexels.com/photos/533280/pexels-photo-533280.jpeg?auto=compress&cs=tinysrgb&w=300",price:3.2,unit:"NZD/kg",supermarket_id:3,category:"vegetable",updated_at:"2025-01-20",origin:"New Zealand",freshness:"Premium",rating:4.4},{id:13,name_en:"Royal Gala Apples",name_zh:"皇家嘎拉苹果",image:"https://images.pexels.com/photos/206959/pexels-photo-206959.jpeg?auto=compress&cs=tinysrgb&w=300",price:4.99,unit:"NZD/kg",supermarket_id:1,category:"fruit",updated_at:"2025-01-19",origin:"New Zealand",freshness:"Grade A",rating:4.6},{id:14,name_en:"Royal Gala Apples",name_zh:"皇家嘎拉苹果",image:"https://images.pexels.com/photos/206959/pexels-photo-206959.jpeg?auto=compress&cs=tinysrgb&w=300",price:4.2,unit:"NZD/kg",supermarket_id:3,category:"fruit",updated_at:"2025-01-19",origin:"New Zealand",freshness:"Premium",rating:4.7},{id:15,name_en:"Fresh Milk",name_zh:"新鲜牛奶",image:"https://images.pexels.com/photos/248412/pexels-photo-248412.jpeg?auto=compress&cs=tinysrgb&w=300",price:3.2,unit:"NZD/L",supermarket_id:1,category:"dairy",updated_at:"2025-01-18",origin:"Canterbury",freshness:"Fresh",rating:4.5},{id:16,name_en:"Fresh Milk",name_zh:"新鲜牛奶",image:"https://images.pexels.com/photos/248412/pexels-photo-248412.jpeg?auto=compress&cs=tinysrgb&w=300",price:2.99,unit:"NZD/L",supermarket_id:4,category:"dairy",updated_at:"2025-01-18",origin:"Canterbury",freshness:"Fresh",rating:4.2},{id:17,name_en:"Organic Carrots",name_zh:"有机胡萝卜",image:"https://images.pexels.com/photos/143133/pexels-photo-143133.jpeg?auto=compress&cs=tinysrgb&w=300",price:3.8,unit:"NZD/kg",supermarket_id:1,category:"vegetable",updated_at:"2025-01-17",origin:"Canterbury",freshness:"Organic",rating:4.4},{id:18,name_en:"Organic Carrots",name_zh:"有机胡萝卜",image:"https://images.pexels.com/photos/143133/pexels-photo-143133.jpeg?auto=compress&cs=tinysrgb&w=300",price:3.5,unit:"NZD/kg",supermarket_id:2,category:"vegetable",updated_at:"2025-01-17",origin:"Canterbury",freshness:"Organic",rating:4.5},{id:19,name_en:"Greek Yogurt",name_zh:"希腊酸奶",image:"https://images.pexels.com/photos/1435735/pexels-photo-1435735.jpeg?auto=compress&cs=tinysrgb&w=300",price:6.99,originalPrice:8.99,unit:"NZD/500g",supermarket_id:3,category:"dairy",updated_at:"2025-01-16",isSpecial:!0,specialEndDate:"2025-01-23",discount:22,origin:"New Zealand",freshness:"Premium",rating:4.8},{id:20,name_en:"Fresh Broccoli",name_zh:"新鲜西兰花",image:"https://images.pexels.com/photos/47347/broccoli-vegetable-food-healthy-47347.jpeg?auto=compress&cs=tinysrgb&w=300",price:4.99,unit:"NZD/kg",supermarket_id:5,category:"vegetable",updated_at:"2025-01-16",origin:"Canterbury",freshness:"Grade A",rating:4.3}];Ks.forEach(e=>{e.supermarket=Er.find(t=>t.id===e.supermarket_id)});const df=O.createContext(void 0);function mv({children:e}){const[t,n]=O.useState("en"),[r,s]=O.useState([]),[i,o]=O.useState([]),[l,c]=O.useState([]),[u,d]=O.useState(""),[h,p]=O.useState("all"),[v,y]=O.useState([]),[x,j]=O.useState("updated"),[g,f]=O.useState(!0),[m,w]=O.useState("connecting"),C=async()=>{try{console.log("📊 开始同步mock数据到数据库...");const S=new Promise(($,I)=>{setTimeout(()=>I(new Error("Connection timeout")),1e4)}),M=W.from("supermarkets").select("count").limit(1);let B=null;try{B=(await Promise.race([M,S])).error}catch($){return $ instanceof Error&&($.message==="Connection timeout"?console.warn("⚠️ 数据库连接超时"):$.name==="TypeError"&&($.message.includes("Failed to fetch")||$.message.includes("fetch"))?console.warn("⚠️ 网络连接失败，无法访问Supabase (可能是CORS或网络问题)"):console.warn("⚠️ 数据库连接异常:",$.message)),!1}if(B)return console.warn("⚠️ 数据库连接失败:",B.message),!1;console.log("🏪 同步超市数据...");let A=null;try{const $=await W.from("supermarkets").select("id, name_en");if(A=$.data,$.error)return console.warn("⚠️ 获取现有超市数据失败:",$.error.message),!1}catch{return console.warn("⚠️ 获取现有超市数据时网络异常"),!1}const U=new Set((A==null?void 0:A.map($=>$.name_en))||[]),E=Er.filter($=>!U.has($.name_en));if(E.length>0){const $=E.map(I=>({name_en:I.name_en,name_zh:I.name_zh,location:I.location,logo_url:I.logo_url,latitude:I.lat,longitude:I.lng,phone:I.phone,hours:I.hours,rating:I.rating}));try{const{error:I}=await W.from("supermarkets").insert($);if(I)return console.warn("⚠️ 同步超市数据失败:",I.message),!1;console.log("✅ 成功同步",E.length,"个超市")}catch{return console.warn("⚠️ 同步超市数据时网络异常"),!1}}else console.log("📋 超市数据已存在，跳过同步");let G=null;try{const $=await W.from("supermarkets").select("id, name_en");if(G=$.data,$.error)return console.warn("⚠️ 获取超市ID映射失败:",$.error.message),!1}catch{return console.warn("⚠️ 获取超市ID映射时网络异常"),!1}const L=new Map;G==null||G.forEach($=>{const I=Er.find(X=>X.name_en===$.name_en);I&&L.set(I.id,$.id)}),console.log("🛒 同步商品数据...");let F=null;try{const $=await W.from("products").select("id, name_en, supermarket_id");if(F=$.data,$.error)return console.warn("⚠️ 获取现有商品数据失败:",$.error.message),!1}catch{return console.warn("⚠️ 获取现有商品数据时网络异常"),!1}const V=new Set((F==null?void 0:F.map($=>`${$.name_en}-${$.supermarket_id}`))||[]),P=Ks.filter($=>{const I=L.get($.supermarket_id),X=`${$.name_en}-${I}`;return I&&!V.has(X)});if(P.length>0){const $=P.map(I=>({name_en:I.name_en,name_zh:I.name_zh,image_url:I.image,price:I.price,original_price:I.originalPrice,unit:I.unit,supermarket_id:L.get(I.supermarket_id),category:I.category,origin:I.origin,freshness:I.freshness,rating:I.rating,is_special:I.isSpecial||!1,special_end_date:I.specialEndDate,discount_percentage:I.discount}));try{const{error:I}=await W.from("products").insert($);if(I)return console.warn("⚠️ 同步商品数据失败:",I.message),!1;console.log("✅ 成功同步",P.length,"个商品")}catch{return console.warn("⚠️ 同步商品数据时网络异常"),!1}}else console.log("📋 商品数据已存在，跳过同步");return console.log("🎉 Mock数据同步完成！"),!0}catch(S){return S instanceof TypeError&&(S.message.includes("Failed to fetch")||S.message.includes("fetch"))?console.warn("⚠️ 网络连接异常，无法同步数据到Supabase"):S instanceof Error&&S.message==="Connection timeout"?console.warn("⚠️ 连接超时，无法同步数据到Supabase"):console.warn("⚠️ 同步mock数据时出现异常:",S),!1}},b=async()=>{try{return console.log("🧹 开始清除重复数据..."),await z()?await k()?await _()?(console.log("✅ 重复数据清除完成"),!0):(console.log("❌ 精简商品数据失败"),!1):(console.log("❌ 清除重复商品数据失败"),!1):(console.log("❌ 清除重复超市数据失败"),!1)}catch(S){return console.error("💥 清除重复数据时出现异常:",S),!1}},z=async()=>{try{console.log("🏪 清除重复超市数据...");const{data:S,error:M}=await W.from("supermarkets").select("*").order("id");if(M){if(M.code==="42501"||M.message.includes("row-level security policy"))return console.warn("⚠️ RLS策略阻止访问超市数据"),!1;throw M}return(!S||S.length===0)&&console.log("📋 没有超市数据需要清理"),!0}catch(S){return console.error("💥 清除重复超市数据时出现异常:",S),!1}},k=async()=>{try{return console.log("🛒 清除重复商品数据..."),!0}catch(S){return console.error("💥 清除重复商品数据时出现异常:",S),!1}},_=async()=>{try{return console.log("📦 精简商品数据..."),!0}catch(S){return console.error("💥 精简商品数据时出现异常:",S),!1}},N=async()=>{try{console.log("🏪 开始加载超市数据...");const S=new Promise((E,G)=>{setTimeout(()=>G(new Error("Connection timeout")),1e4)}),M=W.from("supermarkets").select("*").order("name_en");let B=null,A=null;try{const E=await Promise.race([M,S]);B=E.data,A=E.error}catch(E){return E instanceof Error&&(E.message==="Connection timeout"?console.warn("⚠️ 加载超市数据超时"):E.name==="TypeError"&&(E.message.includes("Failed to fetch")||E.message.includes("fetch"))?console.warn("⚠️ 网络连接失败，无法加载超市数据 (可能是CORS或网络问题)"):console.warn("⚠️ 加载超市数据异常:",E.message)),!1}if(A)return console.warn("⚠️ 加载超市数据失败:",A.message),!1;if(!B||B.length===0)return console.log("📋 数据库中没有超市数据"),!1;const U=B.map(E=>({id:E.id,name_en:E.name_en,name_zh:E.name_zh,location:E.location,logo_url:E.logo_url||"",lat:parseFloat(E.latitude.toString()),lng:parseFloat(E.longitude.toString()),phone:E.phone,hours:E.hours,rating:E.rating?parseFloat(E.rating.toString()):void 0}));return o(U),console.log("✅ 成功加载",U.length,"个超市"),!0}catch(S){return S instanceof TypeError&&S.message.includes("Failed to fetch")?console.warn("⚠️ 网络连接异常，无法加载超市数据"):S instanceof Error&&S.message==="Connection timeout"?console.warn("⚠️ 连接超时，无法加载超市数据"):console.warn("⚠️ 加载超市时出现异常:",S),!1}},T=async()=>{try{console.log("🛒 开始加载商品数据...");const S=new Promise((E,G)=>{setTimeout(()=>G(new Error("Connection timeout")),1e4)}),M=W.from("products").select(`
          *,
          supermarket:supermarkets(*)
        `).order("updated_at",{ascending:!1});let B=null,A=null;try{const E=await Promise.race([M,S]);B=E.data,A=E.error}catch(E){return E instanceof Error&&(E.message==="Connection timeout"?console.warn("⚠️ 加载商品数据超时"):E.name==="TypeError"&&(E.message.includes("Failed to fetch")||E.message.includes("fetch"))?console.warn("⚠️ 网络连接失败，无法加载商品数据 (可能是CORS或网络问题)"):console.warn("⚠️ 加载商品数据异常:",E.message)),!1}if(A)return console.warn("⚠️ 加载商品数据失败:",A.message),!1;if(!B||B.length===0)return console.log("📋 数据库中没有商品数据"),!1;const U=B.map(E=>({id:E.id,name_en:E.name_en,name_zh:E.name_zh,image:E.image_url||"",price:parseFloat(E.price.toString()),originalPrice:E.original_price?parseFloat(E.original_price.toString()):void 0,unit:E.unit,supermarket_id:E.supermarket_id,supermarket:E.supermarket?{id:E.supermarket.id,name_en:E.supermarket.name_en,name_zh:E.supermarket.name_zh,location:E.supermarket.location,logo_url:E.supermarket.logo_url||"",lat:parseFloat(E.supermarket.latitude.toString()),lng:parseFloat(E.supermarket.longitude.toString()),phone:E.supermarket.phone,hours:E.supermarket.hours,rating:E.supermarket.rating?parseFloat(E.supermarket.rating.toString()):void 0}:void 0,category:E.category,updated_at:E.updated_at,isSpecial:E.is_special,specialEndDate:E.special_end_date,discount:E.discount_percentage,origin:E.origin,freshness:E.freshness,rating:E.rating?parseFloat(E.rating.toString()):void 0}));return s(U),console.log("✅ 数据加载完成"),!0}catch(S){return S instanceof TypeError&&(S.message.includes("Failed to fetch")||S.message.includes("fetch"))?console.warn("⚠️ 网络连接异常，无法加载商品数据"):S instanceof Error&&S.message==="Connection timeout"?console.warn("⚠️ 连接超时，无法加载商品数据"):console.warn("⚠️ 加载商品时出现异常:",S),!1}},Y=async()=>{try{console.log("🔄 开始加载数据..."),f(!0),w("connecting"),await C()||console.log("⚠️ 数据同步失败，但继续尝试加载现有数据");const[M,B]=await Promise.all([N(),T()]);M&&B?(w("connected"),console.log("✅ 数据库数据加载成功")):(console.log("⚠️ 数据库数据加载失败，切换到离线模式"),w("failed"),console.log("📋 使用本地mock数据作为备用方案，应用将在离线模式下运行"),o(Er),s(Ks),w("fallback"))}catch(S){console.warn("⚠️ 数据加载异常，切换到离线模式:",S),w("fallback"),console.log("📋 使用本地mock数据作为备用方案，应用将在离线模式下运行"),o(Er),s(Ks)}finally{f(!1)}},Q=async()=>{console.log("🔄 手动刷新数据..."),await Y()};O.useEffect(()=>{(async()=>{await Y()})()},[]),O.useEffect(()=>{const S=localStorage.getItem("upick-language");S&&(S==="en"||S==="zh")&&n(S)},[]),O.useEffect(()=>{const S=localStorage.getItem("upick-favorites");if(S)try{c(JSON.parse(S))}catch(M){console.error("Failed to parse favorites:",M)}},[]),O.useEffect(()=>{localStorage.setItem("upick-language",t)},[t]),O.useEffect(()=>{localStorage.setItem("upick-favorites",JSON.stringify(l))},[l]);const K=S=>{c(M=>M.includes(S)?M.filter(B=>B!==S):[...M,S])};return a.jsx(df.Provider,{value:{language:t,setLanguage:n,products:r,supermarkets:i,favoriteProducts:l,toggleFavorite:K,searchTerm:u,setSearchTerm:d,selectedCategory:h,setSelectedCategory:p,selectedSupermarkets:v,setSelectedSupermarkets:y,sortBy:x,setSortBy:j,isLoading:g,refreshData:Q,connectionStatus:m,cleanDuplicateData:b,reduceProductsByCategory:_},children:e})}function Ce(){const e=O.useContext(df);if(e===void 0)throw new Error("useApp must be used within an AppProvider");return e}var pv={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const gv=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),vv=(e,t)=>{const n=O.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,children:l,...c},u)=>O.createElement("svg",{ref:u,...pv,width:s,height:s,stroke:r,strokeWidth:o?Number(i)*24/Number(s):i,className:`lucide lucide-${gv(e)}`,...c},[...t.map(([d,h])=>O.createElement(d,h)),...(Array.isArray(l)?l:[l])||[]]));return n.displayName=`${e}`,n};var H=vv;const xv=H("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]),yv=H("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),wv=H("Apple",[["path",{d:"M12 20.94c1.5 0 2.75 1.06 4 1.06 3 0 6-8 6-12.22A4.91 4.91 0 0 0 17 5c-2.22 0-4 1.44-5 2-1-.56-2.78-2-5-2a4.9 4.9 0 0 0-5 4.78C2 14 5 22 8 22c1.25 0 2.5-1.06 4-1.06Z",key:"3s7exb"}],["path",{d:"M10 2c1 .5 2 2 2 5",key:"fcco2y"}]]),Bo=H("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),hf=H("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]),ff=H("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),_v=H("Beef",[["circle",{cx:"12.5",cy:"8.5",r:"2.5",key:"9738u8"}],["path",{d:"M12.5 2a6.5 6.5 0 0 0-6.22 4.6c-1.1 3.13-.78 3.9-3.18 6.08A3 3 0 0 0 5 18c4 0 8.4-1.8 11.4-4.3A6.5 6.5 0 0 0 12.5 2Z",key:"o0f6za"}],["path",{d:"m18.5 6 2.19 4.5a6.48 6.48 0 0 1 .31 2 6.49 6.49 0 0 1-2.6 5.2C15.4 20.2 11 22 7 22a3 3 0 0 1-2.68-1.66L2.4 16.5",key:"k7p6i0"}]]),mf=H("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),bv=H("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),jv=H("Carrot",[["path",{d:"M2.27 21.7s9.87-3.5 12.73-6.36a4.5 4.5 0 0 0-6.36-6.37C5.77 11.84 2.27 21.7 2.27 21.7zM8.64 14l-2.05-2.04M15.34 15l-2.46-2.46",key:"rfqxbe"}],["path",{d:"M22 9s-1.33-2-3.5-2C16.86 7 15 9 15 9s1.33 2 3.5 2S22 9 22 9z",key:"6b25w4"}],["path",{d:"M15 2s-2 1.33-2 3.5S15 9 15 9s2-1.84 2-3.5C17 3.33 15 2 15 2z",key:"fn65lo"}]]),pf=H("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),Wl=H("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),kv=H("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),Nv=H("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),gt=H("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),_u=H("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),Sv=H("Egg",[["path",{d:"M12 22c6.23-.05 7.87-5.57 7.5-10-.36-4.34-3.95-9.96-7.5-10-3.55.04-7.14 5.66-7.5 10-.37 4.43 1.27 9.95 7.5 10z",key:"1c39pg"}]]),Ia=H("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),Xs=H("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Pv=H("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),Ho=H("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z",key:"nb9nel"}]]),St=H("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),Cv=H("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),La=H("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),sr=H("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]),Pi=H("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),Te=H("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),Ev=H("Milk",[["path",{d:"M8 2h8",key:"1ssgc1"}],["path",{d:"M9 2v2.789a4 4 0 0 1-.672 2.219l-.656.984A4 4 0 0 0 7 10.212V20a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-9.789a4 4 0 0 0-.672-2.219l-.656-.984A4 4 0 0 1 15 4.788V2",key:"qtp12x"}],["path",{d:"M7 15a6.472 6.472 0 0 1 5 0 6.47 6.47 0 0 0 5 0",key:"ygeh44"}]]),gf=H("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),Ci=H("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]),is=H("Package",[["path",{d:"M16.5 9.4 7.55 4.24",key:"10qotr"}],["path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z",key:"yt0hxn"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]]),Tv=H("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]),as=H("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),Zl=H("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),vf=H("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),zv=H("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),xf=H("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),bu=H("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Ei=H("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),os=H("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),yf=H("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]),ju=H("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),ls=H("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),cs=H("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),$v=H("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),Ti=H("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),Da=H("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),us=H("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),ir=H("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);function Iv(){const{language:e,setLanguage:t}=Ce();return a.jsxs("button",{onClick:()=>t(e==="en"?"zh":"en"),className:"flex items-center space-x-1 sm:space-x-2 px-2 sm:px-3 py-2 rounded-lg bg-white shadow-sm border border-gray-200 hover:bg-gray-50 transition-colors whitespace-nowrap flex-shrink-0",children:[a.jsx(Ho,{className:"w-4 h-4 text-gray-600"}),a.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-700 whitespace-nowrap",style:{fontFamily:e==="zh"?"Arial, sans-serif":"inherit",letterSpacing:e==="zh"?"0.5px":"normal"},children:e==="en"?"中文":"EN"})]})}function wf({isOpen:e,onClose:t}){const{language:n}=Ce(),{login:r,register:s,error:i,clearError:o,isLoading:l,createDemoAccounts:c}=jn(),[u,d]=O.useState(!0),[h,p]=O.useState(!1),[v,y]=O.useState(!1),[x,j]=O.useState({email:"",password:""}),[g,f]=O.useState({name:"",email:"",password:"",confirmPassword:"",phone:"",region:""}),m={en:{login:"Login",register:"Register",email:"Email",password:"Password",confirmPassword:"Confirm Password",name:"Full Name",phone:"Phone Number",region:"Region",loginButton:"Sign In",registerButton:"Create Account",switchToRegister:"Don't have an account? Register",switchToLogin:"Already have an account? Login",emailPlaceholder:"Enter your email",passwordPlaceholder:"Enter your password",confirmPasswordPlaceholder:"Confirm your password",namePlaceholder:"Enter your full name",phonePlaceholder:"+64 21 123 4567",regionPlaceholder:"Select your region",optional:"(Optional)",christchurch:"Christchurch",auckland:"Auckland",wellington:"Wellington",hamilton:"Hamilton",tauranga:"Tauranga",dunedin:"Dunedin"},zh:{login:"登录",register:"注册",email:"邮箱",password:"密码",confirmPassword:"确认密码",name:"姓名",phone:"电话号码",region:"地区",loginButton:"登录",registerButton:"创建账户",switchToRegister:"没有账户？立即注册",switchToLogin:"已有账户？立即登录",emailPlaceholder:"请输入邮箱",passwordPlaceholder:"请输入密码",confirmPasswordPlaceholder:"请确认密码",namePlaceholder:"请输入姓名",phonePlaceholder:"+64 21 123 4567",regionPlaceholder:"选择地区",optional:"（可选）",christchurch:"基督城",auckland:"奥克兰",wellington:"惠灵顿",hamilton:"汉密尔顿",tauranga:"陶朗加",dunedin:"但尼丁"}},w=[{value:"Christchurch",label:m[n].christchurch},{value:"Auckland",label:m[n].auckland},{value:"Wellington",label:m[n].wellington},{value:"Hamilton",label:m[n].hamilton},{value:"Tauranga",label:m[n].tauranga},{value:"Dunedin",label:m[n].dunedin}],C=()=>{o(),j({email:"",password:""}),f({name:"",email:"",password:"",confirmPassword:"",phone:"",region:""}),p(!1),y(!1),t()},b=async _=>{if(_.preventDefault(),o(),!x.email||!x.password){setError(n==="en"?"Please fill in all required fields":"请填写所有必填字段");return}await r(x)&&C()},z=async _=>{if(_.preventDefault(),o(),g.password!==g.confirmPassword){setError(n==="en"?"Passwords do not match":"两次输入的密码不一致");return}if(g.password.length<6){setError(n==="en"?"Password must be at least 6 characters":"密码至少需要6个字符");return}if(!g.name.trim()){setError(n==="en"?"Name is required":"请输入姓名");return}await s(g)&&(d(!0),j({email:g.email,password:""}),f({name:"",email:"",password:"",confirmPassword:"",phone:"",region:""}),setError(n==="en"?"Registration successful! Please login.":"注册成功！请登录。"))},k=()=>{d(!u),o(),j({email:"",password:""}),f({name:"",email:"",password:"",confirmPassword:"",phone:"",region:""}),p(!1),y(!1)};return e?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",style:{zIndex:1e4},children:a.jsxs("div",{className:"bg-white rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 flex items-center justify-between rounded-t-2xl",children:[a.jsx("h2",{className:`text-xl font-bold text-gray-900 ${n==="zh"?"font-chinese":""}`,children:u?m[n].login:m[n].register}),a.jsx("button",{onClick:C,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:a.jsx(us,{className:"w-6 h-6"})})]}),a.jsxs("div",{className:"p-6",children:[i&&a.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:a.jsx("div",{className:`text-red-600 text-sm ${n==="zh"?"font-chinese":""}`,children:typeof i=="string"?i.split(`
`).map((_,N)=>a.jsx("p",{className:N>0?"mt-2":"",children:_},N)):a.jsx("p",{children:(i==null?void 0:i.message)||"An error occurred"})})}),u?a.jsxs("form",{onSubmit:b,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:`block text-sm font-medium text-gray-700 mb-2 ${n==="zh"?"font-chinese":""}`,children:m[n].email}),a.jsxs("div",{className:"relative",children:[a.jsx(Pi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("input",{type:"email",required:!0,value:x.email,onChange:_=>j({...x,email:_.target.value}),placeholder:m[n].emailPlaceholder,className:`w-full pl-10 pr-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent ${n==="zh"?"font-chinese":""}`})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:`block text-sm font-medium text-gray-700 mb-2 ${n==="zh"?"font-chinese":""}`,children:m[n].password}),a.jsxs("div",{className:"relative",children:[a.jsx(La,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("input",{type:h?"text":"password",required:!0,value:x.password,onChange:_=>j({...x,password:_.target.value}),placeholder:m[n].passwordPlaceholder,className:`w-full pl-10 pr-12 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent ${n==="zh"?"font-chinese":""}`}),a.jsx("button",{type:"button",onClick:()=>p(!h),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:h?a.jsx(Ia,{className:"w-5 h-5"}):a.jsx(Xs,{className:"w-5 h-5"})})]})]}),a.jsx("button",{type:"submit",disabled:l,className:`w-full bg-primary-500 hover:bg-primary-600 text-white py-3 rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed ${n==="zh"?"font-chinese":""}`,children:l?a.jsxs("div",{className:"flex items-center justify-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),m[n].loginButton]}):m[n].loginButton})]}):a.jsxs("form",{onSubmit:z,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:`block text-sm font-medium text-gray-700 mb-2 ${n==="zh"?"font-chinese":""}`,children:m[n].name}),a.jsxs("div",{className:"relative",children:[a.jsx(Ti,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("input",{type:"text",required:!0,value:g.name,onChange:_=>f({...g,name:_.target.value}),placeholder:m[n].namePlaceholder,className:`w-full pl-10 pr-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent ${n==="zh"?"font-chinese":""}`})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:`block text-sm font-medium text-gray-700 mb-2 ${n==="zh"?"font-chinese":""}`,children:m[n].email}),a.jsxs("div",{className:"relative",children:[a.jsx(Pi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("input",{type:"email",required:!0,value:g.email,onChange:_=>f({...g,email:_.target.value}),placeholder:m[n].emailPlaceholder,className:`w-full pl-10 pr-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent ${n==="zh"?"font-chinese":""}`})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:`block text-sm font-medium text-gray-700 mb-2 ${n==="zh"?"font-chinese":""}`,children:m[n].password}),a.jsxs("div",{className:"relative",children:[a.jsx(La,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("input",{type:h?"text":"password",required:!0,value:g.password,onChange:_=>f({...g,password:_.target.value}),placeholder:m[n].passwordPlaceholder,className:`w-full pl-10 pr-12 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent ${n==="zh"?"font-chinese":""}`}),a.jsx("button",{type:"button",onClick:()=>p(!h),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:h?a.jsx(Ia,{className:"w-5 h-5"}):a.jsx(Xs,{className:"w-5 h-5"})})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:`block text-sm font-medium text-gray-700 mb-2 ${n==="zh"?"font-chinese":""}`,children:m[n].confirmPassword}),a.jsxs("div",{className:"relative",children:[a.jsx(La,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("input",{type:v?"text":"password",required:!0,value:g.confirmPassword,onChange:_=>f({...g,confirmPassword:_.target.value}),placeholder:m[n].confirmPasswordPlaceholder,className:`w-full pl-10 pr-12 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent ${n==="zh"?"font-chinese":""}`}),a.jsx("button",{type:"button",onClick:()=>y(!v),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:v?a.jsx(Ia,{className:"w-5 h-5"}):a.jsx(Xs,{className:"w-5 h-5"})})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:`block text-sm font-medium text-gray-700 mb-2 ${n==="zh"?"font-chinese":""}`,children:[m[n].phone," ",a.jsx("span",{className:"text-gray-400",children:m[n].optional})]}),a.jsxs("div",{className:"relative",children:[a.jsx(as,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("input",{type:"tel",value:g.phone,onChange:_=>f({...g,phone:_.target.value}),placeholder:m[n].phonePlaceholder,className:`w-full pl-10 pr-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent ${n==="zh"?"font-chinese":""}`})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:`block text-sm font-medium text-gray-700 mb-2 ${n==="zh"?"font-chinese":""}`,children:[m[n].region," ",a.jsx("span",{className:"text-gray-400",children:m[n].optional})]}),a.jsxs("div",{className:"relative",children:[a.jsx(Te,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsxs("select",{value:g.region,onChange:_=>f({...g,region:_.target.value}),className:`w-full pl-10 pr-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent ${n==="zh"?"font-chinese":""}`,children:[a.jsx("option",{value:"",children:m[n].regionPlaceholder}),w.map(_=>a.jsx("option",{value:_.value,children:_.label},_.value))]})]})]}),a.jsx("button",{type:"submit",disabled:l,className:`w-full bg-primary-500 hover:bg-primary-600 text-white py-3 rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed ${n==="zh"?"font-chinese":""}`,children:l?a.jsxs("div",{className:"flex items-center justify-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),m[n].registerButton]}):m[n].registerButton})]}),a.jsx("div",{className:"mt-6 text-center",children:a.jsx("button",{onClick:k,className:`text-primary-600 hover:text-primary-700 font-medium ${n==="zh"?"font-chinese":""}`,children:u?m[n].switchToRegister:m[n].switchToLogin})}),u&&a.jsxs("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsx("h4",{className:"text-blue-900 font-medium mb-3 text-sm",children:n==="en"?"Demo Accounts:":"演示账户："}),a.jsxs("div",{className:"space-y-3 text-xs",children:[a.jsxs("div",{className:"bg-white p-3 rounded border",children:[a.jsx("div",{className:"font-medium text-blue-800",children:n==="en"?"Administrator:":"管理员："}),a.jsx("div",{className:"text-blue-600",children:"admin@upick.life / admin123"})]}),a.jsxs("div",{className:"bg-white p-3 rounded border",children:[a.jsx("div",{className:"font-medium text-blue-800",children:n==="en"?"Demo User:":"演示用户："}),a.jsx("div",{className:"text-blue-600",children:"user@upick.life / user123"})]}),a.jsxs("div",{className:"bg-white p-3 rounded border",children:[a.jsx("div",{className:"font-medium text-blue-800",children:n==="en"?"Test User:":"测试用户："}),a.jsx("div",{className:"text-blue-600",children:"test@upick.life / test123"})]}),a.jsx("div",{className:"text-blue-600 mt-3 p-2 bg-blue-100 rounded text-center",children:n==="en"?"⚠️ If accounts don't exist, create them first":"⚠️ 如果账户不存在，请先创建"}),a.jsx("button",{type:"button",onClick:async()=>{try{await c(),setError((n==="en"?"✅ Demo accounts created successfully! You can now login with the demo credentials above.":"✅ 演示账户创建成功！现在可以使用上面的演示凭据登录了。")+`

`+(n==="en"?'Note: If you see "already registered" errors, the accounts already exist and you can login directly.':'注意：如果看到"已注册"错误，说明账户已存在，可以直接登录。'))}catch(_){console.error("❌ 创建演示账户失败:",_);const N=_ instanceof Error?_.message:"Unknown error";setError((n==="en"?"❌ Failed to create demo accounts: ":"❌ 创建演示账户失败：")+N+`

`+(n==="en"?"Please ensure email authentication is enabled in Supabase console.":"请确保在Supabase控制台中启用了邮箱认证。"))}},disabled:l,className:`w-full mt-3 bg-green-500 hover:bg-green-600 text-white py-2 px-3 rounded text-xs font-medium transition-colors disabled:opacity-50 ${n==="zh"?"font-chinese":""}`,children:l?a.jsxs("div",{className:"flex items-center justify-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b border-white mr-1"}),n==="en"?"Creating...":"创建中..."]}):n==="en"?"🎭 Create Demo Accounts":"🎭 创建演示账户"})]})]})]})]})}):null}function Wo(e){"@babel/helpers - typeof";return Wo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wo(e)}function ut(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function Se(e){ut(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||Wo(e)==="object"&&t==="[object Date]"?new Date(e.getTime()):typeof e=="number"||t==="[object Number]"?new Date(e):((typeof e=="string"||t==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}var Lv={};function Dv(){return Lv}function ku(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),e.getTime()-t.getTime()}function ei(e,t){ut(2,arguments);var n=Se(e),r=Se(t),s=n.getTime()-r.getTime();return s<0?-1:s>0?1:s}function Av(e,t){ut(2,arguments);var n=Se(e),r=Se(t),s=n.getFullYear()-r.getFullYear(),i=n.getMonth()-r.getMonth();return s*12+i}function Ov(e,t){return ut(2,arguments),Se(e).getTime()-Se(t).getTime()}var Nu={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(t){return t<0?Math.ceil(t):Math.floor(t)}},Rv="trunc";function Mv(e){return e?Nu[e]:Nu[Rv]}function Uv(e){ut(1,arguments);var t=Se(e);return t.setHours(23,59,59,999),t}function Fv(e){ut(1,arguments);var t=Se(e),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}function Bv(e){ut(1,arguments);var t=Se(e);return Uv(t).getTime()===Fv(t).getTime()}function Hv(e,t){ut(2,arguments);var n=Se(e),r=Se(t),s=ei(n,r),i=Math.abs(Av(n,r)),o;if(i<1)o=0;else{n.getMonth()===1&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-s*i);var l=ei(n,r)===-s;Bv(Se(e))&&i===1&&ei(e,r)===1&&(l=!1),o=s*(i-Number(l))}return o===0?0:o}function Wv(e,t,n){ut(2,arguments);var r=Ov(e,t)/1e3;return Mv(n==null?void 0:n.roundingMethod)(r)}var Zv={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Vv=function(t,n,r){var s,i=Zv[t];return typeof i=="string"?s=i:n===1?s=i.one:s=i.other.replace("{{count}}",n.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+s:s+" ago":s};const Gv=Vv;function Aa(e){return function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=t.width?String(t.width):e.defaultWidth,r=e.formats[n]||e.formats[e.defaultWidth];return r}}var Jv={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},qv={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Qv={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Yv={date:Aa({formats:Jv,defaultWidth:"full"}),time:Aa({formats:qv,defaultWidth:"full"}),dateTime:Aa({formats:Qv,defaultWidth:"full"})};const Kv=Yv;var Xv={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},ex=function(t,n,r,s){return Xv[t]};const tx=ex;function br(e){return function(t,n){var r=n!=null&&n.context?String(n.context):"standalone",s;if(r==="formatting"&&e.formattingValues){var i=e.defaultFormattingWidth||e.defaultWidth,o=n!=null&&n.width?String(n.width):i;s=e.formattingValues[o]||e.formattingValues[i]}else{var l=e.defaultWidth,c=n!=null&&n.width?String(n.width):e.defaultWidth;s=e.values[c]||e.values[l]}var u=e.argumentCallback?e.argumentCallback(t):t;return s[u]}}var nx={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},rx={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},sx={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},ix={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},ax={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},ox={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},lx=function(t,n){var r=Number(t),s=r%100;if(s>20||s<10)switch(s%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},cx={ordinalNumber:lx,era:br({values:nx,defaultWidth:"wide"}),quarter:br({values:rx,defaultWidth:"wide",argumentCallback:function(t){return t-1}}),month:br({values:sx,defaultWidth:"wide"}),day:br({values:ix,defaultWidth:"wide"}),dayPeriod:br({values:ax,defaultWidth:"wide",formattingValues:ox,defaultFormattingWidth:"wide"})};const ux=cx;function jr(e){return function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=n.width,s=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],i=t.match(s);if(!i)return null;var o=i[0],l=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(l)?hx(l,function(h){return h.test(o)}):dx(l,function(h){return h.test(o)}),u;u=e.valueCallback?e.valueCallback(c):c,u=n.valueCallback?n.valueCallback(u):u;var d=t.slice(o.length);return{value:u,rest:d}}}function dx(e,t){for(var n in e)if(e.hasOwnProperty(n)&&t(e[n]))return n}function hx(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return n}function fx(e){return function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.match(e.matchPattern);if(!r)return null;var s=r[0],i=t.match(e.parsePattern);if(!i)return null;var o=e.valueCallback?e.valueCallback(i[0]):i[0];o=n.valueCallback?n.valueCallback(o):o;var l=t.slice(s.length);return{value:o,rest:l}}}var mx=/^(\d+)(th|st|nd|rd)?/i,px=/\d+/i,gx={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},vx={any:[/^b/i,/^(a|c)/i]},xx={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},yx={any:[/1/i,/2/i,/3/i,/4/i]},wx={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},_x={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},bx={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},jx={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},kx={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Nx={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Sx={ordinalNumber:fx({matchPattern:mx,parsePattern:px,valueCallback:function(t){return parseInt(t,10)}}),era:jr({matchPatterns:gx,defaultMatchWidth:"wide",parsePatterns:vx,defaultParseWidth:"any"}),quarter:jr({matchPatterns:xx,defaultMatchWidth:"wide",parsePatterns:yx,defaultParseWidth:"any",valueCallback:function(t){return t+1}}),month:jr({matchPatterns:wx,defaultMatchWidth:"wide",parsePatterns:_x,defaultParseWidth:"any"}),day:jr({matchPatterns:bx,defaultMatchWidth:"wide",parsePatterns:jx,defaultParseWidth:"any"}),dayPeriod:jr({matchPatterns:kx,defaultMatchWidth:"any",parsePatterns:Nx,defaultParseWidth:"any"})};const Px=Sx;var Cx={code:"en-US",formatDistance:Gv,formatLong:Kv,formatRelative:tx,localize:ux,match:Px,options:{weekStartsOn:0,firstWeekContainsDate:1}};const Ex=Cx;function _f(e,t){if(e==null)throw new TypeError("assign requires that input parameter not be null or undefined");for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}function Tx(e){return _f({},e)}var Su=1440,zx=2520,Oa=43200,$x=86400;function Ix(e,t,n){var r,s;ut(2,arguments);var i=Dv(),o=(r=(s=n==null?void 0:n.locale)!==null&&s!==void 0?s:i.locale)!==null&&r!==void 0?r:Ex;if(!o.formatDistance)throw new RangeError("locale must contain formatDistance property");var l=ei(e,t);if(isNaN(l))throw new RangeError("Invalid time value");var c=_f(Tx(n),{addSuffix:!!(n!=null&&n.addSuffix),comparison:l}),u,d;l>0?(u=Se(t),d=Se(e)):(u=Se(e),d=Se(t));var h=Wv(d,u),p=(ku(d)-ku(u))/1e3,v=Math.round((h-p)/60),y;if(v<2)return n!=null&&n.includeSeconds?h<5?o.formatDistance("lessThanXSeconds",5,c):h<10?o.formatDistance("lessThanXSeconds",10,c):h<20?o.formatDistance("lessThanXSeconds",20,c):h<40?o.formatDistance("halfAMinute",0,c):h<60?o.formatDistance("lessThanXMinutes",1,c):o.formatDistance("xMinutes",1,c):v===0?o.formatDistance("lessThanXMinutes",1,c):o.formatDistance("xMinutes",v,c);if(v<45)return o.formatDistance("xMinutes",v,c);if(v<90)return o.formatDistance("aboutXHours",1,c);if(v<Su){var x=Math.round(v/60);return o.formatDistance("aboutXHours",x,c)}else{if(v<zx)return o.formatDistance("xDays",1,c);if(v<Oa){var j=Math.round(v/Su);return o.formatDistance("xDays",j,c)}else if(v<$x)return y=Math.round(v/Oa),o.formatDistance("aboutXMonths",y,c)}if(y=Hv(d,u),y<12){var g=Math.round(v/Oa);return o.formatDistance("xMonths",g,c)}else{var f=y%12,m=Math.floor(y/12);return f<3?o.formatDistance("aboutXYears",m,c):f<9?o.formatDistance("overXYears",m,c):o.formatDistance("almostXYears",m+1,c)}}function Vl(e,t){return ut(1,arguments),Ix(e,Date.now(),t)}function Lx({isOpen:e,onClose:t}){var C;const{language:n}=Ce(),{user:r,updateProfile:s,logout:i,error:o,clearError:l,isLoading:c}=jn(),[u,d]=O.useState(!1),[h,p]=O.useState({name:(r==null?void 0:r.name)||"",phone:(r==null?void 0:r.phone)||"",region:(r==null?void 0:r.region)||"",avatar:(r==null?void 0:r.avatar)||""}),v={en:{profile:"My Profile",edit:"Edit Profile",save:"Save Changes",cancel:"Cancel",logout:"Logout",name:"Full Name",email:"Email",phone:"Phone Number",region:"Region",memberSince:"Member Since",lastLogin:"Last Login",favoriteProducts:"Favorite Products",changeAvatar:"Change Avatar",namePlaceholder:"Enter your full name",phonePlaceholder:"+64 21 123 4567",regionPlaceholder:"Select your region",updateSuccess:"Profile updated successfully",logoutConfirm:"Are you sure you want to logout?",christchurch:"Christchurch",auckland:"Auckland",wellington:"Wellington",hamilton:"Hamilton",tauranga:"Tauranga",dunedin:"Dunedin"},zh:{profile:"我的资料",edit:"编辑资料",save:"保存更改",cancel:"取消",logout:"退出登录",name:"姓名",email:"邮箱",phone:"电话号码",region:"地区",memberSince:"注册时间",lastLogin:"最后登录",favoriteProducts:"收藏商品",changeAvatar:"更换头像",namePlaceholder:"请输入姓名",phonePlaceholder:"+64 21 123 4567",regionPlaceholder:"选择地区",updateSuccess:"资料更新成功",logoutConfirm:"确定要退出登录吗？",christchurch:"基督城",auckland:"奥克兰",wellington:"惠灵顿",hamilton:"汉密尔顿",tauranga:"陶朗加",dunedin:"但尼丁"}},y=[{value:"Christchurch",label:v[n].christchurch},{value:"Auckland",label:v[n].auckland},{value:"Wellington",label:v[n].wellington},{value:"Hamilton",label:v[n].hamilton},{value:"Tauranga",label:v[n].tauranga},{value:"Dunedin",label:v[n].dunedin}],x=()=>{l(),d(!1),p({name:(r==null?void 0:r.name)||"",phone:(r==null?void 0:r.phone)||"",region:(r==null?void 0:r.region)||"",avatar:(r==null?void 0:r.avatar)||""}),t()},j=()=>{d(!0),l()},g=()=>{d(!1),p({name:(r==null?void 0:r.name)||"",phone:(r==null?void 0:r.phone)||"",region:(r==null?void 0:r.region)||"",avatar:(r==null?void 0:r.avatar)||""}),l()},f=async()=>{if(!h.name.trim()){setError(n==="en"?"Name is required":"姓名不能为空");return}await s(h)&&(d(!1),l(),window.dispatchEvent(new CustomEvent("userProfileUpdated")))},m=()=>{window.confirm(v[n].logoutConfirm)&&(i(),x())},w=b=>{var k;const z=(k=b.target.files)==null?void 0:k[0];if(z){const _=new FileReader;_.onload=N=>{var T;p({...h,avatar:(T=N.target)==null?void 0:T.result})},_.readAsDataURL(z)}};return!e||!r?null:a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",style:{zIndex:1e4},children:a.jsxs("div",{className:"bg-white rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 flex items-center justify-between rounded-t-2xl",children:[a.jsx("h2",{className:`text-xl font-bold text-gray-900 ${n==="zh"?"font-chinese":""}`,children:v[n].profile}),a.jsx("button",{onClick:x,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:a.jsx(us,{className:"w-6 h-6"})})]}),a.jsxs("div",{className:"p-6",children:[o&&a.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:a.jsx("p",{className:`text-red-600 text-sm ${n==="zh"?"font-chinese":""}`,children:typeof o=="string"?o:(o==null?void 0:o.message)||"An error occurred"})}),a.jsxs("div",{className:"text-center mb-6",children:[a.jsxs("div",{className:"relative inline-block",children:[a.jsx("img",{src:h.avatar||r.avatar||"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=100",alt:r.name,className:"w-24 h-24 rounded-full object-cover border-4 border-white shadow-lg",onError:b=>{b.currentTarget.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOTYiIGhlaWdodD0iOTYiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iIzQ4YjA0YSIgcng9IjQ4Ii8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIzMiIgZmlsbD0id2hpdGUiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj7nlKjmiLc8L3RleHQ+PC9zdmc+"}}),u&&a.jsxs("label",{className:"absolute bottom-0 right-0 bg-primary-500 hover:bg-primary-600 text-white p-2 rounded-full cursor-pointer transition-colors",children:[a.jsx(bv,{className:"w-4 h-4"}),a.jsx("input",{type:"file",accept:"image/*",onChange:w,className:"hidden"})]})]}),a.jsx("h3",{className:`text-xl font-bold text-gray-900 mt-3 ${n==="zh"?"font-chinese":""}`,children:u?h.name:r.name}),a.jsx("p",{className:"text-gray-600",children:r.email})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:`block text-sm font-medium text-gray-700 mb-2 ${n==="zh"?"font-chinese":""}`,children:v[n].name}),u?a.jsxs("div",{className:"relative",children:[a.jsx(Ti,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("input",{type:"text",value:h.name,onChange:b=>p({...h,name:b.target.value}),placeholder:v[n].namePlaceholder,className:`w-full pl-10 pr-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent ${n==="zh"?"font-chinese":""}`})]}):a.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[a.jsx(Ti,{className:"w-5 h-5 text-gray-600"}),a.jsx("span",{className:`text-gray-900 ${n==="zh"?"font-chinese":""}`,children:r.name})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:`block text-sm font-medium text-gray-700 mb-2 ${n==="zh"?"font-chinese":""}`,children:v[n].email}),a.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[a.jsx(Pi,{className:"w-5 h-5 text-gray-600"}),a.jsx("span",{className:"text-gray-900",children:r.email})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:`block text-sm font-medium text-gray-700 mb-2 ${n==="zh"?"font-chinese":""}`,children:v[n].phone}),u?a.jsxs("div",{className:"relative",children:[a.jsx(as,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("input",{type:"tel",value:h.phone,onChange:b=>p({...h,phone:b.target.value}),placeholder:v[n].phonePlaceholder,className:`w-full pl-10 pr-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent ${n==="zh"?"font-chinese":""}`})]}):a.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[a.jsx(as,{className:"w-5 h-5 text-gray-600"}),a.jsx("span",{className:"text-gray-900",children:r.phone||(n==="en"?"Not provided":"未提供")})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:`block text-sm font-medium text-gray-700 mb-2 ${n==="zh"?"font-chinese":""}`,children:v[n].region}),u?a.jsxs("div",{className:"relative",children:[a.jsx(Te,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsxs("select",{value:h.region,onChange:b=>p({...h,region:b.target.value}),className:`w-full pl-10 pr-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent ${n==="zh"?"font-chinese":""}`,children:[a.jsx("option",{value:"",children:v[n].regionPlaceholder}),y.map(b=>a.jsx("option",{value:b.value,children:b.label},b.value))]})]}):a.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[a.jsx(Te,{className:"w-5 h-5 text-gray-600"}),a.jsx("span",{className:`text-gray-900 ${n==="zh"?"font-chinese":""}`,children:r.region?((C=y.find(b=>b.value===r.region))==null?void 0:C.label)||r.region:n==="en"?"Not provided":"未提供"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:`block text-sm font-medium text-gray-700 mb-2 ${n==="zh"?"font-chinese":""}`,children:v[n].memberSince}),a.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[a.jsx(mf,{className:"w-5 h-5 text-gray-600"}),a.jsx("span",{className:"text-gray-900",children:new Date(r.createdAt).toLocaleDateString(n==="zh"?"zh-CN":"en-NZ")})]})]}),r.lastLoginAt&&a.jsxs("div",{children:[a.jsx("label",{className:`block text-sm font-medium text-gray-700 mb-2 ${n==="zh"?"font-chinese":""}`,children:v[n].lastLogin}),a.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[a.jsx(gt,{className:"w-5 h-5 text-gray-600"}),a.jsx("span",{className:"text-gray-900",children:Vl(new Date(r.lastLoginAt),{addSuffix:!0})})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:`block text-sm font-medium text-gray-700 mb-2 ${n==="zh"?"font-chinese":""}`,children:v[n].favoriteProducts}),a.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[a.jsx("span",{className:"text-2xl",children:"❤️"}),a.jsxs("span",{className:"text-gray-900",children:[r.favoriteProducts.length," ",n==="en"?"products":"个商品"]})]})]})]}),a.jsxs("div",{className:"mt-8 space-y-3",children:[u?a.jsxs("div",{className:"flex space-x-3",children:[a.jsxs("button",{onClick:f,disabled:c,className:`flex-1 bg-primary-500 hover:bg-primary-600 text-white py-3 rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center ${n==="zh"?"font-chinese":""}`,children:[c?a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}):a.jsx(zv,{className:"w-5 h-5 mr-2"}),v[n].save]}),a.jsxs("button",{onClick:g,className:`flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 py-3 rounded-lg font-medium transition-colors flex items-center justify-center ${n==="zh"?"font-chinese":""}`,children:[a.jsx(us,{className:"w-5 h-5 mr-2"}),v[n].cancel]})]}):a.jsxs("button",{onClick:j,className:`w-full bg-primary-500 hover:bg-primary-600 text-white py-3 rounded-lg font-medium transition-colors flex items-center justify-center ${n==="zh"?"font-chinese":""}`,children:[a.jsx(Tv,{className:"w-5 h-5 mr-2"}),v[n].edit]}),a.jsx("button",{onClick:m,className:`w-full bg-red-100 hover:bg-red-200 text-red-700 py-3 rounded-lg font-medium transition-colors ${n==="zh"?"font-chinese":""}`,children:v[n].logout})]})]})]})})}function Dx({isOpen:e,onClose:t}){const{language:n}=Ce(),{user:r}=jn(),[s,i]=O.useState([]),[o,l]=O.useState(null),[c,u]=O.useState(""),[d,h]=O.useState("all"),[p,v]=O.useState(!1),[y,x]=O.useState(!1),[j,g]=O.useState(null),[f,m]=O.useState(!1),[w,C]=O.useState(new Set),b={en:{title:"User Management Panel",subtitle:"Manage and export user registration data",totalUsers:"Total Users",newToday:"New Today",newThisWeek:"New This Week",newThisMonth:"New This Month",searchPlaceholder:"Search users by name, email, phone...",exportJSON:"Export JSON",exportCSV:"Export CSV",refresh:"Refresh Data",dateFilter:"Date Filter",all:"All Time",today:"Today",week:"This Week",month:"This Month",usersByRegion:"Users by Region",usersByLanguage:"Users by Language",noUsers:"No users found",searchResults:"Search Results",name:"Name",email:"Email",phone:"Phone",region:"Region",language:"Language",favorites:"Favorites",registered:"Registered",lastLogin:"Last Login",never:"Never",accessDenied:"Access Denied",adminOnly:"This panel is only accessible to administrators",exportSuccess:"Data exported successfully",dataRefreshed:"Data refreshed successfully",deleteUser:"Delete User",deleteConfirm:"Delete Confirmation",deleteWarning:"Are you sure you want to delete this user? This action cannot be undone.",deleteSuccess:"User deleted successfully",deleteError:"Failed to delete user",cancel:"Cancel",delete:"Delete",cannotDeleteSelf:"Cannot delete your own account",cannotDeleteAdmin:"Cannot delete administrator account"},zh:{title:"用户管理面板",subtitle:"管理和导出用户注册数据",totalUsers:"总用户数",newToday:"今日新增",newThisWeek:"本周新增",newThisMonth:"本月新增",searchPlaceholder:"按姓名、邮箱、电话搜索用户...",exportJSON:"导出JSON",exportCSV:"导出CSV",refresh:"刷新数据",dateFilter:"日期筛选",all:"全部时间",today:"今天",week:"本周",month:"本月",usersByRegion:"按地区分布",usersByLanguage:"按语言分布",noUsers:"未找到用户",searchResults:"搜索结果",name:"姓名",email:"邮箱",phone:"电话",region:"地区",language:"语言",favorites:"收藏",registered:"注册时间",lastLogin:"最后登录",never:"从未",accessDenied:"访问被拒绝",adminOnly:"此面板仅管理员可访问",exportSuccess:"数据导出成功",dataRefreshed:"数据刷新成功",deleteUser:"删除用户",deleteConfirm:"删除确认",deleteWarning:"确定要删除此用户吗？此操作无法撤销。",deleteSuccess:"用户删除成功",deleteError:"删除用户失败",cancel:"取消",delete:"删除",cannotDeleteSelf:"无法删除自己的账户",cannotDeleteAdmin:"无法删除管理员账户"}},z=L=>{const F=new Set(w);F.has(L)?F.delete(L):F.add(L),C(F)};O.useEffect(()=>{e&&k()},[e]);const k=()=>{v(!0);try{_(),N()}catch(L){console.error("Error loading user data:",L)}finally{v(!1)}},_=async()=>{try{const{data:L,error:F}=await W.auth.admin.listUsers();F&&console.error("❌ Failed to load auth users:",F);const{data:V,error:P}=await W.from("users").select(`
          *,
          user_favorites(product_id)
        `).order("created_at",{ascending:!1});if(P)throw P;const $=V.map(I=>{var X;return{id:I.id,name:I.name,email:I.email,phone:I.phone,region:I.region,language:I.language||"en",avatar:I.avatar_url,favoriteProducts:((X=I.user_favorites)==null?void 0:X.map(vt=>vt.product_id))||[],createdAt:I.created_at,lastLoginAt:I.last_login_at}});i($),console.log("✅ 加载了",$.length,"个用户")}catch(L){console.error("Error loading users:",L)}},N=async()=>{try{const{data:L,error:F}=await W.from("users").select("*");if(F)throw F;const V=new Date,P=new Date(V.getFullYear(),V.getMonth(),V.getDate()),$=new Date(P.getTime()-7*24*60*60*1e3),I=new Date(P.getTime()-30*24*60*60*1e3),X=L.filter(_e=>new Date(_e.created_at)>=P).length,vt=L.filter(_e=>new Date(_e.created_at)>=$).length,dr=L.filter(_e=>new Date(_e.created_at)>=I).length,Le=L.reduce((_e,xt)=>{const hr=xt.region||"Unknown";return _e[hr]=(_e[hr]||0)+1,_e},{}),ys=L.reduce((_e,xt)=>{const hr=xt.language||"en";return _e[hr]=(_e[hr]||0)+1,_e},{});l({totalUsers:L.length,newUsersToday:X,newUsersThisWeek:vt,newUsersThisMonth:dr,usersByRegion:Le,usersByLanguage:ys})}catch(L){console.error("Error loading user stats:",L)}},T=()=>{k(),console.log(b[n].dataRefreshed)},Y=L=>{try{Q(L),console.log(b[n].exportSuccess)}catch(F){console.error("Export error:",F)}},Q=L=>{let F,V,P;if(L==="csv")F=[["ID","Name","Email","Phone","Region","Language","Favorite Products Count","Created At","Last Login At"].join(","),...s.map(Le=>[Le.id,`"${Le.name}"`,Le.email,Le.phone||"",Le.region||"",Le.language,Le.favoriteProducts.length,Le.createdAt,Le.lastLoginAt||""].join(","))].join(`
`),V=`upick-users-${new Date().toISOString().split("T")[0]}.csv`,P="text/csv";else{const vt={users:s,stats:o,exportDate:new Date().toISOString()};F=JSON.stringify(vt,null,2),V=`upick-users-${new Date().toISOString().split("T")[0]}.json`,P="application/json"}const $=new Blob([F],{type:P}),I=URL.createObjectURL($),X=document.createElement("a");X.href=I,X.download=V,document.body.appendChild(X),X.click(),document.body.removeChild(X),URL.revokeObjectURL(I)},K=L=>{if(r&&L.id===r.id){alert(b[n].cannotDeleteSelf);return}if(L.email==="admin@admin.com"||L.id===1){alert(b[n].cannotDeleteAdmin);return}g(L),x(!0)},S=async()=>{if(j){m(!0);try{await W.from("user_favorites").delete().eq("user_id",j.id.toString()),await W.from("shopping_list").delete().eq("user_id",j.id.toString());const{error:L}=await W.from("users").delete().eq("id",j.id.toString());if(L)throw L;try{const{error:F}=await W.auth.admin.deleteUser(j.id.toString());F&&console.warn("⚠️ Failed to delete auth user:",F)}catch(F){console.warn("⚠️ Failed to delete auth user:",F)}k(),x(!1),g(null),console.log(b[n].deleteSuccess)}catch(L){console.error("Delete error:",L),alert(b[n].deleteError)}finally{m(!1)}}},M=()=>{x(!1),g(null)},B=L=>{const F=L.toLowerCase();return s.filter(V=>V.name.toLowerCase().includes(F)||V.email.toLowerCase().includes(F)||V.phone&&V.phone.includes(F)||V.region&&V.region.toLowerCase().includes(F))},A=(L,F)=>s.filter(V=>{const P=new Date(V.createdAt);return P>=L&&P<=F}),U=()=>{let L=s;if(c&&(L=B(c)),d!=="all"){const F=new Date;let V;switch(d){case"today":V=new Date(F.getFullYear(),F.getMonth(),F.getDate());break;case"week":V=new Date(F.getTime()-7*24*60*60*1e3);break;case"month":V=new Date(F.getTime()-30*24*60*60*1e3);break;default:V=new Date(0)}L=A(V,F)}return L},E=(r==null?void 0:r.email)==="admin@upick.life"||(r==null?void 0:r.email)==="admin@admin.com"||(r==null?void 0:r.name)==="Administrator"||(r==null?void 0:r.id)===1;if(!e)return null;if(!E)return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",style:{zIndex:1e4},children:a.jsx("div",{className:"bg-white rounded-2xl max-w-md w-full p-6",children:a.jsxs("div",{className:"text-center",children:[a.jsx(Da,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),a.jsx("h3",{className:`text-xl font-semibold text-gray-900 mb-2 ${n==="zh"?"font-chinese":""}`,children:b[n].accessDenied}),a.jsx("p",{className:`text-gray-600 mb-4 ${n==="zh"?"font-chinese":""}`,children:b[n].adminOnly}),a.jsx("button",{onClick:t,className:`bg-primary-500 hover:bg-primary-600 text-white px-4 py-2 rounded-lg font-medium transition-colors ${n==="zh"?"font-chinese":""}`,children:"OK"})]})})});const G=U();return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",style:{zIndex:1e4},children:a.jsxs("div",{className:"bg-white rounded-2xl max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-[95vw] sm:max-w-6xl max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-4 sm:p-6 flex items-center justify-between rounded-t-2xl",children:[a.jsxs("div",{children:[a.jsx("h2",{className:`text-xl font-bold text-gray-900 ${n==="zh"?"font-chinese":""}`,children:b[n].title}),a.jsx("p",{className:`text-gray-600 ${n==="zh"?"font-chinese":""}`,children:b[n].subtitle})]}),a.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:a.jsx(us,{className:"w-6 h-6"})})]}),a.jsxs("div",{className:"p-4 sm:p-6",children:[o&&a.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-4 mb-4 sm:mb-6",children:[a.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(Da,{className:"w-6 h-6 sm:w-8 sm:h-8 text-blue-600"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-lg sm:text-2xl font-bold text-blue-600",children:o.totalUsers}),a.jsx("div",{className:`text-xs sm:text-sm text-blue-700 ${n==="zh"?"font-chinese":""}`,children:b[n].totalUsers})]})]})}),a.jsx("div",{className:"bg-green-50 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx($v,{className:"w-6 h-6 sm:w-8 sm:h-8 text-green-600"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-lg sm:text-2xl font-bold text-green-600",children:o.newUsersToday}),a.jsx("div",{className:`text-xs sm:text-sm text-green-700 ${n==="zh"?"font-chinese":""}`,children:b[n].newToday})]})]})}),a.jsx("div",{className:"bg-yellow-50 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(cs,{className:"w-6 h-6 sm:w-8 sm:h-8 text-yellow-600"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-lg sm:text-2xl font-bold text-yellow-600",children:o.newUsersThisWeek}),a.jsx("div",{className:`text-xs sm:text-sm text-yellow-700 ${n==="zh"?"font-chinese":""}`,children:b[n].newThisWeek})]})]})}),a.jsx("div",{className:"bg-purple-50 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(xv,{className:"w-6 h-6 sm:w-8 sm:h-8 text-purple-600"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-lg sm:text-2xl font-bold text-purple-600",children:o.newUsersThisMonth}),a.jsx("div",{className:`text-xs sm:text-sm text-purple-700 ${n==="zh"?"font-chinese":""}`,children:b[n].newThisMonth})]})]})})]}),a.jsxs("div",{className:"flex flex-col gap-3 mb-4 sm:mb-6",children:[a.jsx("div",{className:"flex-1",children:a.jsxs("div",{className:"relative",children:[a.jsx(xf,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("input",{type:"text",value:c,onChange:L=>u(L.target.value),placeholder:b[n].searchPlaceholder,className:`w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent ${n==="zh"?"font-chinese":""}`})]})}),a.jsxs("div",{className:"flex items-center space-x-2 w-full sm:w-auto",children:[a.jsx(Pv,{className:"w-5 h-5 text-gray-400"}),a.jsxs("select",{value:d,onChange:L=>h(L.target.value),className:`flex-1 sm:flex-none border border-gray-200 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-transparent ${n==="zh"?"font-chinese":""}`,children:[a.jsx("option",{value:"all",children:b[n].all}),a.jsx("option",{value:"today",children:b[n].today}),a.jsx("option",{value:"week",children:b[n].week}),a.jsx("option",{value:"month",children:b[n].month})]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[a.jsxs("button",{onClick:()=>Y("json"),className:`flex items-center justify-center space-x-2 px-3 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg text-sm font-medium transition-colors ${n==="zh"?"font-chinese":""}`,children:[a.jsx(_u,{className:"w-4 h-4"}),a.jsx("span",{children:b[n].exportJSON})]}),a.jsxs("button",{onClick:()=>Y("csv"),className:`flex items-center justify-center space-x-2 px-3 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg text-sm font-medium transition-colors ${n==="zh"?"font-chinese":""}`,children:[a.jsx(_u,{className:"w-4 h-4"}),a.jsx("span",{children:b[n].exportCSV})]}),a.jsxs("button",{onClick:T,disabled:p,className:`flex items-center justify-center space-x-2 px-3 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-lg text-sm font-medium transition-colors disabled:opacity-50 ${n==="zh"?"font-chinese":""}`,children:[a.jsx(vf,{className:`w-4 h-4 ${p?"animate-spin":""}`}),a.jsx("span",{children:b[n].refresh})]})]})]}),o&&a.jsxs("div",{className:"grid grid-cols-1 gap-4 mb-4 sm:mb-6",children:[a.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 sm:p-4",children:[a.jsxs("h3",{className:`text-base sm:text-lg font-semibold mb-3 flex items-center ${n==="zh"?"font-chinese":""}`,children:[a.jsx(Te,{className:"w-5 h-5 mr-2"}),b[n].usersByRegion]}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-1 gap-2",children:Object.entries(o.usersByRegion).map(([L,F])=>a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:`text-sm text-gray-700 ${n==="zh"?"font-chinese":""}`,children:L}),a.jsx("span",{className:"text-sm font-semibold text-gray-900",children:F})]},L))})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 sm:p-4",children:[a.jsxs("h3",{className:`text-base sm:text-lg font-semibold mb-3 flex items-center ${n==="zh"?"font-chinese":""}`,children:[a.jsx(Ho,{className:"w-5 h-5 mr-2"}),b[n].usersByLanguage]}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-1 gap-2",children:Object.entries(o.usersByLanguage).map(([L,F])=>a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:`text-sm text-gray-700 ${n==="zh"?"font-chinese":""}`,children:L==="en"?"English":"中文"}),a.jsx("span",{className:"text-sm font-semibold text-gray-900",children:F})]},L))})]})]}),a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:[a.jsx("div",{className:"px-3 sm:px-4 py-3 border-b border-gray-200 bg-gray-50",children:a.jsxs("h3",{className:`text-base sm:text-lg font-semibold ${n==="zh"?"font-chinese":""}`,children:[c?b[n].searchResults:b[n].totalUsers," (",G.length,")"]})}),G.length===0?a.jsxs("div",{className:"p-6 sm:p-8 text-center",children:[a.jsx(Da,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("p",{className:`text-gray-600 ${n==="zh"?"font-chinese":""}`,children:b[n].noUsers})]}):a.jsx("div",{className:"overflow-x-auto",children:a.jsx("div",{className:"space-y-2",children:G.map(L=>{const F=w.has(L.id);return a.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between p-3 sm:p-4 hover:bg-gray-50 cursor-pointer",onClick:()=>z(L.id),children:[a.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[a.jsx("button",{className:"flex-shrink-0",children:F?a.jsx(Wl,{className:"w-4 h-4 text-gray-500"}):a.jsx(kv,{className:"w-4 h-4 text-gray-500"})}),a.jsx("img",{src:L.avatar||"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=40",alt:L.name,className:"w-8 h-8 sm:w-10 sm:h-10 rounded-full object-cover flex-shrink-0",onError:V=>{V.currentTarget.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iIzQ4YjA0YSIgcng9IjIwIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZmlsbD0id2hpdGUiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj7nlKjmiLc8L3RleHQ+PC9zdmc+"}}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:`text-sm sm:text-base font-medium text-gray-900 truncate ${n==="zh"?"font-chinese":""}`,children:L.name}),a.jsx("div",{className:"text-xs sm:text-sm text-gray-500 truncate",children:L.email})]})]}),a.jsxs("div",{className:"flex items-center space-x-2 flex-shrink-0",children:[a.jsxs("div",{className:"text-right hidden sm:block",children:[a.jsx("div",{className:"text-xs text-gray-500",children:L.language==="en"?"EN":"中文"}),a.jsx("div",{className:"text-xs text-gray-500",children:L.region||"-"})]}),a.jsx("button",{onClick:V=>{V.stopPropagation(),K(L)},disabled:L.email==="admin@upick.life"||L.email==="admin@admin.com",className:`p-2 rounded-full transition-colors ${L.email==="admin@upick.life"||L.email==="admin@admin.com"?"text-gray-400 cursor-not-allowed":"text-red-600 hover:bg-red-100"}`,title:b[n].deleteUser,children:a.jsx(ju,{className:"w-4 h-4"})})]})]}),F&&a.jsx("div",{className:"border-t border-gray-200 bg-gray-50 p-3 sm:p-4",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("h4",{className:`text-sm font-medium text-gray-700 ${n==="zh"?"font-chinese":""}`,children:n==="en"?"Contact Information":"联系信息"}),a.jsxs("div",{className:"flex items-center space-x-2 text-xs sm:text-sm",children:[a.jsx(Pi,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),a.jsx("span",{className:"text-gray-600 truncate",children:L.email})]}),a.jsxs("div",{className:"flex items-center space-x-2 text-xs sm:text-sm",children:[a.jsx(as,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),a.jsx("span",{className:"text-gray-600",children:L.phone||(n==="en"?"Not provided":"未提供")})]}),a.jsxs("div",{className:"flex items-center space-x-2 text-xs sm:text-sm",children:[a.jsx(Te,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),a.jsx("span",{className:"text-gray-600",children:L.region||(n==="en"?"Not provided":"未提供")})]}),a.jsxs("div",{className:"flex items-center space-x-2 text-xs sm:text-sm",children:[a.jsx(Ho,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),a.jsx("span",{className:"text-gray-600",children:L.language==="en"?"English":"中文"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h4",{className:`text-sm font-medium text-gray-700 ${n==="zh"?"font-chinese":""}`,children:n==="en"?"Activity Information":"活动信息"}),a.jsxs("div",{className:"flex items-center space-x-2 text-xs sm:text-sm",children:[a.jsx(mf,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),a.jsxs("div",{children:[a.jsxs("span",{className:"text-gray-500",children:[b[n].registered,":"]}),a.jsx("span",{className:"text-gray-600 ml-1",children:new Date(L.createdAt).toLocaleDateString(n==="zh"?"zh-CN":"en-NZ")})]})]}),a.jsxs("div",{className:"flex items-center space-x-2 text-xs sm:text-sm",children:[a.jsx(gt,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),a.jsxs("div",{children:[a.jsxs("span",{className:"text-gray-500",children:[b[n].lastLogin,":"]}),a.jsx("span",{className:"text-gray-600 ml-1",children:L.lastLoginAt?new Date(L.lastLoginAt).toLocaleDateString(n==="zh"?"zh-CN":"en-NZ"):b[n].never})]})]}),a.jsxs("div",{className:"flex items-center space-x-2 text-xs sm:text-sm",children:[a.jsx(St,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),a.jsxs("div",{children:[a.jsxs("span",{className:"text-gray-500",children:[b[n].favorites,":"]}),a.jsxs("span",{className:"text-gray-600 ml-1",children:[L.favoriteProducts.length," ",n==="en"?"items":"个商品"]})]})]})]})]})})]},L.id)})})})]})]})]}),y&&j&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",style:{zIndex:10001},children:a.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-[90vw] sm:max-w-md p-4 sm:p-6",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[a.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:a.jsx(yv,{className:"w-6 h-6 text-red-600"})}),a.jsx("div",{children:a.jsx("h3",{className:`text-base sm:text-lg font-semibold text-gray-900 ${n==="zh"?"font-chinese":""}`,children:b[n].deleteConfirm})})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("p",{className:`text-sm sm:text-base text-gray-600 mb-4 ${n==="zh"?"font-chinese":""}`,children:b[n].deleteWarning}),a.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("img",{src:j.avatar||"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=40",alt:j.name,className:"w-10 h-10 rounded-full object-cover",onError:L=>{L.currentTarget.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iIzQ4YjA0YSIgcng9IjIwIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZmlsbD0id2hpdGUiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj7nlKjmiLc8L3RleHQ+PC9zdmc+"}}),a.jsxs("div",{children:[a.jsx("div",{className:`text-sm sm:text-base font-medium text-gray-900 ${n==="zh"?"font-chinese":""}`,children:j.name}),a.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:j.email})]})]})})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[a.jsx("button",{onClick:M,disabled:f,className:`flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 py-2 sm:py-3 rounded-lg text-sm font-medium transition-colors disabled:opacity-50 ${n==="zh"?"font-chinese":""}`,children:b[n].cancel}),a.jsxs("button",{onClick:S,disabled:f,className:`flex-1 bg-red-500 hover:bg-red-600 text-white py-2 sm:py-3 rounded-lg text-sm font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center ${n==="zh"?"font-chinese":""}`,children:[f?a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}):a.jsx(ju,{className:"w-5 h-5 mr-2"}),b[n].delete]})]})]})})]})})}function Ax(){const{language:e}=Ce(),{user:t,isAuthenticated:n}=jn(),[r,s]=O.useState(!1),[i,o]=O.useState(!1),[l,c]=O.useState(!1),[u,d]=O.useState(!1),h={en:{login:"Login",profile:"My Profile",favorites:"My Favorites",settings:"Settings",welcome:"Welcome",admin:"Admin Panel"},zh:{login:"登录",profile:"我的资料",favorites:"我的收藏",settings:"设置",welcome:"欢迎",admin:"管理面板"}},p=(t==null?void 0:t.email)==="admin@upick.life"||(t==null?void 0:t.email)==="admin@admin.com"||(t==null?void 0:t.name)==="Administrator",v=()=>{c(!0),s(!1)},y=()=>{window.dispatchEvent(new CustomEvent("navigateToFavorites")),s(!1)},x=()=>{d(!0),s(!1)};return n?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"relative",children:[a.jsxs("button",{onClick:()=>s(!r),className:"flex items-center space-x-2 sm:space-x-3 px-2 sm:px-3 py-2 rounded-lg bg-white shadow-sm border border-gray-200 hover:bg-gray-50 transition-colors flex-shrink-0",children:[a.jsx("img",{src:(t==null?void 0:t.avatar)||"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=40",alt:t==null?void 0:t.name,className:"w-6 h-6 sm:w-8 sm:h-8 rounded-full object-cover",onError:j=>{j.currentTarget.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iIzQ4YjA0YSIgcng9IjE2Ii8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgZmlsbD0id2hpdGUiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj7nlKjmiLc8L3RleHQ+PC9zdmc+"}}),a.jsxs("div",{className:"hidden sm:block text-left",children:[a.jsx("div",{className:`text-xs text-gray-600 ${e==="zh"?"font-chinese":""}`,children:h[e].welcome}),a.jsx("div",{className:`text-xs font-medium text-gray-900 ${e==="zh"?"font-chinese":""}`,children:t==null?void 0:t.name})]}),a.jsx(Wl,{className:`w-4 h-4 text-gray-400 transition-transform ${r?"rotate-180":""}`})]}),r&&a.jsxs("div",{className:"absolute right-0 mt-2 w-48 sm:w-56 bg-white rounded-lg shadow-lg border border-gray-200 py-2 z-50",children:[a.jsxs("div",{className:"px-4 py-3 border-b border-gray-100",children:[a.jsx("div",{className:`text-xs sm:text-sm font-medium text-gray-900 ${e==="zh"?"font-chinese":""}`,children:t==null?void 0:t.name}),a.jsx("div",{className:"text-xs text-gray-500",children:t==null?void 0:t.email})]}),a.jsxs("button",{onClick:v,className:`w-full flex items-center space-x-3 px-4 py-3 text-left hover:bg-gray-50 transition-colors ${e==="zh"?"font-chinese":""}`,children:[a.jsx(Ti,{className:"w-4 h-4 text-gray-600"}),a.jsx("span",{className:"text-xs sm:text-sm text-gray-700",children:h[e].profile})]}),a.jsxs("button",{onClick:y,className:`w-full flex items-center space-x-3 px-4 py-3 text-left hover:bg-gray-50 transition-colors ${e==="zh"?"font-chinese":""}`,children:[a.jsx(St,{className:"w-4 h-4 text-gray-600"}),a.jsxs("span",{className:"text-xs sm:text-sm text-gray-700",children:[h[e].favorites," & ",e==="en"?"Shopping List":"购物清单"]})]}),p&&a.jsxs("button",{onClick:x,className:`w-full flex items-center space-x-3 px-4 py-3 text-left hover:bg-gray-50 transition-colors ${e==="zh"?"font-chinese":""}`,children:[a.jsx(bu,{className:"w-4 h-4 text-gray-600"}),a.jsx("span",{className:"text-xs sm:text-sm text-gray-700",children:h[e].admin})]}),a.jsxs("button",{onClick:()=>s(!1),className:`w-full flex items-center space-x-3 px-4 py-3 text-left hover:bg-gray-50 transition-colors ${e==="zh"?"font-chinese":""}`,children:[a.jsx(bu,{className:"w-4 h-4 text-gray-600"}),a.jsx("span",{className:"text-xs sm:text-sm text-gray-700",children:h[e].settings})]})]}),r&&a.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>s(!1)})]}),a.jsx(Lx,{isOpen:l,onClose:()=>c(!1)}),a.jsx(Dx,{isOpen:u,onClose:()=>d(!1)})]}):a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>o(!0),className:`flex items-center space-x-1 sm:space-x-2 px-2 sm:px-4 py-2 rounded-lg bg-primary-500 hover:bg-primary-600 text-white font-medium transition-colors flex-shrink-0 ${e==="zh"?"font-chinese":""}`,children:[a.jsx(sr,{className:"w-4 h-4"}),a.jsx("span",{className:"text-xs sm:text-sm",children:h[e].login})]}),a.jsx(wf,{isOpen:i,onClose:()=>o(!1)})]})}function Ox(){const{language:e,searchTerm:t,setSearchTerm:n,refreshData:r,cleanDuplicateData:s,reduceProductsByCategory:i,isLoading:o}=Ce(),l=()=>{window.dispatchEvent(new CustomEvent("navigateToHome"))},c={en:{appName:"Upick",placeholder:"Search products...",refresh:"Refresh Data",cleanDuplicates:"Clean Duplicates",reduceProducts:"Reduce Products"},zh:{appName:"优品",placeholder:"搜索商品...",refresh:"刷新数据",cleanDuplicates:"清除重复",reduceProducts:"精简商品"}},u=async()=>{console.log("🔄 手动刷新数据..."),await r(),console.log("✅ 手动刷新完成")},d=async()=>{console.log("Cleaning duplicate data..."),await s()?(console.log("Duplicate data cleaned successfully"),await r()):console.log("Failed to clean duplicate data")},h=async()=>{console.log("Reducing products to 2 per category..."),await i()?(console.log("Products reduced successfully"),await r()):console.log("Failed to reduce products")};return a.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200 sticky top-0 z-50 w-full overflow-visible",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 w-full",children:a.jsxs("div",{className:"flex items-center justify-between h-16 gap-2 sm:gap-4",children:[a.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3 flex-shrink-0 cursor-pointer hover:opacity-80 transition-opacity",onClick:l,children:[a.jsx("div",{className:"w-10 h-10 bg-primary-500 rounded-lg flex items-center justify-center relative overflow-hidden",children:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",className:"text-white",children:a.jsx("path",{d:"M6 4v10c0 2.2 1.8 4 4 4h4c2.2 0 4-1.8 4-4V4",stroke:"currentColor",strokeWidth:"2.8",strokeLinecap:"round",fill:"none"})})}),a.jsx("div",{className:`text-xl sm:text-2xl font-bold text-primary-500 ${e==="zh"?"font-chinese":""}`,children:c[e].appName})]}),a.jsx("div",{className:"flex-1 max-w-xs sm:max-w-md mx-2 sm:mx-4 min-w-0",children:a.jsxs("div",{className:"relative",children:[a.jsx(xf,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("input",{type:"text",value:t,onChange:p=>n(p.target.value),placeholder:c[e].placeholder,className:`w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-sm sm:text-base ${e==="zh"?"font-chinese":""}`})]})}),a.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3 flex-shrink-0",children:[a.jsx("button",{onClick:u,disabled:o,className:"p-2 text-gray-600 hover:text-primary-600 hover:bg-gray-100 rounded-full transition-colors disabled:opacity-50",title:c[e].refresh,children:a.jsx(vf,{className:`w-5 h-5 ${o?"animate-spin":""}`})}),a.jsx("button",{onClick:d,disabled:o,className:"hidden sm:block px-3 py-1 text-xs text-gray-600 hover:text-primary-600 hover:bg-gray-100 rounded transition-colors disabled:opacity-50",title:c[e].cleanDuplicates,children:c[e].cleanDuplicates}),a.jsx("button",{onClick:h,disabled:o,className:"hidden sm:block px-3 py-1 text-xs text-gray-600 hover:text-primary-600 hover:bg-gray-100 rounded transition-colors disabled:opacity-50",title:c[e].reduceProducts,children:c[e].reduceProducts}),a.jsx(Iv,{}),a.jsx(Ax,{})]})]})})})}const Rx=[{id:"vegetable",icon:jv,color:"from-green-400 to-green-600",bgColor:"bg-green-50",textColor:"text-green-700"},{id:"fruit",icon:wv,color:"from-red-400 to-red-600",bgColor:"bg-red-50",textColor:"text-red-700"},{id:"meat",icon:_v,color:"from-orange-400 to-orange-600",bgColor:"bg-orange-50",textColor:"text-orange-700"},{id:"dairy",icon:Ev,color:"from-blue-400 to-blue-600",bgColor:"bg-blue-50",textColor:"text-blue-700"},{id:"seafood",icon:Sv,color:"from-purple-400 to-purple-600",bgColor:"bg-purple-50",textColor:"text-purple-700"}];function Mx({onCategoryClick:e}){const{language:t,products:n}=Ce(),r={en:{title:"Shop by Category",subtitle:"Find the best prices for your favorite products",vegetable:"Vegetables",fruit:"Fruits",meat:"Meat",dairy:"Dairy",seafood:"Seafood",products:"products"},zh:{title:"按分类购物",subtitle:"为您喜爱的商品找到最优价格",vegetable:"蔬菜",fruit:"水果",meat:"肉类",dairy:"乳制品",seafood:"海鲜",products:"种商品"}},s=i=>{const o=new Set;return n.filter(l=>l.category===i).forEach(l=>{o.add(l.name_en.toLowerCase())}),o.size};return a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("h1",{className:`text-3xl sm:text-4xl font-bold text-gray-900 mb-4 ${t==="zh"?"font-chinese":""}`,children:r[t].title}),a.jsx("p",{className:`text-lg text-gray-600 ${t==="zh"?"font-chinese":""}`,children:r[t].subtitle})]}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:Rx.map(i=>{const o=i.icon,l=s(i.id);return a.jsxs("div",{onClick:()=>e(i.id),className:`${i.bgColor} rounded-2xl p-6 cursor-pointer transition-all duration-300 hover:shadow-lg hover:scale-105 border border-gray-100`,children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("div",{className:`w-16 h-16 bg-gradient-to-br ${i.color} rounded-xl flex items-center justify-center shadow-lg`,children:a.jsx(o,{className:"w-8 h-8 text-white"})}),a.jsxs("div",{className:"text-right",children:[a.jsx("div",{className:`text-2xl font-bold ${i.textColor}`,children:l}),a.jsx("div",{className:`text-sm ${i.textColor} opacity-75 ${t==="zh"?"font-chinese":""}`,children:r[t].products})]})]}),a.jsx("h3",{className:`text-xl font-bold ${i.textColor} mb-2 ${t==="zh"?"font-chinese":""}`,children:r[t][i.id]}),a.jsx("div",{className:`text-sm ${i.textColor} opacity-75 ${t==="zh"?"font-chinese":""}`,children:t==="en"?"Compare prices across stores":"比较各超市价格"})]},i.id)})}),a.jsx("div",{className:"mt-12 bg-gradient-to-r from-primary-50 to-blue-50 rounded-2xl p-6",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-6 text-center",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-3xl font-bold text-primary-600",children:new Set(n.map(i=>i.name_en.toLowerCase())).size}),a.jsx("div",{className:`text-sm text-gray-600 ${t==="zh"?"font-chinese":""}`,children:t==="en"?"Unique Products":"种商品"})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-3xl font-bold text-blue-600",children:new Set(n.map(i=>i.supermarket_id)).size}),a.jsx("div",{className:`text-sm text-gray-600 ${t==="zh"?"font-chinese":""}`,children:t==="en"?"Supermarkets":"家超市"})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-3xl font-bold text-green-600",children:n.filter(i=>i.isSpecial).length}),a.jsx("div",{className:`text-sm text-gray-600 ${t==="zh"?"font-chinese":""}`,children:t==="en"?"Special Offers":"特价商品"})]})]})})]})}function Ux({category:e,onBack:t,onProductNameClick:n}){const{language:r,products:s}=Ce(),i={en:{back:"Back to Categories",vegetable:"Vegetables",fruit:"Fruits",meat:"Meat",dairy:"Dairy",seafood:"Seafood",lowestPrice:"Lowest Price",availableAt:"Available at",viewAllPrices:"View All Store Prices",stores:"stores",noProducts:"No products found in this category",priceUpdated:"Price updated",historicalLow:"30-day low",currentHigher:"Current price higher than 30-day low",currentIsLowest:"Current price is 30-day lowest!",and:"and",others:"others",specialOffer:"Special Offer",off:"OFF"},zh:{back:"返回分类",vegetable:"蔬菜",fruit:"水果",meat:"肉类",dairy:"乳制品",seafood:"海鲜",lowestPrice:"最低价格",availableAt:"可购买于",viewAllPrices:"查看各超市价格",stores:"家超市",noProducts:"该分类下暂无商品",priceUpdated:"价格更新于",historicalLow:"30天最低价",currentHigher:"当前价格高于30天最低价",currentIsLowest:"当前价格是近30天最低价！",and:"和",others:"等",specialOffer:"特价优惠",off:"折扣"}},o=()=>{const d=new Map;return s.filter(h=>h.category===e).forEach(h=>{const p=h.name_en.toLowerCase();if(!d.has(p))d.set(p,{name_en:h.name_en,name_zh:h.name_zh,image:h.image,minPrice:h.price,products:[h],lowestPriceStores:[h]});else{const v=d.get(p);v.products.push(h),h.price<v.minPrice?(v.minPrice=h.price,v.lowestPriceStores=[h]):h.price===v.minPrice&&v.lowestPriceStores.push(h)}}),Array.from(d.values()).sort((h,p)=>h.minPrice-p.minPrice)},l=d=>{const h=s.filter(y=>y.name_en.toLowerCase()===d.toLowerCase());return Math.min(...h.map(y=>y.price))*(.8+Math.random()*.15)},c=d=>{var h,p,v,y,x,j,g,f;if(d.length===1)return r==="en"?(h=d[0].supermarket)==null?void 0:h.name_en:(p=d[0].supermarket)==null?void 0:p.name_zh;if(d.length===2){const m=r==="en"?(v=d[0].supermarket)==null?void 0:v.name_en:(y=d[0].supermarket)==null?void 0:y.name_zh,w=r==="en"?(x=d[1].supermarket)==null?void 0:x.name_en:(j=d[1].supermarket)==null?void 0:j.name_zh;return`${m} ${i[r].and} ${w}`}else return`${r==="en"?(g=d[0].supermarket)==null?void 0:g.name_en:(f=d[0].supermarket)==null?void 0:f.name_zh} ${i[r].and} ${d.length-1} ${i[r].others}`},u=o();return a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[a.jsx("div",{className:"flex items-center mb-6",children:a.jsxs("button",{onClick:t,className:"flex items-center space-x-2 text-gray-600 hover:text-primary-600 transition-colors mr-4",children:[a.jsx(Bo,{className:"w-5 h-5"}),a.jsx("span",{className:`text-sm font-medium ${r==="zh"?"font-chinese":""}`,children:i[r].back})]})}),a.jsxs("div",{className:"mb-8",children:[a.jsx("h1",{className:`text-3xl font-bold text-gray-900 mb-2 ${r==="zh"?"font-chinese":""}`,children:i[r][e]}),a.jsxs("p",{className:`text-gray-600 ${r==="zh"?"font-chinese":""}`,children:[u.length," ",r==="en"?"products available":"种商品可选"]})]}),u.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(Ei,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),a.jsx("p",{className:`text-gray-600 ${r==="zh"?"font-chinese":""}`,children:i[r].noProducts})]}):a.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:u.map((d,h)=>{const p=l(d.name_en),v=d.minPrice<=p,y=Math.max(...d.lowestPriceStores.map(j=>new Date(j.updated_at).getTime())),x=d.lowestPriceStores.some(j=>j.isSpecial);return a.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden hover:shadow-lg hover:border-primary-200 transition-all duration-300",children:a.jsx("div",{className:"p-4 lg:p-6",children:a.jsxs("div",{className:"flex flex-col space-y-3 lg:space-y-4",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx("img",{src:d.image,alt:r==="en"?d.name_en:d.name_zh,className:"w-16 h-16 lg:w-20 lg:h-20 object-cover rounded-xl shadow-md",loading:"lazy",onError:j=>{j.currentTarget.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iODAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iI2YzZjRmNiIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTAiIGZpbGw9IiM5ZmEyYTUiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj5ObyBJbWFnZTwvdGV4dD48L3N2Zz4="}}),x&&a.jsx("div",{className:"absolute -top-1 -right-1 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center",children:a.jsx(ir,{className:"w-3 h-3"})})]}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:`text-lg lg:text-xl font-bold text-gray-900 mb-1 line-clamp-2 ${r==="zh"?"font-chinese":""}`,children:r==="en"?d.name_en:d.name_zh}),a.jsxs("div",{className:`text-sm text-gray-600 ${r==="zh"?"font-chinese":""}`,children:[d.products.length," ",i[r].stores]})]})]}),a.jsxs("div",{className:"bg-green-50 rounded-lg lg:rounded-xl p-3 lg:p-4 border border-green-200",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[a.jsx(ls,{className:"w-5 h-5 text-green-600"}),a.jsx("span",{className:`text-sm font-semibold text-green-800 ${r==="zh"?"font-chinese":""}`,children:i[r].lowestPrice})]}),a.jsxs("div",{className:"text-xl lg:text-2xl font-bold text-green-600 mb-2",children:["$",d.minPrice.toFixed(2)]}),a.jsxs("div",{className:`text-xs lg:text-sm text-green-700 mb-3 line-clamp-2 ${r==="zh"?"font-chinese":""}`,children:[i[r].availableAt," ",c(d.lowestPriceStores)]}),a.jsxs("div",{className:"border-t border-green-200 pt-3",children:[a.jsxs("div",{className:`text-xs text-gray-600 mb-1 ${r==="zh"?"font-chinese":""}`,children:[i[r].historicalLow,": $",p.toFixed(2)]}),v?a.jsxs("div",{className:`flex items-center space-x-1 text-xs text-green-600 font-semibold ${r==="zh"?"font-chinese":""}`,children:[a.jsx(ls,{className:"w-3 h-3"}),a.jsxs("span",{children:["🎉 ",i[r].currentIsLowest]})]}):a.jsxs("div",{className:`flex items-center space-x-1 text-xs text-orange-600 ${r==="zh"?"font-chinese":""}`,children:[a.jsx(cs,{className:"w-3 h-3"}),a.jsxs("span",{children:["📈 ",i[r].currentHigher," $",p.toFixed(2)]})]})]})]}),a.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[a.jsx(gt,{className:"w-4 h-4"}),a.jsxs("span",{className:r==="zh"?"font-chinese":"",children:[i[r].priceUpdated," ",new Date(y).toLocaleDateString(r==="zh"?"zh-CN":"en-NZ",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})]})]}),a.jsx("button",{onClick:()=>n(d.name_en),className:`w-full bg-primary-500 hover:bg-primary-600 text-white py-2 lg:py-3 px-4 lg:px-6 rounded-lg lg:rounded-xl font-medium transition-colors hover:shadow-md ${r==="zh"?"font-chinese":""}`,children:i[r].viewAllPrices})]})})},h)})})]})}function Fx({product:e,onClose:t}){var N,T,Y,Q,K;const{language:n,products:r}=Ce(),{user:s,isAuthenticated:i}=jn(),[o,l]=O.useState(!1),[c,u]=O.useState(!1),[d,h]=O.useState(!1),[p,v]=O.useState(!1),y=r.filter(S=>S.id!==e.id&&S.name_en.toLowerCase()===e.name_en.toLowerCase()).sort((S,M)=>S.price-M.price),j=(()=>{const S=[e,...y].map(B=>B.price);return Math.min(...S)*(.8+Math.random()*.15)})(),g=e.price<=j,f={en:{addToFavorites:"Add to Favorites",removeFromFavorites:"Remove from Favorites",addToShoppingList:"Add to Shopping List",removeFromShoppingList:"Remove from Shopping List",alreadyInShoppingList:"Already in Shopping List",loginToFavorite:"Login to Add Favorites",loginToShoppingList:"Login to Add to Shopping List",productDetails:"Product Details",origin:"Origin",freshness:"Freshness",rating:"Rating",updated:"Last Updated",compareWith:"Compare with other stores",specialOffer:"Special Offer",regularPrice:"Regular Price",youSave:"You Save",specialEnds:"Special ends",otherStores:"Available at Other Stores",favoriteAdded:"Added to favorites!",favoriteRemoved:"Removed from favorites!",favoriteError:"Failed to update favorites",shoppingListAdded:"Added to shopping list!",shoppingListRemoved:"Removed from shopping list!",shoppingListError:"Failed to update shopping list",viewOnMap:"View on Map",getDirections:"Get Directions",historicalLow:"30-day low",currentHigher:"Current price higher than 30-day low",currentIsLowest:"Current price is 30-day lowest!",priceHistory:"Price History Analysis"},zh:{addToFavorites:"添加收藏",removeFromFavorites:"取消收藏",addToShoppingList:"加入购物清单",removeFromShoppingList:"从清单中移除",alreadyInShoppingList:"已在清单中",loginToFavorite:"登录后收藏",loginToShoppingList:"登录后添加到清单",productDetails:"商品详情",origin:"产地",freshness:"新鲜度",rating:"评分",updated:"最后更新",compareWith:"与其他超市比较",specialOffer:"特价优惠",regularPrice:"原价",youSave:"节省",specialEnds:"特价结束",otherStores:"其他超市有售",favoriteAdded:"已添加到收藏！",favoriteRemoved:"已从收藏中移除！",favoriteError:"更新收藏失败",shoppingListAdded:"已加入购物清单！",shoppingListRemoved:"已从清单中移除！",shoppingListError:"更新购物清单失败",viewOnMap:"查看地图",getDirections:"获取路线",historicalLow:"30天最低价",currentHigher:"当前价格高于30天最低价",currentIsLowest:"当前价格是近30天最低价！",priceHistory:"价格历史分析"}};O.useEffect(()=>{i&&s&&(m(),w())},[i,s,e.id]);const m=async()=>{if(s)try{const{data:S,error:M}=await W.from("user_favorites").select("id").eq("user_id",s.id.toString()).eq("product_id",e.id).single();l(!!S&&!M)}catch{l(!1)}},w=async()=>{if(s)try{const{data:S,error:M}=await W.from("shopping_list").select("id").eq("user_id",s.id.toString()).eq("product_id",e.id).single();u(!!S&&!M)}catch{u(!1)}},C=async()=>{if(!(!i||!s)){h(!0);try{if(o){const{error:S}=await W.from("user_favorites").delete().eq("user_id",s.id.toString()).eq("product_id",e.id);if(S)throw S;l(!1),console.log(f[n].favoriteRemoved)}else{const{error:S}=await W.from("user_favorites").insert([{user_id:s.id.toString(),product_id:e.id}]);if(S)throw S;l(!0),console.log(f[n].favoriteAdded)}}catch(S){console.error("收藏操作失败:",S)}finally{h(!1)}}},b=async()=>{if(!(!i||!s)){v(!0);try{if(c){const{error:S}=await W.from("shopping_list").delete().eq("user_id",s.id.toString()).eq("product_id",e.id);if(S)throw S;u(!1),console.log(f[n].shoppingListRemoved)}else{const{error:S}=await W.from("shopping_list").insert([{user_id:s.id.toString(),product_id:e.id}]);if(S)throw S;u(!0),console.log(f[n].shoppingListAdded)}}catch(S){console.error("购物清单操作失败:",S)}finally{v(!1)}}},z=S=>{var M,B;if((M=S.supermarket)!=null&&M.lat&&((B=S.supermarket)!=null&&B.lng)){const A=`https://www.google.com/maps/search/?api=1&query=${S.supermarket.lat},${S.supermarket.lng}`;window.open(A,"_blank")}},k=S=>{var M,B;if((M=S.supermarket)!=null&&M.lat&&((B=S.supermarket)!=null&&B.lng)){const A=`https://www.google.com/maps/dir/?api=1&destination=${S.supermarket.lat},${S.supermarket.lng}`;window.open(A,"_blank")}},_=Vl(new Date(e.updated_at),{addSuffix:!0});return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",style:{zIndex:1e4},children:a.jsxs("div",{className:"bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-4 flex items-center justify-between rounded-t-2xl",children:[a.jsx("h2",{className:`text-xl font-bold text-gray-900 ${n==="zh"?"font-chinese":""}`,children:f[n].productDetails}),a.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:a.jsx(us,{className:"w-6 h-6"})})]}),a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"relative mb-6",children:[a.jsx("img",{src:e.image,alt:n==="en"?e.name_en:e.name_zh,className:"w-full h-64 object-cover rounded-xl bg-gray-100",loading:"lazy",onLoad:S=>{S.currentTarget.style.opacity="1"},onError:S=>{S.currentTarget.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjI2NCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjNmNGY2Ii8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzlmYTJhNSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPk5vIEltYWdlPC90ZXh0Pjwvc3ZnPg=="},style:{opacity:0,transition:"opacity 0.3s ease-in-out"}}),e.isSpecial&&a.jsxs("div",{className:"absolute top-4 left-4 bg-red-500 text-white px-3 py-1 rounded-full text-sm font-bold",children:["-",e.discount,"% OFF"]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h1",{className:`text-2xl font-bold text-gray-900 mb-3 ${n==="zh"?"font-chinese":""}`,children:n==="en"?e.name_en:e.name_zh}),a.jsx("div",{className:"bg-gray-50 rounded-xl p-4 mb-4",children:e.isSpecial?a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[a.jsxs("span",{className:"text-3xl font-bold text-red-600",children:["$",e.price]}),a.jsxs("span",{className:"text-lg text-gray-500 line-through",children:["$",e.originalPrice]}),a.jsx("span",{className:"text-sm text-gray-600",children:e.unit})]}),a.jsxs("div",{className:"flex items-center space-x-4 text-sm",children:[a.jsxs("span",{className:"text-green-600 font-semibold",children:[f[n].youSave," $",((e.originalPrice||0)-e.price).toFixed(2)]}),e.specialEndDate&&a.jsxs("span",{className:"text-orange-600",children:[f[n].specialEnds," ",new Date(e.specialEndDate).toLocaleDateString()]})]})]}):a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs("span",{className:"text-3xl font-bold text-primary-600",children:["$",e.price]}),a.jsx("span",{className:"text-sm text-gray-600",children:e.unit})]})}),a.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl p-4 mb-4",children:[a.jsx("h4",{className:`text-sm font-semibold text-gray-700 mb-2 ${n==="zh"?"font-chinese":""}`,children:f[n].priceHistory}),a.jsxs("div",{className:`text-sm text-gray-600 mb-2 ${n==="zh"?"font-chinese":""}`,children:[f[n].historicalLow,": $",j.toFixed(2)]}),g?a.jsxs("div",{className:`text-green-600 font-semibold text-sm ${n==="zh"?"font-chinese":""}`,children:["🎉 ",f[n].currentIsLowest]}):a.jsxs("div",{className:`text-orange-600 text-sm ${n==="zh"?"font-chinese":""}`,children:["📈 ",f[n].currentHigher," $",j.toFixed(2)]})]}),a.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-4 mb-4",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("img",{src:(N=e.supermarket)==null?void 0:N.logo_url,alt:(T=e.supermarket)==null?void 0:T.name_en,className:"w-10 h-10 rounded-full object-cover"}),a.jsxs("div",{children:[a.jsx("div",{className:`font-semibold text-gray-900 ${n==="zh"?"font-chinese":""}`,children:n==="en"?(Y=e.supermarket)==null?void 0:Y.name_en:(Q=e.supermarket)==null?void 0:Q.name_zh}),a.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600",children:[a.jsx(Te,{className:"w-4 h-4"}),a.jsx("span",{children:(K=e.supermarket)==null?void 0:K.location})]})]})]})}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[a.jsxs("button",{onClick:()=>z(e),className:`flex-1 flex items-center justify-center space-x-2 px-4 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors ${n==="zh"?"font-chinese":""}`,children:[a.jsx(Te,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm font-medium",children:f[n].viewOnMap})]}),a.jsxs("button",{onClick:()=>k(e),className:`flex-1 flex items-center justify-center space-x-2 px-4 py-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors ${n==="zh"?"font-chinese":""}`,children:[a.jsx(Ci,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm font-medium",children:f[n].getDirections})]})]}),a.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:a.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[a.jsx(gt,{className:"w-4 h-4"}),a.jsxs("span",{className:n==="zh"?"font-chinese":"",children:[f[n].updated," ",new Date(e.updated_at).toLocaleDateString(n==="zh"?"zh-CN":"en-NZ",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})]})]})})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mb-6",children:[i?a.jsxs("button",{onClick:C,disabled:d,className:`flex-1 flex items-center justify-center space-x-2 px-4 py-3 rounded-xl font-medium transition-colors disabled:opacity-50 ${o?"bg-red-100 text-red-700 hover:bg-red-200":"bg-gray-100 text-gray-700 hover:bg-gray-200"} ${n==="zh"?"font-chinese":""}`,children:[d?a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-current"}):a.jsx(St,{className:`w-5 h-5 ${o?"fill-current":""}`}),a.jsx("span",{children:o?f[n].removeFromFavorites:f[n].addToFavorites})]}):a.jsxs("button",{onClick:()=>{},className:`flex-1 flex items-center justify-center space-x-2 px-4 py-3 rounded-xl font-medium transition-colors bg-primary-100 text-primary-700 hover:bg-primary-200 ${n==="zh"?"font-chinese":""}`,children:[a.jsx(sr,{className:"w-5 h-5"}),a.jsx("span",{children:f[n].loginToFavorite})]}),i?a.jsxs("button",{onClick:b,disabled:p,className:`flex-1 flex items-center justify-center space-x-2 px-4 py-3 rounded-xl font-medium transition-colors disabled:opacity-50 ${c?"bg-orange-100 text-orange-700 hover:bg-orange-200":"bg-primary-100 text-primary-700 hover:bg-primary-200"} ${n==="zh"?"font-chinese":""}`,children:[p?a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-current"}):c?a.jsx(pf,{className:"w-5 h-5"}):a.jsx(Zl,{className:"w-5 h-5"}),a.jsx("span",{children:c?f[n].alreadyInShoppingList:f[n].addToShoppingList})]}):a.jsxs("button",{onClick:()=>{},className:`flex-1 flex items-center justify-center space-x-2 px-4 py-3 rounded-xl font-medium transition-colors bg-primary-100 text-primary-700 hover:bg-primary-200 ${n==="zh"?"font-chinese":""}`,children:[a.jsx(sr,{className:"w-5 h-5"}),a.jsx("span",{children:f[n].loginToShoppingList})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.origin&&a.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[a.jsx(is,{className:"w-5 h-5 text-gray-600"}),a.jsxs("div",{children:[a.jsx("div",{className:`text-sm text-gray-600 ${n==="zh"?"font-chinese":""}`,children:f[n].origin}),a.jsx("div",{className:"font-semibold",children:e.origin})]})]}),e.freshness&&a.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[a.jsx(hf,{className:"w-5 h-5 text-gray-600"}),a.jsxs("div",{children:[a.jsx("div",{className:`text-sm text-gray-600 ${n==="zh"?"font-chinese":""}`,children:f[n].freshness}),a.jsx("div",{className:"font-semibold",children:e.freshness})]})]}),e.rating&&a.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[a.jsx(os,{className:"w-5 h-5 text-yellow-500 fill-current"}),a.jsxs("div",{children:[a.jsx("div",{className:`text-sm text-gray-600 ${n==="zh"?"font-chinese":""}`,children:f[n].rating}),a.jsxs("div",{className:"font-semibold",children:[e.rating,"/5"]})]})]}),a.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[a.jsx(gt,{className:"w-5 h-5 text-gray-600"}),a.jsxs("div",{children:[a.jsx("div",{className:`text-sm text-gray-600 ${n==="zh"?"font-chinese":""}`,children:f[n].updated}),a.jsx("div",{className:"font-semibold",children:_})]})]})]}),y.length>0&&a.jsxs("div",{children:[a.jsxs("h3",{className:`text-lg font-semibold mb-4 ${n==="zh"?"font-chinese":""}`,children:[f[n].otherStores," (",y.length,")"]}),a.jsx("div",{className:"space-y-3",children:y.map(S=>{var M,B,A,U,E;return a.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("img",{src:(M=S.supermarket)==null?void 0:M.logo_url,alt:(B=S.supermarket)==null?void 0:B.name_en,className:"w-8 h-8 rounded-full object-cover"}),a.jsxs("div",{children:[a.jsx("div",{className:`font-semibold text-gray-900 ${n==="zh"?"font-chinese":""}`,children:n==="en"?(A=S.supermarket)==null?void 0:A.name_en:(U=S.supermarket)==null?void 0:U.name_zh}),a.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600",children:[a.jsx(Te,{className:"w-4 h-4"}),a.jsx("span",{children:(E=S.supermarket)==null?void 0:E.location})]})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("div",{className:"text-xl font-bold text-gray-900",children:["$",S.price]}),a.jsx("div",{className:"text-sm text-gray-500",children:S.unit})]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{onClick:()=>z(S),className:`flex-1 flex items-center justify-center space-x-2 px-3 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors ${n==="zh"?"font-chinese":""}`,children:[a.jsx(Te,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm",children:f[n].viewOnMap})]}),a.jsxs("button",{onClick:()=>k(S),className:`flex-1 flex items-center justify-center space-x-2 px-3 py-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors ${n==="zh"?"font-chinese":""}`,children:[a.jsx(Ci,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm",children:f[n].getDirections})]})]}),a.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:a.jsxs("div",{className:"flex items-center space-x-1 text-xs text-gray-500",children:[a.jsx(gt,{className:"w-3 h-3"}),a.jsxs("span",{className:n==="zh"?"font-chinese":"",children:[f[n].updated," ",new Date(S.updated_at).toLocaleDateString(n==="zh"?"zh-CN":"en-NZ",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})]})]})})]},S.id)})})]})]})]})})}function Bx({activeTab:e,onTabChange:t}){const{language:n}=Ce(),r=[{id:"home",icon:Cv,label:{en:"Home",zh:"首页"}},{id:"specials",icon:ir,label:{en:"Specials",zh:"特价"}},{id:"compare",icon:ff,label:{en:"Compare",zh:"比价"}},{id:"map",icon:Te,label:{en:"Map",zh:"地图"}},{id:"favorites",icon:St,label:{en:"Favorites",zh:"收藏"}}];return a.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 z-40 w-full max-w-full pb-safe",children:a.jsx("div",{className:"w-full lg:max-w-7xl lg:mx-auto",children:a.jsx("div",{className:"flex items-center justify-around py-3 lg:justify-center lg:space-x-6 w-full max-w-full overflow-x-hidden",children:r.map(s=>{const i=s.icon,o=e===s.id;return a.jsxs("button",{onClick:()=>t(s.id),className:`flex flex-col items-center px-2 py-1 rounded-lg transition-colors min-w-0 lg:min-w-[100px] ${o?"text-primary-600 bg-primary-50 shadow-sm":"text-gray-500 hover:text-primary-600 hover:bg-gray-50"}`,children:[a.jsx(i,{className:"w-6 h-6 mb-1 lg:w-7 lg:h-7"}),a.jsx("span",{className:`text-xs font-medium leading-none lg:text-sm ${n==="zh"?"font-chinese":""}`,children:s.label[n]})]},s.id)})})})})}function Hx({onProductClick:e,onLoginClick:t}){const{language:n,products:r}=Ce(),{user:s,isAuthenticated:i}=jn(),[o,l]=O.useState([]),[c,u]=O.useState([]),[d,h]=O.useState(!1),[p,v]=O.useState("favorites"),y={en:{title:"My Favorites",shoppingListTitle:"My Shopping List",subtitle:"Your saved products",shoppingSubtitle:"Products in your shopping list",noFavorites:"No favorite products yet",noShoppingList:"Your shopping list is empty",startBrowsing:"Start browsing to add favorites",startShopping:"Start browsing to add products",loginRequired:"Login Required",loginToView:"Please login to view your favorite products",loginToViewShopping:"Please login to view your shopping list",loginButton:"Login Now",loading:"Loading...",viewDetails:"View Details",removeFromFavorites:"Remove from Favorites",removeFromShoppingList:"Remove from Shopping List",addedOn:"Added on",favorites:"Favorites",shoppingList:"Shopping List"},zh:{title:"我的收藏",shoppingListTitle:"我的购物清单",subtitle:"您保存的商品",shoppingSubtitle:"购物清单中的商品",noFavorites:"暂无收藏商品",noShoppingList:"购物清单为空",startBrowsing:"开始浏览并添加收藏",startShopping:"开始浏览并添加商品",loginRequired:"需要登录",loginToView:"请登录查看您的收藏商品",loginToViewShopping:"请登录查看您的购物清单",loginButton:"立即登录",loading:"加载中...",viewDetails:"查看详情",removeFromFavorites:"取消收藏",removeFromShoppingList:"从清单中移除",addedOn:"添加于",favorites:"收藏",shoppingList:"购物清单"}};O.useEffect(()=>{i&&s?x():(l([]),u([]))},[i,s]),O.useEffect(()=>{const _=()=>{i&&s&&j()},N=()=>{i&&s&&g()};return window.addEventListener("favoritesUpdated",_),window.addEventListener("shoppingListUpdated",N),()=>{window.removeEventListener("favoritesUpdated",_),window.removeEventListener("shoppingListUpdated",N)}},[i,s]),O.useEffect(()=>{i&&s?x():(l([]),u([]))},[i,s]);const x=async()=>{h(!0);try{await Promise.all([j(),g()])}catch(_){console.error("加载用户数据失败:",_)}finally{h(!1)}},j=async()=>{if(s)try{const{data:_,error:N}=await W.from("user_favorites").select(`
          product_id,
          created_at,
          products (
            *,
            supermarket:supermarkets(*)
          )
        `).eq("user_id",s.id.toString()).order("created_at",{ascending:!1});if(N)throw N;l(_||[]),console.log("✅ 加载用户收藏:",(_==null?void 0:_.length)||0,"个商品")}catch(_){console.error("加载收藏失败:",_)}},g=async()=>{if(s)try{const{data:_,error:N}=await W.from("shopping_list").select(`
          product_id,
          added_at,
          products (
            *,
            supermarket:supermarkets(*)
          )
        `).eq("user_id",s.id.toString()).order("added_at",{ascending:!1});if(N)throw N;u(_||[]),console.log("✅ 加载购物清单:",(_==null?void 0:_.length)||0,"个商品")}catch(_){console.error("加载购物清单失败:",_)}},f=async _=>{if(s)try{const{error:N}=await W.from("user_favorites").delete().eq("user_id",s.id.toString()).eq("product_id",_);if(N)throw N;l(T=>T.filter(Y=>Y.product_id!==_)),console.log("✅ 已从收藏中移除"),window.dispatchEvent(new CustomEvent("favoritesUpdated"))}catch(N){console.error("移除收藏失败:",N)}},m=async _=>{if(s)try{const{error:N}=await W.from("shopping_list").delete().eq("user_id",s.id.toString()).eq("product_id",_);if(N)throw N;u(T=>T.filter(Y=>Y.product_id!==_)),console.log("✅ 已从购物清单中移除"),window.dispatchEvent(new CustomEvent("shoppingListUpdated"))}catch(N){console.error("移除购物清单失败:",N)}};if(!i)return a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"w-16 h-16 bg-primary-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(sr,{className:"w-8 h-8 text-primary-600"})}),a.jsx("h3",{className:`text-xl font-semibold text-gray-900 mb-2 ${n==="zh"?"font-chinese":""}`,children:y[n].loginRequired}),a.jsx("p",{className:`text-gray-600 mb-6 ${n==="zh"?"font-chinese":""}`,children:p==="favorites"?y[n].loginToView:y[n].loginToViewShopping}),a.jsx("button",{onClick:t,className:`bg-primary-500 hover:bg-primary-600 text-white px-6 py-3 rounded-lg font-medium transition-colors ${n==="zh"?"font-chinese":""}`,children:y[n].loginButton})]});if(d)return a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-500 mx-auto mb-4"}),a.jsx("p",{className:`text-gray-600 ${n==="zh"?"font-chinese":""}`,children:y[n].loading})]});const w=p==="favorites"?o:c,C=p==="favorites"?y[n].title:y[n].shoppingListTitle,b=p==="favorites"?y[n].subtitle:y[n].shoppingSubtitle,z=p==="favorites"?y[n].noFavorites:y[n].noShoppingList,k=p==="favorites"?y[n].startBrowsing:y[n].startShopping;return a.jsxs("div",{children:[a.jsxs("div",{className:"flex space-x-1 mb-6 bg-gray-100 rounded-xl p-1",children:[a.jsxs("button",{onClick:()=>v("favorites"),className:`flex-1 flex items-center justify-center space-x-2 py-3 px-4 rounded-lg font-medium transition-colors ${p==="favorites"?"bg-white text-primary-600 shadow-sm":"text-gray-600 hover:text-gray-900"} ${n==="zh"?"font-chinese":""}`,children:[a.jsx(St,{className:"w-5 h-5"}),a.jsx("span",{children:y[n].favorites}),a.jsx("span",{className:"bg-gray-200 text-gray-700 px-2 py-1 rounded-full text-xs",children:o.length})]}),a.jsxs("button",{onClick:()=>v("shopping"),className:`flex-1 flex items-center justify-center space-x-2 py-3 px-4 rounded-lg font-medium transition-colors ${p==="shopping"?"bg-white text-primary-600 shadow-sm":"text-gray-600 hover:text-gray-900"} ${n==="zh"?"font-chinese":""}`,children:[a.jsx(Ei,{className:"w-5 h-5"}),a.jsx("span",{children:y[n].shoppingList}),a.jsx("span",{className:"bg-gray-200 text-gray-700 px-2 py-1 rounded-full text-xs",children:c.length})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h1",{className:`text-2xl font-bold text-gray-900 mb-1 ${n==="zh"?"font-chinese":""}`,children:C}),a.jsxs("p",{className:`text-gray-600 ${n==="zh"?"font-chinese":""}`,children:[b," (",w.length," ",n==="en"?"items":"个商品",")"]})]}),w.length===0?a.jsxs("div",{className:"text-center py-12",children:[p==="favorites"?a.jsx(St,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}):a.jsx(is,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:`text-xl font-semibold text-gray-600 mb-2 ${n==="zh"?"font-chinese":""}`,children:z}),a.jsx("p",{className:`text-gray-500 ${n==="zh"?"font-chinese":""}`,children:k})]}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:w.map(_=>{var T,Y,Q,K;const N=_.products;return N?a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden hover:shadow-md hover:border-primary-200 transition-all cursor-pointer group",children:[a.jsxs("div",{className:"relative",children:[a.jsx("img",{src:N.image_url,alt:n==="en"?N.name_en:N.name_zh,className:"w-full h-48 object-cover group-hover:scale-105 transition-transform duration-300 bg-gray-100",loading:"lazy",onLoad:S=>{S.currentTarget.style.opacity="1"},onError:S=>{S.currentTarget.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjNmNGY2Ii8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzlmYTJhNSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPk5vIEltYWdlPC90ZXh0Pjwvc3ZnPg=="},style:{opacity:0,transition:"opacity 0.3s ease-in-out"}}),N.is_special&&a.jsxs("div",{className:"absolute top-3 left-3 bg-red-500 text-white px-2 py-1 rounded-full text-xs font-bold",children:["-",N.discount_percentage,"% OFF"]}),a.jsx("div",{className:`absolute top-3 right-3 p-2 rounded-full ${p==="favorites"?"bg-red-500":"bg-blue-500"} text-white`,children:p==="favorites"?a.jsx(St,{className:"w-4 h-4 fill-current"}):a.jsx(Ei,{className:"w-4 h-4"})})]}),a.jsxs("div",{className:"p-4",children:[a.jsx("h3",{className:`font-semibold text-gray-900 mb-2 line-clamp-2 ${n==="zh"?"font-chinese":""}`,children:n==="en"?N.name_en:N.name_zh}),a.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[a.jsxs("span",{className:"text-2xl font-bold text-primary-600",children:["$",parseFloat(N.price).toFixed(2)]}),N.original_price&&a.jsxs("span",{className:"text-sm text-gray-500 line-through",children:["$",parseFloat(N.original_price).toFixed(2)]}),a.jsx("span",{className:"text-sm text-gray-500",children:N.unit})]}),a.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[a.jsx("img",{src:(T=N.supermarket)==null?void 0:T.logo_url,alt:(Y=N.supermarket)==null?void 0:Y.name_en,className:"w-5 h-5 rounded-full object-cover"}),a.jsx("span",{className:`text-sm text-gray-600 ${n==="zh"?"font-chinese":""}`,children:n==="en"?(Q=N.supermarket)==null?void 0:Q.name_en:(K=N.supermarket)==null?void 0:K.name_zh})]}),a.jsxs("div",{className:"text-xs text-gray-400 mb-3",children:[y[n].addedOn," ",new Date(p==="favorites"?_.created_at:_.added_at).toLocaleDateString(n==="zh"?"zh-CN":"en-NZ")]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>{const S={id:N.id,name_en:N.name_en,name_zh:N.name_zh,image:N.image_url||"",price:parseFloat(N.price),originalPrice:N.original_price?parseFloat(N.original_price):void 0,unit:N.unit,supermarket_id:N.supermarket_id,supermarket:N.supermarket?{id:N.supermarket.id,name_en:N.supermarket.name_en,name_zh:N.supermarket.name_zh,location:N.supermarket.location,logo_url:N.supermarket.logo_url||"",lat:parseFloat(N.supermarket.latitude),lng:parseFloat(N.supermarket.longitude),phone:N.supermarket.phone,hours:N.supermarket.hours,rating:N.supermarket.rating?parseFloat(N.supermarket.rating):void 0}:void 0,category:N.category,updated_at:N.updated_at,isSpecial:N.is_special,specialEndDate:N.special_end_date,discount:N.discount_percentage,origin:N.origin,freshness:N.freshness,rating:N.rating?parseFloat(N.rating):void 0};e(S)},className:`flex-1 bg-primary-500 hover:bg-primary-600 text-white py-2 px-3 rounded-lg font-medium transition-colors text-sm ${n==="zh"?"font-chinese":""}`,children:y[n].viewDetails}),a.jsx("button",{onClick:()=>{p==="favorites"?f(_.product_id):m(_.product_id)},className:`px-3 py-2 bg-red-100 text-red-600 hover:bg-red-200 rounded-lg transition-colors ${n==="zh"?"font-chinese":""}`,title:p==="favorites"?y[n].removeFromFavorites:y[n].removeFromShoppingList,children:p==="favorites"?a.jsx(St,{className:"w-4 h-4"}):a.jsx(is,{className:"w-4 h-4"})})]})]})]},_.product_id):null})})]})}function Wx(){const{language:e,products:t,supermarkets:n}=Ce(),[r,s]=O.useState(new Set),i={en:{title:"Price Comparison",subtitle:"Compare prices across different supermarkets",selectProducts:"Select products to compare",noComparison:"No products selected for comparison",addProducts:"Add products to start comparing prices",cheapest:"Cheapest",mostExpensive:"Most Expensive",averagePrice:"Average Price",priceRange:"Price Range",viewDetails:"View Details",hideDetails:"Hide Details",specialOffers:"Special Offers",stores:"stores",updated:"Updated",rating:"Rating",origin:"Origin",freshness:"Freshness",youSave:"You Save",regularPrice:"Regular Price",specialPrice:"Special Price",endingSoon:"Ending Soon",productsCompared:"Products Compared",totalSupermarkets:"Supermarkets",maxSavings:"Max Savings",bestDeals:"Best Deals Available",about:"about",ago:"ago",hours:"hours"},zh:{title:"价格比较",subtitle:"比较不同超市的商品价格",selectProducts:"选择要比较的商品",noComparison:"没有选择比较商品",addProducts:"添加商品开始比价",cheapest:"最便宜",mostExpensive:"最贵",averagePrice:"平均价格",priceRange:"价格区间",viewDetails:"查看详情",hideDetails:"隐藏详情",specialOffers:"特价商品",stores:"超市",updated:"更新于",rating:"评分",origin:"产地",freshness:"新鲜度",youSave:"节省",regularPrice:"原价",specialPrice:"特价",endingSoon:"即将结束",productsCompared:"比较商品数",totalSupermarkets:"超市数量",maxSavings:"最大节省",bestDeals:"最佳优惠",about:"约",ago:"前",hours:"小时"}},o=t.reduce((u,d)=>{const h=d.name_en.toLowerCase().trim();return u[h]||(u[h]=[]),u[h].push(d),u},{}),l=Object.entries(o).filter(([u,d])=>d.length>1).sort(([u,d],[h,p])=>p.length-d.length).slice(0,12),c=u=>{const d=new Set(r);d.has(u)?d.delete(u):d.add(u),s(d)};return l.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(ff,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:`text-xl font-semibold text-gray-600 mb-2 ${e==="zh"?"font-chinese":""}`,children:i[e].noComparison}),a.jsx("p",{className:`text-gray-500 ${e==="zh"?"font-chinese":""}`,children:i[e].addProducts})]}):a.jsxs("div",{children:[a.jsxs("div",{className:"mb-6 sm:mb-8",children:[a.jsx("h1",{className:`text-2xl sm:text-3xl font-bold text-gray-900 mb-2 ${e==="zh"?"font-chinese":""}`,children:i[e].title}),a.jsx("p",{className:`text-base sm:text-lg text-gray-600 ${e==="zh"?"font-chinese":""}`,children:i[e].subtitle})]}),a.jsx("div",{className:"space-y-6 sm:space-y-8",children:l.map(([u,d])=>{var m,w,C,b,z,k,_,N;const h=d.map(T=>T.price),p=Math.min(...h),v=Math.max(...h),y=h.reduce((T,Y)=>T+Y,0)/h.length,x=d.find(T=>T.price===p),j=d.find(T=>T.price===v),g=d.filter(T=>T.isSpecial),f=r.has(u);return a.jsxs("div",{className:"bg-white rounded-xl sm:rounded-2xl border border-gray-200 shadow-sm sm:shadow-lg overflow-hidden",children:[a.jsx("div",{className:"bg-gradient-to-r from-primary-50 to-blue-50 p-4 sm:p-6 border-b border-gray-200",children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-4 sm:space-y-0 sm:space-x-6",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("div",{className:"relative flex-shrink-0",children:[a.jsx("img",{src:d[0].image,alt:d[0].name_en,className:"w-16 h-16 sm:w-24 sm:h-24 object-cover rounded-lg sm:rounded-xl bg-gray-100 shadow-md",loading:"lazy",onLoad:T=>{T.currentTarget.style.opacity="1"},onError:T=>{T.currentTarget.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOTYiIGhlaWdodD0iOTYiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iI2YzZjRmNiIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTAiIGZpbGw9IiM5ZmEyYTUiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj5ObyBJbWFnZTwvdGV4dD48L3N2Zz4="},style:{opacity:0,transition:"opacity 0.3s ease-in-out"}}),g.length>0&&a.jsx("div",{className:"absolute -top-1 -right-1 bg-red-500 text-white rounded-full w-5 h-5 sm:w-6 sm:h-6 flex items-center justify-center text-xs font-bold",children:g.length})]}),a.jsx("div",{className:"flex-1 min-w-0",children:a.jsx("h2",{className:`text-lg sm:text-2xl font-bold text-gray-900 mb-1 sm:mb-2 line-clamp-2 ${e==="zh"?"font-chinese":""}`,children:e==="en"?d[0].name_en:d[0].name_zh})})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-4 text-xs sm:text-sm text-gray-600",children:[a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(Ei,{className:"w-3 h-3 sm:w-4 sm:h-4"}),a.jsxs("span",{children:[d.length," ",i[e].stores]})]}),a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(yf,{className:"w-3 h-3 sm:w-4 sm:h-4"}),a.jsxs("span",{children:["$",p.toFixed(2)," - $",v.toFixed(2)]})]}),g.length>0&&a.jsxs("div",{className:"flex items-center space-x-1 text-red-600",children:[a.jsx(ir,{className:"w-3 h-3 sm:w-4 sm:h-4"}),a.jsxs("span",{children:[g.length," ",i[e].specialOffers]})]})]})]})}),a.jsx("div",{className:"p-4 sm:p-6 border-b border-gray-100",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-6",children:[a.jsxs("div",{className:"bg-green-50 rounded-lg sm:rounded-xl p-3 sm:p-4 border border-green-200",children:[a.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3 mb-2 sm:mb-3",children:[a.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-green-500 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx(ls,{className:"w-4 h-4 sm:w-5 sm:h-5 text-white"})}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("div",{className:`text-xs sm:text-sm font-semibold text-green-800 ${e==="zh"?"font-chinese":""}`,children:i[e].cheapest}),a.jsxs("div",{className:"text-xl sm:text-3xl font-bold text-green-600",children:["$",p.toFixed(2)]})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("img",{src:(m=x==null?void 0:x.supermarket)==null?void 0:m.logo_url,alt:(w=x==null?void 0:x.supermarket)==null?void 0:w.name_en,className:"w-4 h-4 sm:w-5 sm:h-5 rounded-full object-cover flex-shrink-0"}),a.jsx("span",{className:`text-xs sm:text-sm text-green-700 font-medium truncate ${e==="zh"?"font-chinese":""}`,children:e==="en"?(C=x==null?void 0:x.supermarket)==null?void 0:C.name_en:(b=x==null?void 0:x.supermarket)==null?void 0:b.name_zh})]})]}),a.jsxs("div",{className:"bg-blue-50 rounded-lg sm:rounded-xl p-3 sm:p-4 border border-blue-200",children:[a.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3 mb-2 sm:mb-3",children:[a.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-blue-500 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx(gf,{className:"w-4 h-4 sm:w-5 sm:h-5 text-white"})}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("div",{className:`text-xs sm:text-sm font-semibold text-blue-800 ${e==="zh"?"font-chinese":""}`,children:i[e].averagePrice}),a.jsxs("div",{className:"text-xl sm:text-3xl font-bold text-blue-600",children:["$",y.toFixed(2)]})]})]}),a.jsxs("div",{className:`text-xs sm:text-sm text-blue-700 ${e==="zh"?"font-chinese":""}`,children:[d.length," ",i[e].stores]})]}),a.jsxs("div",{className:"bg-red-50 rounded-lg sm:rounded-xl p-3 sm:p-4 border border-red-200",children:[a.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3 mb-2 sm:mb-3",children:[a.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-red-500 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx(cs,{className:"w-4 h-4 sm:w-5 sm:h-5 text-white"})}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("div",{className:`text-xs sm:text-sm font-semibold text-red-800 ${e==="zh"?"font-chinese":""}`,children:i[e].mostExpensive}),a.jsxs("div",{className:"text-xl sm:text-3xl font-bold text-red-600",children:["$",v.toFixed(2)]})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("img",{src:(z=j==null?void 0:j.supermarket)==null?void 0:z.logo_url,alt:(k=j==null?void 0:j.supermarket)==null?void 0:k.name_en,className:"w-4 h-4 sm:w-5 sm:h-5 rounded-full object-cover flex-shrink-0"}),a.jsx("span",{className:`text-xs sm:text-sm text-red-700 font-medium truncate ${e==="zh"?"font-chinese":""}`,children:e==="en"?(_=j==null?void 0:j.supermarket)==null?void 0:_.name_en:(N=j==null?void 0:j.supermarket)==null?void 0:N.name_zh})]})]})]})}),a.jsx("div",{className:"block sm:hidden p-4 border-b border-gray-100",children:a.jsxs("button",{onClick:()=>c(u),className:`w-full flex items-center justify-center space-x-2 py-3 px-4 rounded-lg font-medium transition-colors ${f?"bg-primary-100 text-primary-700 border-2 border-primary-200":"bg-gray-100 text-gray-700 hover:bg-gray-200 border-2 border-gray-200"} ${e==="zh"?"font-chinese":""}`,children:[a.jsx(Xs,{className:"w-5 h-5"}),a.jsx("span",{children:f?i[e].hideDetails:i[e].viewDetails}),f?a.jsx(Nv,{className:"w-5 h-5"}):a.jsx(Wl,{className:"w-5 h-5"})]})}),a.jsxs("div",{className:`${f?"block":"hidden"} sm:block p-4 sm:p-6`,children:[a.jsx("h3",{className:`text-base sm:text-lg font-semibold mb-3 sm:mb-4 hidden sm:block ${e==="zh"?"font-chinese":""}`,children:i[e].viewDetails}),a.jsx("div",{className:"space-y-3 sm:space-y-4",children:d.sort((T,Y)=>T.price-Y.price).map(T=>{var Y,Q,K,S,M,B,A,U,E,G;return a.jsxs("div",{className:`flex flex-col sm:flex-row sm:items-center sm:justify-between p-3 sm:p-4 rounded-lg sm:rounded-xl border-2 transition-all ${T.price===p?"border-green-200 bg-green-50":T.isSpecial?"border-red-200 bg-red-50":"border-gray-200 bg-gray-50"}`,children:[a.jsxs("div",{className:"flex items-center justify-between sm:hidden mb-3",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs("div",{className:"relative",children:[a.jsx("img",{src:(Y=T.supermarket)==null?void 0:Y.logo_url,alt:(Q=T.supermarket)==null?void 0:Q.name_en,className:"w-10 h-10 rounded-full object-cover border-2 border-white shadow-sm"}),T.price===p&&a.jsx("div",{className:"absolute -top-1 -right-1 bg-green-500 text-white rounded-full w-4 h-4 flex items-center justify-center text-xs font-bold",children:"✓"})]}),a.jsxs("div",{children:[a.jsx("div",{className:`font-semibold text-gray-900 text-sm ${e==="zh"?"font-chinese":""}`,children:e==="en"?(K=T.supermarket)==null?void 0:K.name_en:(S=T.supermarket)==null?void 0:S.name_zh}),a.jsxs("div",{className:"flex items-center space-x-1 text-xs text-gray-600",children:[a.jsx(Te,{className:"w-3 h-3"}),a.jsx("span",{children:(M=T.supermarket)==null?void 0:M.location})]})]})]}),a.jsx("div",{className:"text-right",children:T.isSpecial?a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[a.jsxs("span",{className:"text-xl font-bold text-red-600",children:["$",T.price]}),a.jsxs("span",{className:"text-xs text-gray-500 line-through",children:["$",T.originalPrice]})]}),a.jsx("div",{className:"flex items-center justify-end space-x-1",children:a.jsxs("span",{className:"bg-red-500 text-white px-2 py-1 rounded-full text-xs font-bold",children:["-",T.discount,"%"]})})]}):a.jsxs("div",{children:[a.jsxs("div",{className:"text-xl font-bold text-gray-900",children:["$",T.price]}),a.jsx("div",{className:"text-xs text-gray-500",children:T.unit})]})})]}),a.jsxs("div",{className:"sm:hidden",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-xs text-gray-600 mb-2",children:[a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(gt,{className:"w-3 h-3"}),a.jsxs("span",{children:[i[e].about," ",Math.round((Date.now()-new Date(T.updated_at).getTime())/(1e3*60*60))," ",i[e].hours," ",i[e].ago]})]}),T.rating&&a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(os,{className:"w-3 h-3 fill-yellow-400 text-yellow-400"}),a.jsx("span",{children:T.rating})]})]}),(T.origin||T.freshness)&&a.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-xs text-gray-500",children:[T.origin&&a.jsxs("span",{children:[i[e].origin,": ",T.origin]}),T.freshness&&a.jsxs("span",{children:[i[e].freshness,": ",T.freshness]})]}),T.isSpecial&&a.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2 text-xs",children:[a.jsxs("span",{className:"text-green-600 font-semibold",children:[i[e].youSave," $",((T.originalPrice||0)-T.price).toFixed(2)]}),T.specialEndDate&&a.jsx("span",{className:"text-orange-600",children:i[e].endingSoon})]})]}),a.jsxs("div",{className:"hidden sm:flex sm:items-center sm:space-x-4 sm:flex-1",children:[a.jsxs("div",{className:"relative",children:[a.jsx("img",{src:(B=T.supermarket)==null?void 0:B.logo_url,alt:(A=T.supermarket)==null?void 0:A.name_en,className:"w-12 h-12 rounded-full object-cover border-2 border-white shadow-sm"}),T.price===p&&a.jsx("div",{className:"absolute -top-1 -right-1 bg-green-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs font-bold",children:"✓"})]}),a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:`font-semibold text-gray-900 ${e==="zh"?"font-chinese":""}`,children:e==="en"?(U=T.supermarket)==null?void 0:U.name_en:(E=T.supermarket)==null?void 0:E.name_zh}),a.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(Te,{className:"w-3 h-3"}),a.jsx("span",{children:(G=T.supermarket)==null?void 0:G.location})]}),a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(gt,{className:"w-3 h-3"}),a.jsx("span",{children:Vl(new Date(T.updated_at),{addSuffix:!0})})]}),T.rating&&a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(os,{className:"w-3 h-3 fill-yellow-400 text-yellow-400"}),a.jsx("span",{children:T.rating})]})]}),(T.origin||T.freshness)&&a.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500 mt-1",children:[T.origin&&a.jsxs("span",{children:[i[e].origin,": ",T.origin]}),T.freshness&&a.jsxs("span",{children:[i[e].freshness,": ",T.freshness]})]})]})]}),a.jsx("div",{className:"hidden sm:block text-right",children:T.isSpecial?a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[a.jsxs("span",{className:"text-2xl font-bold text-red-600",children:["$",T.price]}),a.jsxs("span",{className:"text-sm text-gray-500 line-through",children:["$",T.originalPrice]})]}),a.jsxs("div",{className:"flex items-center space-x-2 text-xs",children:[a.jsxs("span",{className:"bg-red-500 text-white px-2 py-1 rounded-full font-bold",children:["-",T.discount,"%"]}),a.jsxs("span",{className:"text-green-600 font-semibold",children:[i[e].youSave," $",((T.originalPrice||0)-T.price).toFixed(2)]})]}),T.specialEndDate&&a.jsx("div",{className:"text-xs text-orange-600 mt-1",children:i[e].endingSoon})]}):a.jsxs("div",{children:[a.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:["$",T.price]}),a.jsx("div",{className:"text-sm text-gray-500",children:T.unit})]})})]},T.id)})})]})]},u)})}),a.jsxs("div",{className:"mt-8 sm:mt-12 bg-gradient-to-r from-primary-50 to-blue-50 rounded-xl sm:rounded-2xl p-4 sm:p-8 border border-primary-200",children:[a.jsx("h3",{className:`text-xl sm:text-2xl font-bold text-center mb-4 sm:mb-8 text-gray-900 ${e==="zh"?"font-chinese":""}`,children:i[e].bestDeals}),a.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 sm:gap-6",children:[a.jsxs("div",{className:"text-center bg-white rounded-lg sm:rounded-xl p-3 sm:p-6 shadow-sm",children:[a.jsx("div",{className:"text-2xl sm:text-3xl font-bold text-primary-600 mb-1 sm:mb-2",children:l.length}),a.jsx("div",{className:`text-xs sm:text-sm text-gray-600 ${e==="zh"?"font-chinese":""}`,children:i[e].productsCompared})]}),a.jsxs("div",{className:"text-center bg-white rounded-lg sm:rounded-xl p-3 sm:p-6 shadow-sm",children:[a.jsx("div",{className:"text-2xl sm:text-3xl font-bold text-blue-600 mb-1 sm:mb-2",children:n.length}),a.jsx("div",{className:`text-xs sm:text-sm text-gray-600 ${e==="zh"?"font-chinese":""}`,children:i[e].totalSupermarkets})]}),a.jsxs("div",{className:"text-center bg-white rounded-lg sm:rounded-xl p-3 sm:p-6 shadow-sm",children:[a.jsxs("div",{className:"text-2xl sm:text-3xl font-bold text-green-600 mb-1 sm:mb-2",children:["$",Math.max(...l.flatMap(([u,d])=>d.map(h=>(h.originalPrice||h.price)-h.price))).toFixed(2)]}),a.jsx("div",{className:`text-xs sm:text-sm text-gray-600 ${e==="zh"?"font-chinese":""}`,children:i[e].maxSavings})]}),a.jsxs("div",{className:"text-center bg-white rounded-lg sm:rounded-xl p-3 sm:p-6 shadow-sm",children:[a.jsx("div",{className:"text-2xl sm:text-3xl font-bold text-red-600 mb-1 sm:mb-2",children:t.filter(u=>u.isSpecial).length}),a.jsx("div",{className:`text-xs sm:text-sm text-gray-600 ${e==="zh"?"font-chinese":""}`,children:i[e].specialOffers})]})]})]})]})}function Zx({productName:e,onBack:t,onProductClick:n}){var B,A,U,E,G,L,F,V;const{language:r,products:s}=Ce(),{user:i,isAuthenticated:o}=jn(),[l,c]=O.useState(new Set),[u,d]=O.useState(new Map),[h,p]=O.useState(new Map),[v,y]=O.useState(new Map),x={en:{back:"Back to Category",priceComparison:"Price Comparison",cheapest:"Cheapest",mostExpensive:"Most Expensive",averagePrice:"Average Price",updated:"Updated",special:"Special Offer",youSave:"You Save",endingSoon:"Ending Soon",noProducts:"No products found with this name",viewOnMap:"View on Map",getDirections:"Get Directions",priceUpdated:"Price updated",historicalLow:"30-day low",currentHigher:"Current price higher than 30-day low",currentIsLowest:"Current price is 30-day lowest!",stores:"stores",priceHistory:"Price History Analysis",supermarket:"Supermarket",currentPrice:"Current Price",lastUpdated:"Last Updated",viewDetails:"View Details",productDetails:"Product Details",origin:"Origin",freshness:"Freshness",rating:"Rating",addToFavorites:"Add to Favorites",removeFromFavorites:"Remove from Favorites",addToShoppingList:"Add to Shopping List",removeFromShoppingList:"Remove from Shopping List",alreadyInShoppingList:"Already in Shopping List",loginToFavorite:"Login to Add Favorites",loginToShoppingList:"Login to Add to Shopping List",favoriteAdded:"Added to favorites!",favoriteRemoved:"Removed from favorites!",shoppingListAdded:"Added to shopping list!",shoppingListRemoved:"Removed from shopping list!",closeDetails:"Close Details",showDetails:"Show Details",hideDetails:"Hide Details"},zh:{back:"返回分类",priceComparison:"价格比较",cheapest:"最便宜",mostExpensive:"最贵",averagePrice:"平均价格",updated:"更新于",special:"特价优惠",youSave:"节省",endingSoon:"即将结束",noProducts:"未找到该商品",viewOnMap:"查看地图",getDirections:"获取路线",priceUpdated:"价格更新于",historicalLow:"30天最低价",currentHigher:"当前价格高于30天最低价",currentIsLowest:"当前价格是近30天最低价！",stores:"家超市",priceHistory:"价格历史分析",supermarket:"超市名称",currentPrice:"当前价格",lastUpdated:"更新时间",viewDetails:"查看详情",productDetails:"商品详情",origin:"产地",freshness:"新鲜度",rating:"评分",addToFavorites:"添加收藏",removeFromFavorites:"取消收藏",addToShoppingList:"加入购物清单",removeFromShoppingList:"从清单中移除",alreadyInShoppingList:"已在清单中",loginToFavorite:"登录后收藏",loginToShoppingList:"登录后添加到清单",favoriteAdded:"已添加到收藏！",favoriteRemoved:"已从收藏中移除！",shoppingListAdded:"已加入购物清单！",shoppingListRemoved:"已从清单中移除！",closeDetails:"关闭详情",showDetails:"显示详情",hideDetails:"隐藏详情"}},j=s.filter(P=>P.name_en.toLowerCase()===e.toLowerCase()).sort((P,$)=>P.price-$.price),g=()=>j.length===0?0:Math.min(...j.map($=>$.price))*(.8+Math.random()*.15),f=P=>{var $,I;if(($=P.supermarket)!=null&&$.lat&&((I=P.supermarket)!=null&&I.lng)){const X=`https://www.google.com/maps/dir/?api=1&destination=${P.supermarket.lat},${P.supermarket.lng}`;window.open(X,"_blank")}},m=P=>{var $,I;if(($=P.supermarket)!=null&&$.lat&&((I=P.supermarket)!=null&&I.lng)){const X=`https://www.google.com/maps/search/?api=1&query=${P.supermarket.lat},${P.supermarket.lng}`;window.open(X,"_blank")}};O.useEffect(()=>{o&&i&&j.forEach(P=>{w(P.id),C(P.id)})},[o,i,j]);const w=async P=>{if(i)try{const{data:$,error:I}=await W.from("user_favorites").select("id").eq("user_id",i.id.toString()).eq("product_id",P).single();d(X=>new Map(X.set(P,!!$&&!I)))}catch{d(I=>new Map(I.set(P,!1)))}},C=async P=>{if(i)try{const{data:$,error:I}=await W.from("shopping_list").select("id").eq("user_id",i.id.toString()).eq("product_id",P).single();p(X=>new Map(X.set(P,!!$&&!I)))}catch{p(I=>new Map(I.set(P,!1)))}},b=async P=>{if(!(!o||!i)){y($=>{var I;return new Map($.set(P,{...$.get(P),favorite:!0,shopping:((I=$.get(P))==null?void 0:I.shopping)||!1}))});try{if(u.get(P)||!1){const{error:I}=await W.from("user_favorites").delete().eq("user_id",i.id.toString()).eq("product_id",P);if(I)throw I;d(X=>new Map(X.set(P,!1))),console.log(x[r].favoriteRemoved),window.dispatchEvent(new CustomEvent("favoritesUpdated"))}else{const{error:I}=await W.from("user_favorites").insert([{user_id:i.id.toString(),product_id:P}]);if(I)throw I;d(X=>new Map(X.set(P,!0))),console.log(x[r].favoriteAdded),window.dispatchEvent(new CustomEvent("favoritesUpdated"))}}catch($){console.error("收藏操作失败:",$)}finally{y($=>{var I;return new Map($.set(P,{...$.get(P),favorite:!1,shopping:((I=$.get(P))==null?void 0:I.shopping)||!1}))})}}},z=async P=>{if(!(!o||!i)){y($=>{var I;return new Map($.set(P,{...$.get(P),favorite:((I=$.get(P))==null?void 0:I.favorite)||!1,shopping:!0}))});try{if(h.get(P)||!1){const{error:I}=await W.from("shopping_list").delete().eq("user_id",i.id.toString()).eq("product_id",P);if(I)throw I;p(X=>new Map(X.set(P,!1))),console.log(x[r].shoppingListRemoved),window.dispatchEvent(new CustomEvent("shoppingListUpdated"))}else{const{error:I}=await W.from("shopping_list").insert([{user_id:i.id.toString(),product_id:P}]);if(I)throw I;p(X=>new Map(X.set(P,!0))),console.log(x[r].shoppingListAdded),window.dispatchEvent(new CustomEvent("shoppingListUpdated"))}}catch($){console.error("购物清单操作失败:",$)}finally{y($=>{var I;return new Map($.set(P,{...$.get(P),favorite:((I=$.get(P))==null?void 0:I.favorite)||!1,shopping:!1}))})}}},k=P=>{const $=new Set(l);$.has(P)?$.delete(P):$.add(P),c($)};if(j.length===0)return a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[a.jsx("div",{className:"flex items-center mb-6",children:a.jsxs("button",{onClick:t,className:"flex items-center space-x-2 text-gray-600 hover:text-primary-600 transition-colors",children:[a.jsx(Bo,{className:"w-5 h-5"}),a.jsx("span",{className:`text-sm font-medium ${r==="zh"?"font-chinese":""}`,children:x[r].back})]})}),a.jsx("div",{className:"text-center py-12",children:a.jsx("p",{className:`text-gray-600 ${r==="zh"?"font-chinese":""}`,children:x[r].noProducts})})]});const _=j.map(P=>P.price),N=Math.min(..._),T=Math.max(..._),Y=_.reduce((P,$)=>P+$,0)/_.length,Q=j.find(P=>P.price===N),K=j.find(P=>P.price===T),S=g(),M=N<=S;return a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[a.jsx("div",{className:"flex items-center mb-6",children:a.jsxs("button",{onClick:t,className:"flex items-center space-x-2 text-gray-600 hover:text-primary-600 transition-colors mr-4",children:[a.jsx(Bo,{className:"w-5 h-5"}),a.jsx("span",{className:`text-sm font-medium ${r==="zh"?"font-chinese":""}`,children:x[r].back})]})}),a.jsx("div",{className:"bg-gradient-to-r from-primary-50 to-blue-50 rounded-2xl p-6 mb-8",children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-4 sm:space-y-0 sm:space-x-6",children:[a.jsx("img",{src:j[0].image,alt:r==="en"?j[0].name_en:j[0].name_zh,className:"w-24 h-24 object-cover rounded-xl shadow-lg mx-auto sm:mx-0",onError:P=>{P.currentTarget.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOTYiIGhlaWdodD0iOTYiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iI2YzZjRmNiIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTAiIGZpbGw9IiM5ZmEyYTUiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj5ObyBJbWFnZTwvdGV4dD48L3N2Zz4="}}),a.jsxs("div",{className:"text-center sm:text-left",children:[a.jsx("h1",{className:`text-3xl font-bold text-gray-900 mb-2 ${r==="zh"?"font-chinese":""}`,children:r==="en"?j[0].name_en:j[0].name_zh}),a.jsxs("p",{className:`text-gray-600 ${r==="zh"?"font-chinese":""}`,children:[x[r].priceComparison," • ",j.length," ",x[r].stores]}),a.jsx("div",{className:"mt-3",children:M?a.jsxs("div",{className:`inline-flex items-center space-x-1 bg-green-100 text-green-700 px-3 py-1 rounded-full text-sm font-semibold ${r==="zh"?"font-chinese":""}`,children:[a.jsx(ls,{className:"w-4 h-4"}),a.jsxs("span",{children:["🎉 ",x[r].currentIsLowest]})]}):a.jsxs("div",{className:`inline-flex items-center space-x-1 bg-orange-100 text-orange-700 px-3 py-1 rounded-full text-sm ${r==="zh"?"font-chinese":""}`,children:[a.jsx(cs,{className:"w-4 h-4"}),a.jsxs("span",{children:["📈 ",x[r].currentHigher," $",S.toFixed(2)]})]})})]})]})}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-6 mb-8",children:[a.jsxs("div",{className:"bg-green-50 rounded-xl p-6 border border-green-200",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[a.jsx("div",{className:"w-10 h-10 bg-green-500 rounded-full flex items-center justify-center",children:a.jsx(ls,{className:"w-5 h-5 text-white"})}),a.jsxs("div",{children:[a.jsx("div",{className:`text-sm font-semibold text-green-800 ${r==="zh"?"font-chinese":""}`,children:x[r].cheapest}),a.jsxs("div",{className:"text-3xl font-bold text-green-600",children:["$",N.toFixed(2)]})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("img",{src:(B=Q==null?void 0:Q.supermarket)==null?void 0:B.logo_url,alt:(A=Q==null?void 0:Q.supermarket)==null?void 0:A.name_en,className:"w-5 h-5 rounded-full object-cover"}),a.jsx("span",{className:`text-sm text-green-700 font-medium truncate ${r==="zh"?"font-chinese":""}`,children:r==="en"?(U=Q==null?void 0:Q.supermarket)==null?void 0:U.name_en:(E=Q==null?void 0:Q.supermarket)==null?void 0:E.name_zh})]})]}),a.jsxs("div",{className:"bg-blue-50 rounded-xl p-6 border border-blue-200",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center",children:a.jsx("div",{className:"w-3 h-3 bg-white rounded-full"})}),a.jsxs("div",{children:[a.jsx("div",{className:`text-sm font-semibold text-blue-800 ${r==="zh"?"font-chinese":""}`,children:x[r].averagePrice}),a.jsxs("div",{className:"text-3xl font-bold text-blue-600",children:["$",Y.toFixed(2)]})]})]}),a.jsxs("div",{className:`text-sm text-blue-700 ${r==="zh"?"font-chinese":""}`,children:[j.length," ",x[r].stores]})]}),a.jsxs("div",{className:"bg-red-50 rounded-xl p-6 border border-red-200",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[a.jsx("div",{className:"w-10 h-10 bg-red-500 rounded-full flex items-center justify-center",children:a.jsx(cs,{className:"w-5 h-5 text-white"})}),a.jsxs("div",{children:[a.jsx("div",{className:`text-sm font-semibold text-red-800 ${r==="zh"?"font-chinese":""}`,children:x[r].mostExpensive}),a.jsxs("div",{className:"text-3xl font-bold text-red-600",children:["$",T.toFixed(2)]})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("img",{src:(G=K==null?void 0:K.supermarket)==null?void 0:G.logo_url,alt:(L=K==null?void 0:K.supermarket)==null?void 0:L.name_en,className:"w-5 h-5 rounded-full object-cover"}),a.jsx("span",{className:`text-sm text-red-700 font-medium truncate ${r==="zh"?"font-chinese":""}`,children:r==="en"?(F=K==null?void 0:K.supermarket)==null?void 0:F.name_en:(V=K==null?void 0:K.supermarket)==null?void 0:V.name_zh})]})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("h2",{className:`text-xl font-semibold mb-4 ${r==="zh"?"font-chinese":""}`,children:x[r].priceComparison}),a.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-2 gap-3 sm:gap-4 lg:gap-6",children:j.map(P=>{var $,I,X,vt,dr,Le,ys,_e,xt;return a.jsxs("div",{className:`flex flex-col p-3 sm:p-4 lg:p-5 rounded-lg sm:rounded-xl border-2 transition-all ${P.price===N?"border-green-300 bg-green-50 hover:border-green-400":"border-gray-200 bg-gray-50 hover:border-primary-200"}`,children:[a.jsxs("div",{className:"flex items-center justify-between mb-3 lg:mb-4",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs("div",{className:"relative",children:[a.jsx("img",{src:($=P.supermarket)==null?void 0:$.logo_url,alt:r==="en"?(I=P.supermarket)==null?void 0:I.name_en:(X=P.supermarket)==null?void 0:X.name_zh,className:"w-10 h-10 lg:w-12 lg:h-12 rounded-full object-cover border-2 border-white shadow-sm"}),P.price===N&&a.jsx("div",{className:"absolute -top-1 -right-1 bg-green-500 text-white rounded-full w-4 h-4 lg:w-5 lg:h-5 flex items-center justify-center text-xs font-bold",children:"1"})]}),a.jsxs("div",{children:[a.jsx("div",{className:`font-semibold text-gray-900 text-sm lg:text-base ${r==="zh"?"font-chinese":""}`,children:r==="en"?(vt=P.supermarket)==null?void 0:vt.name_en:(dr=P.supermarket)==null?void 0:dr.name_zh}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs lg:text-sm",children:[a.jsxs("span",{className:`text-gray-500 ${r==="zh"?"font-chinese":""}`,children:[x[r].updated," ",new Date(P.updated_at).toLocaleDateString()]}),P.isSpecial&&a.jsx("span",{className:`bg-red-100 text-red-700 px-2 py-1 rounded-full text-xs font-semibold ${r==="zh"?"font-chinese":""}`,children:x[r].special})]})]})]}),P.isSpecial?a.jsxs("div",{className:"text-right",children:[a.jsxs("div",{className:"text-lg lg:text-xl font-bold text-red-600",children:["$",P.price.toFixed(2)]}),a.jsxs("div",{className:"text-sm text-gray-500 line-through",children:["$",(P.originalPrice||0).toFixed(2)]})]}):a.jsxs("div",{children:[a.jsxs("div",{className:"text-2xl lg:text-3xl font-bold text-gray-900",children:["$",P.price.toFixed(2)]}),a.jsx("div",{className:"text-sm text-gray-500",children:P.unit})]})]}),a.jsx("div",{className:"mt-3",children:a.jsxs("button",{onClick:()=>k(P.id),className:`w-full flex items-center justify-center space-x-2 px-3 py-2 rounded-lg transition-colors text-sm font-medium ${l.has(P.id)?"bg-primary-100 text-primary-700 hover:bg-primary-200":"bg-primary-500 text-white hover:bg-primary-600"} ${r==="zh"?"font-chinese":""}`,children:[a.jsx(is,{className:"w-4 h-4"}),a.jsx("span",{children:l.has(P.id)?x[r].hideDetails:x[r].showDetails})]})}),l.has(P.id)&&a.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[P.origin&&a.jsxs("div",{className:"flex items-center space-x-2 p-2 bg-white rounded-lg border",children:[a.jsx(is,{className:"w-4 h-4 text-gray-600 flex-shrink-0"}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("div",{className:`text-xs text-gray-600 ${r==="zh"?"font-chinese":""}`,children:x[r].origin}),a.jsx("div",{className:"text-sm font-semibold text-gray-900 truncate",children:P.origin})]})]}),P.freshness&&a.jsxs("div",{className:"flex items-center space-x-2 p-2 bg-white rounded-lg border",children:[a.jsx(hf,{className:"w-4 h-4 text-gray-600 flex-shrink-0"}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("div",{className:`text-xs text-gray-600 ${r==="zh"?"font-chinese":""}`,children:x[r].freshness}),a.jsx("div",{className:"text-sm font-semibold text-gray-900 truncate",children:P.freshness})]})]}),P.rating&&a.jsxs("div",{className:"flex items-center space-x-2 p-2 bg-white rounded-lg border",children:[a.jsx(os,{className:"w-4 h-4 text-yellow-500 fill-current flex-shrink-0"}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("div",{className:`text-xs text-gray-600 ${r==="zh"?"font-chinese":""}`,children:x[r].rating}),a.jsxs("div",{className:"text-sm font-semibold text-gray-900",children:[P.rating,"/5"]})]})]}),a.jsxs("div",{className:"flex items-center space-x-2 p-2 bg-white rounded-lg border",children:[a.jsx(gt,{className:"w-4 h-4 text-gray-600 flex-shrink-0"}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("div",{className:`text-xs text-gray-600 ${r==="zh"?"font-chinese":""}`,children:x[r].updated}),a.jsx("div",{className:"text-sm font-semibold text-gray-900 truncate",children:new Date(P.updated_at).toLocaleDateString()})]})]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[o?a.jsxs("button",{onClick:()=>b(P.id),disabled:(Le=v.get(P.id))==null?void 0:Le.favorite,className:`flex-1 flex items-center justify-center space-x-2 px-3 py-2 rounded-lg font-medium transition-colors disabled:opacity-50 text-sm ${u.get(P.id)?"bg-red-100 text-red-700 hover:bg-red-200":"bg-gray-100 text-gray-700 hover:bg-gray-200"} ${r==="zh"?"font-chinese":""}`,children:[(ys=v.get(P.id))!=null&&ys.favorite?a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current"}):a.jsx(St,{className:`w-4 h-4 ${u.get(P.id)?"fill-current":""}`}),a.jsx("span",{children:u.get(P.id)?x[r].removeFromFavorites:x[r].addToFavorites})]}):a.jsxs("button",{className:`flex-1 flex items-center justify-center space-x-2 px-3 py-2 rounded-lg font-medium transition-colors bg-primary-100 text-primary-700 hover:bg-primary-200 text-sm ${r==="zh"?"font-chinese":""}`,children:[a.jsx(sr,{className:"w-4 h-4"}),a.jsx("span",{children:x[r].loginToFavorite})]}),o?a.jsxs("button",{onClick:()=>z(P.id),disabled:(_e=v.get(P.id))==null?void 0:_e.shopping,className:`flex-1 flex items-center justify-center space-x-2 px-3 py-2 rounded-lg font-medium transition-colors disabled:opacity-50 text-sm ${h.get(P.id)?"bg-orange-100 text-orange-700 hover:bg-orange-200":"bg-blue-100 text-blue-700 hover:bg-blue-200"} ${r==="zh"?"font-chinese":""}`,children:[(xt=v.get(P.id))!=null&&xt.shopping?a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current"}):h.get(P.id)?a.jsx(pf,{className:"w-4 h-4"}):a.jsx(Zl,{className:"w-4 h-4"}),a.jsx("span",{children:h.get(P.id)?x[r].alreadyInShoppingList:x[r].addToShoppingList})]}):a.jsxs("button",{className:`flex-1 flex items-center justify-center space-x-2 px-3 py-2 rounded-lg font-medium transition-colors bg-primary-100 text-primary-700 hover:bg-primary-200 text-sm ${r==="zh"?"font-chinese":""}`,children:[a.jsx(sr,{className:"w-4 h-4"}),a.jsx("span",{children:x[r].loginToShoppingList})]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[a.jsxs("button",{onClick:()=>m(P),className:`flex-1 flex items-center justify-center space-x-2 px-3 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors text-sm ${r==="zh"?"font-chinese":""}`,children:[a.jsx(Te,{className:"w-4 h-4"}),a.jsx("span",{children:x[r].viewOnMap})]}),a.jsxs("button",{onClick:()=>f(P),className:`flex-1 flex items-center justify-center space-x-2 px-3 py-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors text-sm ${r==="zh"?"font-chinese":""}`,children:[a.jsx(Ci,{className:"w-4 h-4"}),a.jsx("span",{children:x[r].getDirections})]})]})]}),P.isSpecial&&a.jsx("div",{className:"mt-4 bg-red-100 rounded-lg p-3 border border-red-200",children:a.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[a.jsx(ir,{className:"w-4 h-4 text-red-600"}),a.jsxs("span",{className:`text-red-700 font-semibold ${r==="zh"?"font-chinese":""}`,children:[x[r].youSave," $",((P.originalPrice||0)-P.price).toFixed(2)]}),P.specialEndDate&&a.jsxs("span",{className:`text-red-600 ${r==="zh"?"font-chinese":""}`,children:["• ",x[r].endingSoon]})]})})]},P.id)})})]}),a.jsxs("div",{className:"mt-8 bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl p-6",children:[a.jsx("h3",{className:`text-lg font-semibold mb-4 text-center ${r==="zh"?"font-chinese":""}`,children:x[r].priceHistory}),a.jsxs("div",{className:"text-center",children:[a.jsxs("div",{className:`text-sm text-gray-600 mb-2 ${r==="zh"?"font-chinese":""}`,children:[x[r].historicalLow,": $",S.toFixed(2)]}),M?a.jsxs("div",{className:`text-green-600 font-semibold ${r==="zh"?"font-chinese":""}`,children:["🎉 ",x[r].currentIsLowest]}):a.jsxs("div",{className:`text-orange-600 ${r==="zh"?"font-chinese":""}`,children:["📈 ",x[r].currentHigher," $",S.toFixed(2)]})]})]})]})}function Vx({selectedSupermarket:e,onSupermarketSelect:t}){const{language:n,supermarkets:r,products:s}=Ce(),[i,o]=O.useState(!0),[l,c]=O.useState(!1),[u,d]=O.useState(!1),h=O.useRef(null),p=O.useRef(null),v=O.useRef([]);O.useEffect(()=>{console.log("🗺️ MapView - 超市数据:",r.length,"个超市"),r.forEach((k,_)=>{console.log(`${_+1}. ${k.name_en} - 坐标: (${k.lat}, ${k.lng})`)})},[r]);const y=k=>s.filter(_=>_.supermarket_id===k&&_.isSpecial),x={en:{title:"Supermarket Locations",subtitle:"Find nearby stores in Christchurch",directions:"Get Directions",call:"Call Store",hours:"Store Hours",rating:"Rating",distance:"Distance",openNow:"Open Now",closed:"Closed",allLocations:"All Locations",viewOnMap:"View on Map",mapLoadError:"Failed to load map",retryLoad:"Retry Loading",zoomIn:"Zoom In",zoomOut:"Zoom Out",loading:"Loading map..."},zh:{title:"超市位置",subtitle:"查找基督城附近商店",directions:"获取路线",call:"致电商店",hours:"营业时间",rating:"评分",distance:"距离",openNow:"营业中",closed:"已关闭",allLocations:"所有位置",viewOnMap:"在地图上查看",mapLoadError:"地图加载失败",retryLoad:"重新加载",zoomIn:"放大",zoomOut:"缩小",loading:"加载地图中..."}},j={en:{specialOffers:"Special Offers",showSpecials:"Show Special Products",hideSpecials:"Hide Special Products",specialsAt:"Special offers at",viewProduct:"View Product"},zh:{specialOffers:"特价商品",showSpecials:"显示特价商品",hideSpecials:"隐藏特价商品",specialsAt:"特价商品在",viewProduct:"查看商品"}};O.useEffect(()=>((async()=>{try{if(!document.querySelector('link[href*="leaflet"]')){const _=document.createElement("link");_.rel="stylesheet",_.href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css",_.integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=",_.crossOrigin="",document.head.appendChild(_)}if(window.L)g();else{const _=document.createElement("script");_.src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js",_.integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=",_.crossOrigin="",_.onload=()=>{g()},_.onerror=()=>{d(!0)},document.head.appendChild(_)}}catch(_){console.error("Error loading Leaflet:",_),d(!0)}})(),()=>{p.current&&(p.current.remove(),p.current=null)}),[]);const g=()=>{if(!(!h.current||!window.L)){p.current&&(p.current.remove(),p.current=null);try{const k=[-43.5321,172.6362],_=window.L.map(h.current,{center:k,zoom:11,zoomControl:!1});window.L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',maxZoom:19}).addTo(_),p.current=_,f(_),c(!0),d(!1),console.log("✅ 地图初始化完成，准备添加",r.length,"个超市标记")}catch(k){console.error("Error initializing map:",k),d(!0)}}},f=k=>{v.current.forEach(_=>k.removeLayer(_)),v.current=[],console.log("📍 开始添加超市标记，共",r.length,"个超市"),r.forEach(_=>{console.log(`📍 添加标记: ${_.name_en} - 坐标: (${_.lat}, ${_.lng})`);const N=y(_.id),T=N.length>0,Y=`
        <div style="position: relative; width: 40px; height: 40px;">
          <img src="${_.logo_url}" 
               style="width: 40px; height: 40px; border-radius: 50%; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3); object-fit: cover;"
               onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iIzQ4YjA0YSIgcng9IjIwIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgZmlsbD0id2hpdGUiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj7otoXluILjgII8L3RleHQ+PC9zdmc+'" />
          ${i&&T?`
            <div style="position: absolute; top: -2px; right: -2px; width: 16px; height: 16px; background: #ef4444; border-radius: 50%; display: flex; align-items: center; justify-content: center; animation: pulse 2s infinite;">
              <svg width="10" height="10" viewBox="0 0 24 24" fill="white">
                <path d="M13 10V3L4 14h7v7l9-11h-7z"/>
              </svg>
            </div>
          `:""}
        </div>
      `,Q=window.L.divIcon({html:Y,className:"custom-marker",iconSize:[40,40],iconAnchor:[20,20],popupAnchor:[0,-20]});if(!_.lat||!_.lng||isNaN(_.lat)||isNaN(_.lng)){console.warn("⚠️ 无效坐标:",_.name_en,_.lat,_.lng);return}const K=window.L.marker([_.lat,_.lng],{icon:Q}).addTo(k);console.log("✅ 成功添加标记:",_.name_en);const S=()=>{const M=i&&T?`
          <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #e5e7eb;">
            <div style="display: flex; align-items: center; margin-bottom: 8px;">
              <span style="color: #dc2626; font-weight: 600; font-size: 14px;">⚡ ${j[n].specialOffers}</span>
            </div>
            <div style="max-height: 120px; overflow-y: auto;">
              ${N.slice(0,3).map(B=>`
                <div style="display: flex; align-items: center; margin-bottom: 8px; padding: 8px; background: #fef2f2; border-radius: 8px;">
                  <img src="${B.image}" alt="${n==="en"?B.name_en:B.name_zh}" 
                       style="width: 32px; height: 32px; object-fit: cover; border-radius: 4px; margin-right: 8px;"
                       onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iI2YzZjRmNiIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iOCIgZmlsbD0iIzlmYTJhNSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPk5vPC90ZXh0Pjwvc3ZnPg=='">
                  <div style="flex: 1;">
                    <div style="font-size: 12px; font-weight: 500; color: #111827; margin-bottom: 2px;">
                      ${n==="en"?B.name_en:B.name_zh}
                    </div>
                    <div style="display: flex; align-items: center;">
                      <span style="font-size: 12px; font-weight: bold; color: #dc2626;">$${B.price}</span>
                      ${B.originalPrice?`<span style="font-size: 10px; color: #6b7280; text-decoration: line-through; margin-left: 4px;">$${B.originalPrice}</span>`:""}
                      <span style="font-size: 10px; background: #dc2626; color: white; padding: 1px 4px; border-radius: 2px; margin-left: 4px;">
                        -${B.discount}%
                      </span>
                    </div>
                  </div>
                </div>
              `).join("")}
              ${N.length>3?`
                <div style="text-align: center; font-size: 12px; color: #6b7280;">
                  +${N.length-3} ${n==="en"?"more specials":"更多特价"}
                </div>
              `:""}
            </div>
          </div>
        `:"";return`
          <div style="max-width: 300px; font-family: system-ui, sans-serif;">
            <div style="display: flex; align-items: center; margin-bottom: 12px;">
              <img src="${_.logo_url}" alt="${_.name_en}" 
                   style="width: 32px; height: 32px; border-radius: 50%; object-fit: cover; margin-right: 12px;">
              <div>
                <h3 style="margin: 0; font-size: 16px; font-weight: 600; color: #111827;">
                  ${n==="en"?_.name_en:_.name_zh}
                </h3>
                <div style="display: flex; align-items: center; margin-top: 4px; color: #6b7280; font-size: 14px;">
                  📍 ${_.location}
                </div>
              </div>
            </div>
            
            <div style="margin-bottom: 12px;">
              ${_.rating?`
                <div style="display: flex; align-items: center; margin-bottom: 4px; font-size: 14px;">
                  ⭐ ${_.rating}/5
                </div>
              `:""}
              ${_.hours?`
                <div style="display: flex; align-items: center; color: #6b7280; font-size: 14px;">
                  🕒 ${_.hours}
                </div>
              `:""}
            </div>
            
            ${M}
            
            <div style="display: flex; gap: 8px; margin-top: 12px;">
              <button onclick="window.open('https://www.google.com/maps/dir/?api=1&destination=${_.lat},${_.lng}', '_blank')"
                      style="flex: 1; background: #48b04a; color: white; border: none; padding: 8px 12px; border-radius: 6px; font-size: 14px; cursor: pointer;">
                🧭 ${x[n].directions}
              </button>
              ${_.phone?`
                <button onclick="window.open('tel:${_.phone}', '_self')"
                        style="background: #f3f4f6; color: #374151; border: 1px solid #d1d5db; padding: 8px; border-radius: 6px; cursor: pointer;">
                  📞
                </button>
              `:""}
            </div>
          </div>
        `};K.bindPopup(S(),{maxWidth:320,className:"custom-popup"}),K.on("click",()=>{t==null||t(_)}),v.current.push(K)}),console.log("✅ 完成添加",v.current.length,"个超市标记")};O.useEffect(()=>{p.current&&l&&f(p.current)},[i,n]),O.useEffect(()=>{if(l&&e&&p.current){const k=r.find(_=>_.id===e.id);k&&p.current.setView([k.lat,k.lng],14)}},[e,l]);const m=k=>{const _=`https://www.google.com/maps/dir/?api=1&destination=${k.lat},${k.lng}`;window.open(_,"_blank")},w=k=>{window.open(`tel:${k}`,"_self")},C=()=>{p.current&&p.current.zoomIn()},b=()=>{p.current&&p.current.zoomOut()},z=()=>{d(!1),c(!1);const k=document.querySelector('link[href*="leaflet"]'),_=document.querySelector('script[src*="leaflet"]');k&&k.remove(),_&&_.remove(),window.L&&delete window.L,window.location.reload()};return a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200",children:[a.jsx("h2",{className:`text-2xl font-bold text-gray-900 mb-1 ${n==="zh"?"font-chinese":""}`,children:x[n].title}),a.jsx("p",{className:`text-gray-600 ${n==="zh"?"font-chinese":""}`,children:x[n].subtitle}),a.jsx("div",{className:"mt-4",children:a.jsxs("button",{onClick:()=>o(!i),className:`flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-colors ${i?"bg-red-100 text-red-700 hover:bg-red-200":"bg-gray-100 text-gray-700 hover:bg-gray-200"} ${n==="zh"?"font-chinese":""}`,children:[a.jsx(ir,{className:"w-4 h-4"}),a.jsx("span",{children:i?j[n].hideSpecials:j[n].showSpecials})]})})]}),a.jsxs("div",{className:"relative",children:[a.jsx("div",{ref:h,className:"w-full h-96 bg-gray-100",style:{minHeight:"400px"}}),!l&&!u&&a.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-100",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-500 mx-auto mb-4"}),a.jsx("p",{className:`text-gray-600 ${n==="zh"?"font-chinese":""}`,children:x[n].loading})]})}),u&&a.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-100",children:a.jsxs("div",{className:"text-center",children:[a.jsx(Te,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:`text-xl font-semibold text-gray-600 mb-2 ${n==="zh"?"font-chinese":""}`,children:x[n].mapLoadError}),a.jsx("button",{onClick:z,className:"bg-primary-500 hover:bg-primary-600 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors",children:x[n].retryLoad})]})}),l&&a.jsxs("div",{className:"absolute top-4 right-4 flex flex-col space-y-1",style:{zIndex:1e3},children:[a.jsx("button",{onClick:C,className:"w-10 h-10 bg-white border-2 border-gray-300 rounded-lg shadow-xl hover:bg-gray-50 hover:border-primary-500 flex items-center justify-center transition-all duration-200 active:scale-95",title:x[n].zoomIn,children:a.jsx(Zl,{className:"w-5 h-5 text-gray-700 font-bold",strokeWidth:3})}),a.jsx("button",{onClick:b,className:"w-10 h-10 bg-white border-2 border-gray-300 rounded-lg shadow-xl hover:bg-gray-50 hover:border-primary-500 flex items-center justify-center transition-all duration-200 active:scale-95",title:x[n].zoomOut,children:a.jsx(gf,{className:"w-5 h-5 text-gray-700 font-bold",strokeWidth:3})})]})]}),a.jsxs("div",{className:"p-6",children:[a.jsx("h3",{className:`text-lg font-semibold mb-4 ${n==="zh"?"font-chinese":""}`,children:x[n].allLocations}),a.jsx("div",{className:"space-y-3",children:r.map(k=>a.jsxs("div",{onClick:()=>t==null?void 0:t(k),className:`flex items-center space-x-4 p-4 rounded-lg border cursor-pointer transition-all duration-200 ${(e==null?void 0:e.id)===k.id?"border-primary-200 bg-primary-50 shadow-md":"border-gray-200 hover:border-gray-300 hover:bg-gray-50 hover:shadow-sm"}`,children:[a.jsxs("div",{className:"relative",children:[a.jsx("img",{src:k.logo_url,alt:n==="en"?k.name_en:k.name_zh,className:"w-12 h-12 rounded-full object-cover"}),(e==null?void 0:e.id)===k.id&&a.jsx("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-primary-500 rounded-full flex items-center justify-center",children:a.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),i&&y(k.id).length>0&&a.jsx("div",{className:"absolute -top-1 -left-1 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center",children:a.jsx(yf,{className:"w-3 h-3 text-white"})})]}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:`font-semibold text-gray-900 ${n==="zh"?"font-chinese":""}`,children:n==="en"?k.name_en:k.name_zh}),a.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600 mb-1",children:[a.jsx(Te,{className:"w-4 h-4"}),a.jsx("span",{children:k.location})]}),a.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[k.rating&&a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(os,{className:"w-4 h-4 text-yellow-500 fill-current"}),a.jsx("span",{children:k.rating})]}),k.hours&&a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(gt,{className:"w-4 h-4"}),a.jsx("span",{className:"text-green-600 font-medium",children:x[n].openNow})]})]}),i&&a.jsx("div",{className:"mt-1",children:(()=>{const _=y(k.id).length;return _>0?a.jsxs("div",{className:"flex items-center space-x-1 text-xs text-red-600",children:[a.jsx(ir,{className:"w-3 h-3"}),a.jsxs("span",{className:n==="zh"?"font-chinese":"",children:[_," ",n==="en"?"special offers":"特价商品"]})]}):null})()})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("button",{onClick:_=>{_.stopPropagation(),m(k)},className:"p-2 text-primary-600 hover:bg-primary-100 rounded-full transition-colors",title:x[n].directions,children:a.jsx(Ci,{className:"w-5 h-5"})}),k.phone&&a.jsx("button",{onClick:_=>{_.stopPropagation(),w(k.phone)},className:"p-2 text-gray-600 hover:bg-gray-100 rounded-full transition-colors",title:x[n].call,children:a.jsx(as,{className:"w-5 h-5"})})]})]},k.id))})]}),a.jsx("div",{className:"bg-gradient-to-r from-primary-50 to-blue-50 p-6",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-primary-600",children:r.length}),a.jsx("div",{className:`text-sm text-gray-600 ${n==="zh"?"font-chinese":""}`,children:n==="en"?"Total Stores":"总店铺数"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-red-600",children:s.filter(k=>k.isSpecial).length}),a.jsx("div",{className:`text-sm text-gray-600 ${n==="zh"?"font-chinese":""}`,children:n==="en"?"Special Offers":"特价商品"})]}),a.jsxs("div",{className:"text-center",children:[a.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[s.filter(k=>k.isSpecial).length>0?Math.round(s.filter(k=>k.isSpecial).reduce((k,_)=>k+(_.discount||0),0)/s.filter(k=>k.isSpecial).length):0,"%"]}),a.jsx("div",{className:`text-sm text-gray-600 ${n==="zh"?"font-chinese":""}`,children:n==="en"?"Avg Discount":"平均折扣"})]})]})}),a.jsx("style",{children:`
        .custom-marker {
          background: transparent !important;
          border: none !important;
        }
        
        .custom-popup .leaflet-popup-content-wrapper {
          border-radius: 12px;
          box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }
        
        .custom-popup .leaflet-popup-tip {
          background: white;
        }
        
        @keyframes pulse {
          0%, 100% {
            opacity: 1;
          }
          50% {
            opacity: 0.5;
          }
        }
      `})]})}function Gx({connectionStatus:e="connecting"}){const{language:t}=Ce(),n={en:{loading:"Loading...",subtitle:"Getting the latest prices for you",syncingData:"Syncing data to database...",connectionFailed:"Database connection failed",usingFallback:"Using offline data",retrying:"Retrying connection..."},zh:{loading:"加载中...",subtitle:"正在为您获取最新价格",syncingData:"正在同步数据到数据库...",connectionFailed:"数据库连接失败",usingFallback:"使用离线数据",retrying:"正在重试连接..."}},r=()=>{switch(e){case"connecting":return n[t].syncingData;case"failed":return n[t].connectionFailed;case"fallback":return n[t].usingFallback;default:return n[t].syncingData}},s=()=>{switch(e){case"failed":return"text-orange-600";case"fallback":return"text-blue-600";default:return"text-gray-500"}};return a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-primary-500 rounded-lg flex items-center justify-center mb-6 mx-auto",children:a.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",className:"text-white",children:a.jsx("path",{d:"M6 4v10c0 2.2 1.8 4 4 4h4c2.2 0 4-1.8 4-4V4",stroke:"currentColor",strokeWidth:"2.8",strokeLinecap:"round",fill:"none"})})}),a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-500 mx-auto mb-4"}),a.jsx("h2",{className:`text-xl font-semibold text-gray-900 mb-2 ${t==="zh"?"font-chinese":""}`,children:n[t].loading}),a.jsx("p",{className:`text-gray-600 ${t==="zh"?"font-chinese":""}`,children:n[t].subtitle}),a.jsxs("div",{className:`mt-4 text-sm ${s()}`,children:[a.jsx("p",{className:t==="zh"?"font-chinese":"",children:r()}),e==="fallback"&&a.jsx("p",{className:`text-xs mt-1 text-gray-400 ${t==="zh"?"font-chinese":""}`,children:t==="en"?"Check your network connection":"请检查网络连接"})]})]})})}function Jx(){const{isLoading:e,connectionStatus:t}=Ce(),[n,r]=O.useState(null),[s,i]=O.useState("home"),[o,l]=O.useState(null),[c,u]=O.useState(null),[d,h]=O.useState(!1);O.useEffect(()=>{const f=()=>{i("home"),l(null),u(null),r(null)},m=()=>{i("favorites"),l(null),u(null),r(null)},w=()=>{h(!0)};return window.addEventListener("navigateToHome",f),window.addEventListener("navigateToFavorites",m),window.addEventListener("showLoginModal",w),window.removeEventListener("navigateToFavorites",m),window.removeEventListener("showLoginModal",w),()=>window.removeEventListener("navigateToHome",f)},[]);const p=f=>{r(f)},v=f=>{l(f)},y=()=>{l(null),u(null)},x=f=>{u(f)},j=()=>{u(null)};if(e)return a.jsx(Gx,{connectionStatus:t});const g=()=>{switch(s){case"home":return c?a.jsx("div",{className:"pb-24",children:a.jsx(Zx,{productName:c,onBack:j,onProductClick:p})}):o?a.jsx("div",{className:"pb-24",children:a.jsx(Ux,{category:o,onBack:y,onProductNameClick:x})}):a.jsx("div",{className:"pb-24",children:a.jsx(Mx,{onCategoryClick:v})});case"specials":return a.jsx("div",{className:"pb-24",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"})});case"compare":return a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pb-24",children:a.jsx(Wx,{})});case"favorites":return a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pb-24",children:a.jsx(Hx,{onProductClick:p,onLoginClick:()=>h(!0)})});case"map":return a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pb-24",children:a.jsx(Vx,{})});default:return null}};return a.jsxs("div",{className:"min-h-screen bg-gray-50 w-full max-w-full overflow-x-hidden",children:[a.jsx(Ox,{}),g(),n&&a.jsx(Fx,{product:n,onClose:()=>r(null)}),a.jsx(wf,{isOpen:d,onClose:()=>h(!1)}),a.jsx(Bx,{activeTab:s,onTabChange:i})]})}function qx(){return a.jsx(fv,{children:a.jsx(mv,{children:a.jsx(Jx,{})})})}Ra.createRoot(document.getElementById("root")).render(a.jsx(Mf.StrictMode,{children:a.jsx(qx,{})}));
